<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>BIOSCI738</title>
    <meta charset="utf-8" />
    <meta name="author" content="Charlotte M. Jones-Todd" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# BIOSCI738
## <img src="https://cpb-ap-se2.wpmucdn.com/blogs.auckland.ac.nz/dist/d/79/files/2015/10/uoa-v-reverse1.png" style="width:5.0%" /> Universty of Auckland
### Charlotte M. Jones-Todd
### <a href="https://stats-uoa.github.io/BIOSCI738/">bluepages</a>
### Module 1: Exploratory Data Analysis and Communication

---

class: inverse, center, middle



&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 20px;
    padding: 1em 4em 1em 4em;
}
&lt;/style&gt;



# `R` and `RStudio`

---
class: inverse

# Learning objectives

+ **Define** the difference between `R` and `RStudio`
+ **Explain** what an `R` function is; describe what an argument to an `R` function is
+ **Explain** what an `R` package is; distinguish between the functions `install.packages()` and `library()`
+ **Use** the appropriate `R` function to read in a data file
+ **Explain** the importance of reproducibility in terms of scientific research
+ **Use** the functionality offered by git and GitHub through `RStudio`

---
class:  center

# R is the pheromone to RStudio's PDA.

![](img/r-rstudio-pda.jpg)

---
class:  center, middle

# R is the pheromone to RStudio's PDA.

.small[`R` is a language. Specifically a programming language; it's the way you can speak to your computer to ask it to carry out certain computations.

`RStudio` is an integrated development environment (IDE). This means it is basically an interface, albeit a fancy one, that makes it easier to communicate with your computer in the `R` language. The main benefit is the additional features it has that enable you to more efficiently *speak* `R`.

**Note** `R` and `RStudio` are two **different** pieces of software; for this course you are expected to download both. As you'd expect the PDA depends on the pheromones (i.e., `RStudio` depends on `R`) so you have to download `R` to use `RStudio`! ]

---
# Why R? 
#### not an extensive list

--
+ Free

--
+ Open source

--
+ Huge online support network

--
+ Flexible; if you can code it you can do it!

--
+ Reproduciblity


---

# Why RStudio? 
#### not an extensive list

--
+ Works nicely with R

--
+ Huge online support network

--
+ Flexible; so, so, many tools and additions!

--
+ Reproduciblity

---
class: inverse

# Installing R and RStudio

As mentioned above `RStudio` depends on `R` so there is an order you should follow when you download these software.

 1. **Download and install `R`** by following [these instructions](https://cloud.r-project.org/). Make sure you choose the correct operating system.
 
 2. **Download and install `RStudio`** by [going here](https://rstudio.com/products/rstudio/download/) choosing RStudio Desktop *Open Source License* **Free** and following instructions. 
 
---
class: inverse

### Check all is working

  + Open up `RStudio` from your computer menu, the icon will look something like this &lt;img src="https://vectorified.com/images/rstudio-icon-31.png" width="7%"&gt; (**DO NOT** use this icon &lt;img src="https://cdn.iconscout.com/icon/free/png-512/r-5-283170.png" width="4%"&gt; this is a link to `R` and will only open a very basic interface)
  + Wait a little and you should see `RStudio` open up to something similar to the screenshot below
  
    &lt;img src="https://stats220.earo.me/img/rstudio-interface.png" width="70%"&gt; 
    
    
  + .small[Pay close attention to the notes in the screenshot and familiarise yourself with the terms.]


---

## R errors  üò±


```r
data &lt;- read.csv("data_file_not_in_my_working_directory.csv")
```

```
## Warning in file(file, "rt"): cannot open file
## 'data_file_not_in_my_working_directory.csv': No such file or directory
```

```
## Error in file(file, "rt"): cannot open the connection
```

```r
library(some_library_I_have_not_installed)
```

```
## Error in library(some_library_I_have_not_installed): there is no package called 'some_library_I_have_not_installed'
```

```r
some_function_I_spelled_worng(x = x)
```

```
## Error in some_function_I_spelled_worng(x = x): could not find function "some_function_I_spelled_worng"
```

```r
an_object_I_have_not_created
```

```
## Error in eval(expr, envir, enclos): object 'an_object_I_have_not_created' not found
```

---
## Change the `RStudio` appearance up to your taste

Go to **Tools** &gt; **Global Options** &gt; **Apperance**

![](https://support.rstudio.com/hc/article_attachments/115020425168/Screen_Shot_2017-08-24_at_1.14.19_PM.png)

---
## Good practice: always start with a clean workspace


Go to **Tools** &gt; **Global Options**

![](https://miro.medium.com/max/2784/1*dUNl71Jic2zYhYS2hxOBZA.png)

---
### Why? So your ex (code) can't come and mess up your life!


![](https://memegenerator.net/img/instances/57296391/when-your-ex-texts-you-after-months-hey-whats-up-not-today-satan-not-today.jpg)



---

class: inverse

# Recommened: `.Rproj`
## Project-oriented workflow

+ **Organised** Set up each Each assignment/university course as a *project*
+ **Self-contained** a *project* is a folder that contains all relevant files
   + All paths can then be relative to that *project*
+ **Reproducible** the *project* should just work on a different computer

---

class: inverse

# Recommened: `.Rproj`


Got to **Project** (top right) &gt; **New Project** &gt; **Create Project** ![](https://stats220.earo.me/img/rstudio-proj.png)

---
class: inverse

## Project-oriented workflow

&lt;img src="https://raw.githubusercontent.com/martinctc/blog/master/images/RPROJECT_2000dpi.png" width="50%"&gt;



---

class: inverse

## ‚ö†Ô∏èWarning‚ö†Ô∏è

[Jenny Bryan will set your computer on fire](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/) üî• if you start your script like this


```r
rm(list = ls())
```

This
+ does **NOT** create a fresh `R` process
+ it makes your script vulnerable
+ ...

---
class: inverse

# Reproducible research

### Keep all similar files for the same analysis in the same place 

### **NEVER** change raw data

---

## Version control

![](https://images3.memedroid.com/images/UPLOADED29/5b7d571106c71.jpeg)

---

## Git and GitHub
#### All workshops will use these tools

+ **Git** the software
  + a version control system
  + manages the evolution of a set of files (tidily)
  + *"Track Changes features from Microsoft Word on steroids"*--- Jenny Bryan

+ **GitHub** an online hosting service
  +  home for your Git-based projects on the internet
  + *"think of it as DropBox but much, much better"* --- Jenny Bryan
  

---

## Setup TL;DR

+ Register an account with GitHub [https://github.com](https://github.com)
+ Make sure you've got the latest version of `R`

```r
R.version.string
```

```
## [1] "R version 4.0.3 (2020-10-10)"
```
+ Upgrade `RStudio` to the [new preview version](https://rstudio.com/products/rstudio/download/preview/) (*optional*)
+ Install git: follow [these instructions](https://happygitwithr.com/install-git.html)
+ [Get started](https://happygitwithr.com/hello-git.html)

Resources:

[Happy Git and GitHub for the useR](https://happygitwithr.com/)


---
class: inverse, center, middle

# Exploratory Data Analysis

---
## Starting out with `tidyverse`


&lt;img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidyverse_celestial.png" width="40%"&gt;

Artwork by [@allison_horst](https://github.com/allisonhorst/)

---
## Starting out with `tidyverse`

For EDA we will be using `tidyverse`. ['tidyverse'](https://www.tidyverse.org/) is a collection of `R` packages that all share underlying design philosophy, grammar, and data structures. They are specifically designed to make data wrangling, manipulation, visualisation, and analysis simpler.

To install **all** the packages that belong to the `tidyverse` run


```r
## request (download) the tidyverse packages from the centralised library
install.packages("tidyverse")
```

To tell your computer to access the `tidyverse` functionality in your session run  (**Note** you'll have to do this each time you start up an `R` session):


```r
## Get the tidyverse packages from our local library
library(tidyverse)
```

---
### Reading in data from a `.csv` file

First off download the `paua.csv` file from CANVAS 

To read the data into `RStudio` 

 1. In the *Environment* pane click **Import Dataset** &gt;  ** From Text (readr)** &gt; **Browse** &gt; *Choose your file, remembering which folder you downloaded it to. this is where `.Rproj` is useful* &gt; *Another pane should pop up, check the data looks as you might expect* &gt; **Import**
 
 


2. Or


```r
paua &lt;- read_csv("paua.csv")
```


---
## Explore your data

Let's have a look at your data in the *Console*


```r
paua
```

```
## # A tibble: 60 x 3
##    Species            Length   Age
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 Haliotis iris        1.8   1.50
##  2 Haliotis australis   5.4  11.9 
##  3 Haliotis australis   4.8   5.42
##  4 Haliotis iris        5.75  4.50
##  5 Haliotis iris        5.65  5.50
##  6 Haliotis iris        2.8   2.50
##  7 Haliotis australis   5.9   6.49
##  8 Haliotis iris        3.75  5.00
##  9 Haliotis australis   7.2   8.56
## 10 Haliotis iris        4.25  5.50
## # ‚Ä¶ with 50 more rows
```

---
## Explore your data

Using the `glimpse()` command for an alternative view


```r
glimpse(paua)
```

```
## Rows: 60
## Columns: 3
## $ Species &lt;chr&gt; "Haliotis iris", "Haliotis australis", "Haliotis australis", ‚Ä¶
## $ Length  &lt;dbl&gt; 1.80, 5.40, 4.80, 5.75, 5.65, 2.80, 5.90, 3.75, 7.20, 4.25, 6‚Ä¶
## $ Age     &lt;dbl&gt; 1.497884, 11.877010, 5.416991, 4.497799, 5.500789, 2.500972, ‚Ä¶
```

---
### The pipe operator `%&gt;%`

A nifty `tidyverse` tool is called the pipe operator `%&gt;%`. The pipe operator allows us to combine multiple operations in `R` into a single sequential chain of actions.

Say you would like to perform a hypothetical sequence of operations on a hypothetical data frame x using hypothetical functions f(), g(), and h():

+ Take `x` then
+ Use `x` as an input to a function `f()` then
+ Use the output of this as an input to a function `g()` then
+ Use the output of this as an input to a function `h()`


---

So to calculate the mean **Age** of each **Species** in the `paua` dataset we would use


```r
paua %&gt;%
group_by(Species) %&gt;%
summarize(mean_age = mean(Age))
```

```
## # A tibble: 2 x 2
##   Species            mean_age
## * &lt;chr&gt;                 &lt;dbl&gt;
## 1 Haliotis australis     7.55
## 2 Haliotis iris          4.40
```

You would read the sequence  above as:

+ Take the `paua` data.frame then
+ Use this and apply the `group_by()` function to group by `Species`
+ Use this output and apply the `summarize()` function to calculate the mean Age of each group (Species), calling the resulting number `mean_age`


---

# Other resources

+ [R for Data Science](https://r4ds.had.co.nz/)
+ [RStudio Education](https://education.rstudio.com/learn/beginner/)
+ [An Introduction to R](https://intro2r.com/)
+ [Learning statistics with R: A tutorial for psychology students and other beginners](https://learningstatisticswithr.com/lsr-0.6.pdf)
+ [R for Biologists](https://www.rforbiologists.org/)
+ [Quantitative Biology: Basic Introduction to R](http://phylo.wikidot.com/biosci220:quantitative-biology)


---

# Enjoy

![](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/r_rollercoaster.png)
Artwork by [@allison_horst](https://github.com/allisonhorst/)


---
class: inverse, center, middle

# Data wrangling and visualisation

---
class: inverse

# Learning objectives

+ **Define** data sovereignty and **explain** this in relation to a researcher's obligation when collecting, displaying, and analysing data
+ **Define** and **discuss** MƒÅori Data Sovereignty principles
+ **Discuss**the ethics of data vizualisation
+ **Create** and **communicate** informative data visualisations using `R`
+ **Discuss** and **critique** data visualisations
+ **Carry out**, and **interpret** the outputs of, basic exploratory data analysis using in-built R functions

---
class: middle

### [''**Data sovereignty** is the idea that data are subject to the laws and governance structures within the nation it is collected''](https://en.wikipedia.org/wiki/Data_sovereignty)

---
### MƒÅori Data Sovereignty principles

&gt; "For Indigenous peoples, historical encounters with statistics have been fraught, and none more so than when involving official data produced as part of colonial attempts at statecraft." &lt;footer&gt;--- Lovett, R., Lee, V., Kukutai, T., Cormack, D., Rainie, S.C. and Walker, J., 2019. Good data practices for Indigenous data sovereignty and governance. Good data, pp.26-36.&lt;/footer&gt;
 
 &gt; "MƒÅori Data Sovereignty has emerged as a critical policy issue as Aotearoa
New Zealand develops world-leading linked administrative data resources." &lt;footer&gt;--- Andrew Sporle, Maui Hudson, Kiri West. Chapter 5, Indigenous Data Sovereignty and Policy&lt;/footer&gt;

---
### MƒÅori Data Sovereignty principles


&gt; ‚ÄúMƒÅori data refers to data produced by MƒÅori or that is about MƒÅori and the environments we have relationships with."  &lt;footer&gt;--- Te Mana Raraunga Charter&lt;/footer&gt;


&gt; Data is a ‚Äúpotential taonga, something precious that needs to be maintained, in relation to its utility‚Äù &lt;footer&gt;--- Dr W. Edwards, TMR website&lt;/footer&gt;

---
**MƒÅori Data Sovereignty principles** to inform the recognition
of MƒÅori rights and interests in data, and the ethical use of data to enhance MƒÅori well-being:

+ **Rangatiratanga**,authority
+ **Whakapapa**, relationships
+ **Whanaungatanga**, obligations
+ **Kotahitanga**, collective benefit
+ **Manaakitanga**, reciprocity
+ **Kaitiakitanga**, guardianship

---
class: inverse

##  **Rangatiratanga**, authority

 +  MƒÅori have an inherent right to exercise control over MƒÅori data and MƒÅori data ecosystems. This right includes, but is not limited to, the creation, collection, access, analysis, interpretation, management, security, dissemination, use and reuse of MƒÅori data.
 + Decisions about the physical and virtual storage of MƒÅori data shall enhance control for current and future generations. Whenever possible, MƒÅori data shall be stored in Aotearoa New Zealand.
 + MƒÅori have the right to data that is relevant and empowers sustainable self-determination and effective self-governance

---
class: inverse

## **Whakapapa**, relationships

  + All data has a whakapapa (genealogy). Accurate metadata should, at minimum, provide information about the provenance of the data, the purpose(s) for its collection, the context of its collection, and the parties involved.
  + The ability to disaggregate MƒÅori data increases its relevance for MƒÅori communities and iwi. MƒÅori data shall be collected and coded using categories that prioritise MƒÅori needs and aspirations.
  +  Current decision-making over data can have long-term consequences, good and bad, for future generations of MƒÅori. A key goal of MƒÅori data governance should be to protect against future harm.

---
class: inverse

## **Whanaungatanga**, obligations

  + Individuals‚Äô rights (including privacy rights), risks and benefits in relation to data need to be balanced with those of the groups of which they are a part. In some contexts, collective MƒÅori rights will prevail over those of individuals.
  + Individuals and organisations responsible for the creation, collection, analysis, management, access, security or dissemination of MƒÅori data are accountable to the communities, groups and individuals from whom the data derive

---
class: inverse

## **Kotahitanga**, collective benefit

  + Data ecosystems shall be designed and function in ways that enable MƒÅori to derive individual and collective benefit.
  + Build capacity. MƒÅori Data Sovereignty requires the development of a MƒÅori workforce to enable the creation, collection, management, security, governance and application of data.
  + Connections between MƒÅori and other Indigenous peoples shall be supported to enable the sharing of strategies, resources and ideas in relation to data, and the attainment of common goals.
  
---
class: inverse

## **Manaakitanga**, reciprocity

 +  The collection, use and interpretation of data shall uphold the dignity of MƒÅori communities, groups and individuals. Data analysis that stigmatises or blames MƒÅori can result in collective and individual harm and should be actively avoided.
 + Free, prior and informed consent shall underpin the collection and use of all data from or about MƒÅori. Less defined types of consent shall be balanced by stronger governance arrangements.

---
class: inverse

## **Kaitiakitanga**, guardianship

  +  MƒÅori data shall be stored and transferred in such a way that it enables and reinforces the capacity of MƒÅori to exercise kaitiakitanga over MƒÅori data.
  + Ethics. Tikanga, kawa (protocols) and mƒÅtauranga (knowledge) shall underpin the protection, access and use of MƒÅori data.
  + MƒÅori shall decide which MƒÅori
data shall be controlled (tapu) or open (noa) access.


---

### Recearcher's obligations?

<div class="countdown" id="timer_602b5339" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


Resources: 

+ [Why data sovereignty matters](https://www.onenet.co.nz/our-resources/why-data-sovereignty-matters/)
+ [Indigenous Data Sovereignty and Policy](https://library.oapen.org/handle/20.500.12657/42782)
+ [Principles of MƒÅori Data Sovereignty](https://cdn.auckland.ac.nz/assets/psych/about/our-research/documents/TMR%2BM%C4%81ori%2BData%2BSovereignty%2BPrinciples%2BOct%2B2018.pdf)
+ [Good data practices for Indigenous data sovereignty and governance.](https://researchcommons.waikato.ac.nz/bitstream/handle/10289/12919/data%20practices.pdf?sequence=5&amp;isAllowed=y)

---
## Data Viz

&gt; "...have obligations in that we have a great deal of power over how people 
&gt; ultimately make use of data, both in the patterns they see and the conclusions they draw." &lt;footer&gt;--- Michael Correll, Ethical Dimensions of Visualization Research&lt;/footer&gt;

&gt; "Clutter and confusion are not attributes of data - they are shortcomings of design." &lt;footer&gt;--- Edward Tufte&lt;/footer&gt;

---

## Plot types...

--

+ **For you**
  + data exploration
  + doesn't have to look pretty
  + just needs to get to the point


+ **For others**
 + clear purpose
 + designed for the audience
 + make it easy to read (*this covers a lot of things*)
 + do not distort
 

.footnote[[Interesting blogs on graphs in the media](https://www.statschat.org.nz/?s=graphs)]

---

### [Ten Simple Rules for Better Figures](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833)

&gt; "Scientific visualization is classically defined as the process of graphically displaying scientific data. However, this process is far from direct or automatic. There are so many different ways to represent the same data: scatter plots, linear plots, bar plots, and pie charts, to name just a few. Furthermore, the same data, using the same type of plot, may be perceived very differently depending on who is looking at the figure. A more accurate definition for scientific visualization would be a graphical interface between people and data." &lt;footer&gt;--- Nicolas P. Rougier, Michael Droettboom, Philip E. Bourne, Ten Simple Rules for Better Figures &lt;/footer&gt;

---

### [Ten Simple Rules for Better Figures](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833)

.pull-left[
 + **Know** Your Audience
 + **Identify** Your Message
 + **Adapt** the Figure to the Support Medium
 + **Captions** Are Not Optional
 + **Do Not** Trust the Defaults
 ]
.pull-right[ 
 + Use **Color** Effectively
 + **Do Not Mislead** the Reader
 + **Avoid** *Chartjunk*
 + **Message** Trumps Beauty
 + Get the Right **Tool**
 ]

---

### Does not *spark joy*

&lt;img src="https://www.statschat.org.nz/wp-content/uploads/2015/03/nrd4570-f2.jpg" width="50%"&gt;
&lt;img src="https://www.statschat.org.nz/wp-content/uploads/2013/07/article-3178-300x200.png" width="50%"&gt;

.footnote[[Awful graphs about interesting data](https://www.statschat.org.nz/2015/03/18/awful-graphs-about-interesting-data/) &amp; [3d bar graphs: just say no](https://www.statschat.org.nz/2013/07/30/3d-bar-graphs-just-say-no/)]
---
class: inverse

## `ggplot2`

`ggplot2` is an `R` package for producing statistical, or data, graphics; it has an underlying grammar based on the [Grammar of Graphics](https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448)

Every `ggplot2` plot has three key components:

  + `data`,

  + A set of `aes`thetic mappings between variables in the data and visual properties, and

  + At least one layer which describes how to render each observation. Layers are usually created with a `geom` function.



Resources:

+ [`ggplot2` cheatsheet](https://rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf)
+ [Elegant Graphics for Data Analysis](https://ggplot2-book.org/introduction.html)
+ [Using `ggplot2` to communicate your results](https://ourcodingclub.github.io/tutorials/datavis/)

---

### `ggplot2` layers

&lt;img src="https://www.ericchowkokyew.com/wp-content/uploads/2019/07/image-2.png" width="50%"&gt;


---

# Example


```r
library(palmerpenguins) ## contains some nice penguin data
library(ggplot2) ## for plotting
penguins
```

```
## # A tibble: 344 x 8
##    species island bill_length_mm bill_depth_mm flipper_length_‚Ä¶ body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torge‚Ä¶           39.1          18.7              181        3750
##  2 Adelie  Torge‚Ä¶           39.5          17.4              186        3800
##  3 Adelie  Torge‚Ä¶           40.3          18                195        3250
##  4 Adelie  Torge‚Ä¶           NA            NA                 NA          NA
##  5 Adelie  Torge‚Ä¶           36.7          19.3              193        3450
##  6 Adelie  Torge‚Ä¶           39.3          20.6              190        3650
##  7 Adelie  Torge‚Ä¶           38.9          17.8              181        3625
##  8 Adelie  Torge‚Ä¶           39.2          19.6              195        4675
##  9 Adelie  Torge‚Ä¶           34.1          18.1              193        3475
## 10 Adelie  Torge‚Ä¶           42            20.2              190        4250
## # ‚Ä¶ with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```

---







count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
*ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm))   ## data &amp; aesthetics
```
]
 
.right-panel-flippoint-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm)) +  ## data &amp; aesthetics
*   geom_point()   ## geom
```
]
 
.right-panel-flippoint-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_point() +  ## geom
* geom_smooth(method = 'lm', se = FALSE) ## statistics (linear regression line)  ## statistics (linear regression line)
```
]
 
.right-panel-flippoint-auto[

```
## `geom_smooth()` using formula 'y ~ x'
```

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint_auto_3_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flippoint-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flippoint-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flippoint-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
*ggplot(penguins,aes(x = species, y = flipper_length_mm))   ## data &amp; aesthetics
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
*   geom_boxplot()    ## geom
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
* ggtitle("Flipper length (mm) by species")
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_3_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
* ylab("Flipper length (mm)")
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_4_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
  ylab("Flipper length (mm)") +  
* xlab("Species")
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_5_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
  ylab("Flipper length (mm)") +  
  xlab("Species") +  
* theme_dark()  ## theme
```
]
 
.right-panel-flipbox2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flipbox2_auto_6_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flipbox2-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flipbox2-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flipbox2-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---


count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
*ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species))   ## data and aesthetics
```
]
 
.right-panel-flippoint2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint2_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species)) +  ## data and aesthetics
*   geom_point()   ## geom
```
]
 
.right-panel-flippoint2-auto[
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint2_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species)) +  ## data and aesthetics
    geom_point() +  ## geom
* geom_smooth(method = 'lm', se = FALSE) ## statistic (linear regression line without intervals)  ## statistic (linear regression line without intervals)
```
]
 
.right-panel-flippoint2-auto[

```
## `geom_smooth()` using formula 'y ~ x'
```

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/flippoint2_auto_3_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flippoint2-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flippoint2-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flippoint2-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
class: inverse, center, middle

## Live demo

---
class: inverse

### The Good, the Bad, and the Ugly...

.panelset[
 .panel[.panel-name[Boxplot]
 
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/boxes-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Scatter plot (jittered)]

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/jboxes-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Violin plot]

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/vboxes-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Code]

```r
box &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_boxplot()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
jitter &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_jitter()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
violin &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_violin()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
```
]
]

---
class: inverse

.panelset[
 .panel[.panel-name[Plot 1]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/simple-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 1 code]

```r
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) +
    geom_point() +
    geom_smooth(method = "lm", col = "blue", se = FALSE)
```
]
.panel[.panel-name[Plot 2]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/facet-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 2 code]

```r
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm, 
                         col = species)) +
    geom_point(size = 2, alpha = 0.5) + 
    geom_smooth(method = "lm", se = FALSE) +
    facet_grid(~ sex) +
    theme_bw() + 
    labs(title = "Flipper Length and Body Mass, by Sex &amp; Species",
         subtitle = paste0(nrow(penguins), " of the Palmer Penguins"),
         x = "Body Mass (g)", 
         y = "Flipper Length (mm)")
```
]
.panel[.panel-name[Plot 3]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/facetna-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 3 code]

```r
penguins_nafree &lt;- penguins %&gt;% drop_na()
ggplot(penguins_nafree, aes(x = body_mass_g, y = flipper_length_mm, 
                         col = species)) +
    geom_point(size = 2, alpha = 0.5) + 
    geom_smooth(method = "lm", se = FALSE) +
    facet_grid(~ sex) +
    theme_bw() + 
    labs(title = "Flipper Length and Body Mass, by Sex &amp; Species",
         subtitle = paste0(nrow(penguins), " of the Palmer Penguins"),
         x = "Body Mass (g)", 
         y = "Flipper Length (mm)")
```
]
]


---
class: center, middle

## The Good, the Bad, and the Ugly...

### Reflections.
### Improvements? Additions?
### What do these plots suggest?

<div class="countdown" id="timer_602b51ac" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---

class: center, middle

## Common dataframe manipulations in the `tidyverse`

### Using `dplyr` and `tidyr`

&lt;iframe src="https://dplyr.tidyverse.org/" width="100%" height="400px"&gt;&lt;/iframe&gt;


---
background-image: url("https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_1.jpg")
background-size: contain

# `tidy` data

.footnote[background image: illustrations from the Openscapes blog [Tidy Data for reproducibility, efficiency, and collaboration](https://www.openscapes.org/blog/2020/10/12/tidy-data/) by Julia Lowndes and Allison Horst]

---
### Removing NA values


```r
penguins_nafree &lt;- penguins %&gt;% drop_na()
penguins_nafree
```

```
## # A tibble: 333 x 8
##    species island bill_length_mm bill_depth_mm flipper_length_‚Ä¶ body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torge‚Ä¶           39.1          18.7              181        3750
##  2 Adelie  Torge‚Ä¶           39.5          17.4              186        3800
##  3 Adelie  Torge‚Ä¶           40.3          18                195        3250
##  4 Adelie  Torge‚Ä¶           36.7          19.3              193        3450
##  5 Adelie  Torge‚Ä¶           39.3          20.6              190        3650
##  6 Adelie  Torge‚Ä¶           38.9          17.8              181        3625
##  7 Adelie  Torge‚Ä¶           39.2          19.6              195        4675
##  8 Adelie  Torge‚Ä¶           41.1          17.6              182        3200
##  9 Adelie  Torge‚Ä¶           38.6          21.2              191        3800
## 10 Adelie  Torge‚Ä¶           34.6          21.1              198        4400
## # ‚Ä¶ with 323 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```

---
### Extract rows that meet logical criteria


```r
dplyr::filter(penguins_nafree, island == "Torgersen" )
```

```
## # A tibble: 47 x 8
##    species island bill_length_mm bill_depth_mm flipper_length_‚Ä¶ body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torge‚Ä¶           39.1          18.7              181        3750
##  2 Adelie  Torge‚Ä¶           39.5          17.4              186        3800
##  3 Adelie  Torge‚Ä¶           40.3          18                195        3250
##  4 Adelie  Torge‚Ä¶           36.7          19.3              193        3450
##  5 Adelie  Torge‚Ä¶           39.3          20.6              190        3650
##  6 Adelie  Torge‚Ä¶           38.9          17.8              181        3625
##  7 Adelie  Torge‚Ä¶           39.2          19.6              195        4675
##  8 Adelie  Torge‚Ä¶           41.1          17.6              182        3200
##  9 Adelie  Torge‚Ä¶           38.6          21.2              191        3800
## 10 Adelie  Torge‚Ä¶           34.6          21.1              198        4400
## # ‚Ä¶ with 37 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```

---

### Summarise data into single row of values


```r
dplyr::summarise(penguins_nafree, avgerage_bill_length = mean(bill_length_mm))
```

```
## # A tibble: 1 x 1
##   avgerage_bill_length
##                  &lt;dbl&gt;
## 1                 44.0
```

---

### Group data into rows with the same value of Species




```r
dplyr::group_by(penguins_nafree, species)
```

```
## # A tibble: 333 x 8
## # Groups:   species [3]
##    species island bill_length_mm bill_depth_mm flipper_length_‚Ä¶ body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torge‚Ä¶           39.1          18.7              181        3750
##  2 Adelie  Torge‚Ä¶           39.5          17.4              186        3800
##  3 Adelie  Torge‚Ä¶           40.3          18                195        3250
##  4 Adelie  Torge‚Ä¶           36.7          19.3              193        3450
##  5 Adelie  Torge‚Ä¶           39.3          20.6              190        3650
##  6 Adelie  Torge‚Ä¶           38.9          17.8              181        3625
##  7 Adelie  Torge‚Ä¶           39.2          19.6              195        4675
##  8 Adelie  Torge‚Ä¶           41.1          17.6              182        3200
##  9 Adelie  Torge‚Ä¶           38.6          21.2              191        3800
## 10 Adelie  Torge‚Ä¶           34.6          21.1              198        4400
## # ‚Ä¶ with 323 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```

---

### Compute separate summary row for each group


```r
penguins_nafree %&gt;% 
  group_by(species) %&gt;% 
  summarise(avgerage_bill_length = mean(bill_length_mm))
```

```
## # A tibble: 3 x 2
##   species   avgerage_bill_length
## * &lt;fct&gt;                    &lt;dbl&gt;
## 1 Adelie                    38.8
## 2 Chinstrap                 48.8
## 3 Gentoo                    47.6
```

---

### Compute separate summary row for each group


```r
penguins_nafree %&gt;% 
  group_by(island,species) %&gt;% 
  summarise(avgerage_bill_length = mean(bill_length_mm))
```

```
## `summarise()` has grouped output by 'island'. You can override using the `.groups` argument.
```

```
## # A tibble: 5 x 3
## # Groups:   island [3]
##   island    species   avgerage_bill_length
##   &lt;fct&gt;     &lt;fct&gt;                    &lt;dbl&gt;
## 1 Biscoe    Adelie                    39.0
## 2 Biscoe    Gentoo                    47.6
## 3 Dream     Adelie                    38.5
## 4 Dream     Chinstrap                 48.8
## 5 Torgersen Adelie                    39.0
```


---
class: inverse, center, middle

## Back to plots; they are more than just pretty.

### The average values are all well and good... but... variation?

#### within... between... what does it all mean.

---
class: center
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;


---
class: center
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/unnamed-chunk-13-1.png)&lt;!-- --&gt;


---
class: center
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;

---
class: center
![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;

---
class: center

![](/home/charlotte/Git/BIOSCI738/module1/index_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;

---

class: inverse, center, middle

## Thoughts?

<div class="countdown" id="timer_602b527a" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">\n  <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">\n  </div>\n</div>\n"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
