<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>BIOSCI738</title>
    <meta charset="utf-8" />
    <meta name="author" content="Charlotte M. Jones-Todd" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# BIOSCI738
## <img src="../intro/img/uoa.png" style="width:5.0%" /> Universty of Auckland
### Charlotte M. Jones-Todd
### <a href="https://stats-uoa.github.io/BIOSCI738/">bluepages</a>
### Module 1: Exploratory Data Analysis and Communication

---

class: inverse, center, middle



&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 20px;
    padding: 1em 4em 1em 4em;
}
&lt;/style&gt;



# `R` and `RStudio`
## Week 1

---
class: inverse

# Learning objectives

+ **Define** the difference between `R` and `RStudio`
+ **Explain** what an `R` function is; describe what an argument to an `R` function is
+ **Explain** what an `R` package is; distinguish between the functions `install.packages()` and `library()`
+ **Use** the appropriate `R` function to read in a data file

---
class:  center

# R is the pheromone to RStudio's PDA.

![](img/r-rstudio-pda.jpg)

---
class:  center, middle

# R is the pheromone to RStudio's PDA.

.small[`R` is a language. Specifically a programming language; it's the way you can speak to your computer to ask it to carry out certain computations.

`RStudio` is an integrated development environment (IDE). This means it is basically an interface, albeit a fancy one, that makes it easier to communicate with your computer in the `R` language. The main benefit is the additional features it has that enable you to more efficiently *speak* `R`.

**Note** `R` and `RStudio` are two **different** pieces of software; for this course you are expected to download both. As you'd expect the PDA depends on the pheromones (i.e., `RStudio` depends on `R`) so you have to download `R` to use `RStudio`! ]

---
# Why R? 
#### not an extensive list

--
+ Free

--
+ Open source

--
+ Huge online support network

--
+ Flexible; if you can code it you can do it!

--
+ Reproduciblity


---

# Why RStudio? 
#### not an extensive list

--
+ Works nicely with R

--
+ Huge online support network

--
+ Flexible; so, so, many tools and additions!

--
+ Reproduciblity

---
class: inverse

# Installing R and RStudio

As mentioned above `RStudio` depends on `R` so there is an order you should follow when you download these software.

 1. **Download and install `R`** by following [these instructions](https://cloud.r-project.org/). Make sure you choose the correct operating system.
 
 2. **Download and install `RStudio`** by [going here](https://rstudio.com/products/rstudio/download/) choosing RStudio Desktop *Open Source License* **Free** and following instructions. 
 
---
class: inverse

### Check all is working

  + Open up `RStudio` from your computer menu, the icon will look something like this &lt;img src="https://vectorified.com/images/rstudio-icon-31.png" width="7%"&gt; (**DO NOT** use this icon &lt;img src="https://cdn.iconscout.com/icon/free/png-512/r-5-283170.png" width="4%"&gt; this is a link to `R` and will only open a very basic interface)
  + Wait a little and you should see `RStudio` open up to something similar to the screenshot below
  
    &lt;img src="https://stats220.earo.me/img/rstudio-interface.png" width="70%"&gt; 
    
    
  + .small[Pay close attention to the notes in the screenshot and familiarise yourself with the terms.]

    
---
## Change the `RStudio` appearance up to your taste

Go to **Tools** &gt; **Global Options** &gt; **Apperance**

![](https://support.rstudio.com/hc/article_attachments/115020425168/Screen_Shot_2017-08-24_at_1.14.19_PM.png)

---
## Good practice: always start with a clean workspace


Go to **Tools** &gt; **Global Options**

![](https://miro.medium.com/max/2784/1*dUNl71Jic2zYhYS2hxOBZA.png)

---
### Why? So your ex (code) can't come and mess up your life!


![](https://memegenerator.net/img/instances/57296391/when-your-ex-texts-you-after-months-hey-whats-up-not-today-satan-not-today.jpg)



---

class: inverse

# Recommened: `.Rproj`
## Project-oriented workflow

+ **Organised** Set up each Each assignment/university course as a *project*
+ **Self-contained** a *project* is a folder that contains all relevant files
   + All paths can then be relative to that *project*
+ **Reproducible** the *project* should just work on a different computer

---

class: inverse

# Recommened: `.Rproj`


Got to **Project** (top right) &gt; **New Project** &gt; **Create Project** ![](https://stats220.earo.me/img/rstudio-proj.png)

---
class: inverse

## Project-oriented workflow

&lt;img src="https://raw.githubusercontent.com/martinctc/blog/master/images/RPROJECT_2000dpi.png" width="50%"&gt;

---

# Reproducible research

### Keep all similar files for the same analysis in the same place 

### **NEVER** change raw data


---

class: inverse

## ‚ö†Ô∏èWarning‚ö†Ô∏è

[Jenny Bryan will set your computer on fire](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/) üî• if you start your script like this


```r
rm(list = ls())
```

This
+ does **NOT** create a fresh `R` process
+ it makes your script vulnerable
+ ...

---

## R errors  üò±


```r
data &lt;- read.csv("data_file_not_in_my_working_directory.csv")
```

```
## Warning in file(file, "rt"): cannot open file
## 'data_file_not_in_my_working_directory.csv': No such file or directory
```

```
## Error in file(file, "rt"): cannot open the connection
```

```r
library(some_library_I_have_not_installed)
```

```
## Error in library(some_library_I_have_not_installed): there is no package called 'some_library_I_have_not_installed'
```

```r
some_function_I_spelled_worng(x = x)
```

```
## Error in some_function_I_spelled_worng(x = x): could not find function "some_function_I_spelled_worng"
```

```r
an_object_I_have_not_created
```

```
## Error in eval(expr, envir, enclos): object 'an_object_I_have_not_created' not found
```

---
## Starting out with `tidyverse`


&lt;img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidyverse_celestial.png" width="50%"&gt;

Artwork by [@allison_horst](https://github.com/allisonhorst/)

---
## Starting out with `tidyverse`

For EDA we will be using `tidyverse`. ['tidyverse'](https://www.tidyverse.org/) is a collection of `R` packages that all share underlying design philosophy, grammar, and data structures. They are specifically designed to make data wrangling, manipulation, visualisation, and analysis simpler.

To install **all** the packages that belong to the `tidyverse` run


```r
## request (download) the tidyverse packages from the centralised library
install.packages("tidyverse")
```

To tell your computer to access the `tidyverse` functionality in your session run  (**Note** you'll have to do this each time you start up an `R` session):


```r
## Get the tidyverse packages from our local library
library(tidyverse)
```

---
### Reading in data from a `.csv` file

First off download the `paua.csv` file from CANVAS 

To read the data into `RStudio` 

 1. In the *Environment* pane click **Import Dataset** &gt;  ** From Text (readr)** &gt; **Browse** &gt; *Choose your file, remembering which folder you downloaded it to. this is where `.Rproj` is useful* &gt; *Another pane should pop up, check the data looks as you might expect* &gt; **Import**
 
 


2. Or


```r
paua &lt;- read_csv("paua.csv")
```


---
## Explore your data

Let's have a look at your data in the *Console*


```r
paua
```

```
## # A tibble: 60 x 3
##    Species            Length   Age
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 Haliotis iris        1.8   1.50
##  2 Haliotis australis   5.4  11.9 
##  3 Haliotis australis   4.8   5.42
##  4 Haliotis iris        5.75  4.50
##  5 Haliotis iris        5.65  5.50
##  6 Haliotis iris        2.8   2.50
##  7 Haliotis australis   5.9   6.49
##  8 Haliotis iris        3.75  5.00
##  9 Haliotis australis   7.2   8.56
## 10 Haliotis iris        4.25  5.50
## # ‚Ä¶ with 50 more rows
```

---
## Explore your data

Using the `glimpse()` command for an alternative view


```r
glimpse(paua)
```

```
## Rows: 60
## Columns: 3
## $ Species &lt;chr&gt; "Haliotis iris", "Haliotis australis", "Haliotis australis", ‚Ä¶
## $ Length  &lt;dbl&gt; 1.80, 5.40, 4.80, 5.75, 5.65, 2.80, 5.90, 3.75, 7.20, 4.25, 6‚Ä¶
## $ Age     &lt;dbl&gt; 1.497884, 11.877010, 5.416991, 4.497799, 5.500789, 2.500972, ‚Ä¶
```

---
### The pipe operator `%&gt;%`

A nifty `tidyverse` tool is called the pipe operator `%&gt;%`. The pipe operator allows us to combine multiple operations in `R` into a single sequential chain of actions.

Say you would like to perform a hypothetical sequence of operations on a hypothetical data frame x using hypothetical functions f(), g(), and h():

+ Take `x` then
+ Use `x` as an input to a function `f()` then
+ Use the output of this as an input to a function `g()` then
+ Use the output of this as an input to a function `h()`


---

So to calculate the mean **Age** of each **Species** in the `paua` dataset we would use


```r
paua %&gt;%
group_by(Species) %&gt;%
summarize(mean_age = mean(Age))
```

```
## # A tibble: 2 x 2
##   Species            mean_age
## * &lt;chr&gt;                 &lt;dbl&gt;
## 1 Haliotis australis     7.55
## 2 Haliotis iris          4.40
```

You would read the sequence  above as:

+ Take the `paua` data.frame then
+ Use this and apply the `group_by()` function to group by `Species`
+ Use this output and apply the `summarize()` function to calculate the mean Age of each group (Species), calling the resulting number `mean_age`


---

# Other resources

+ [R for Data Science](https://r4ds.had.co.nz/)
+ [RStudio Education](https://education.rstudio.com/learn/beginner/)
+ [An Introduction to R](https://intro2r.com/)
+ [Learning statistics with R: A tutorial for psychology students and other beginners](https://learningstatisticswithr.com/lsr-0.6.pdf)
+ [R for Biologists](https://www.rforbiologists.org/)
+ [Quantitative Biology: Basic Introduction to R](http://phylo.wikidot.com/biosci220:quantitative-biology)


---

# Enjoy

![](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/r_rollercoaster.png)
Artwork by [@allison_horst](https://github.com/allisonhorst/)


---
class: inverse, center, middle

# Data wrangling and visualisation
## Week 2

---
class: inverse

# Learning objectives

+ **Define** data sovereignty and **explain** this in relation to a researcher's obligation when collecting, displaying, and analysing data
+ **Create** and **communicate** informative data visualisations using `R`
+ **Discuss** and **critique** data visualisations
+ **Carry out**, and **interpret** the outputs of, basic exploratory data analysis using in-built R functions
+ **Communicate** statistical concepts and experimental outcomes clearly using language appropriate for both a **scientific** and **non-scientific** audience

---
class: middle

### [''**Data sovereignty** is the idea that data are subject to the laws and governance structures within the nation it is collected''](https://en.wikipedia.org/wiki/Data_sovereignty)

### Recearcher's obligations?

<div class="countdown" id="timer_6022280d" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


Resources: 

+ [Why data sovereignty matters](https://www.onenet.co.nz/our-resources/why-data-sovereignty-matters/)
+ [Indigenous Data Sovereignty and Policy](https://library.oapen.org/handle/20.500.12657/42782)
+ [Principles of MƒÅori Data Sovereignty](https://cdn.auckland.ac.nz/assets/psych/about/our-research/documents/TMR%2BM%C4%81ori%2BData%2BSovereignty%2BPrinciples%2BOct%2B2018.pdf)


---
class: inverse

## `ggplot2`

`ggplot2` is an `R` package for producing statistical, or data, graphics; it has an underlying grammar based on the [Grammar of Graphics](https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448)

Every `ggplot2` plot has three key components:

  + `data`,

  + A set of `aes`thetic mappings between variables in the data and visual properties, and

  + At least one layer which describes how to render each observation. Layers are usually created with a `geom` function.



Resources:

+ [`ggplot2` cheatsheet](https://rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf)
+ [Elegant Graphics for Data Analysis](https://ggplot2-book.org/introduction.html)

---

### `ggplot2` layers

&lt;img src="https://www.ericchowkokyew.com/wp-content/uploads/2019/07/image-2.png" height="80%"&gt;


---

# Example


```r
library(palmerpenguins) ## contains some nice penguin data
library(ggplot2) ## for plotting
penguins
```

```
## # A tibble: 344 x 8
##    species island bill_length_mm bill_depth_mm flipper_length_‚Ä¶ body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torge‚Ä¶           39.1          18.7              181        3750
##  2 Adelie  Torge‚Ä¶           39.5          17.4              186        3800
##  3 Adelie  Torge‚Ä¶           40.3          18                195        3250
##  4 Adelie  Torge‚Ä¶           NA            NA                 NA          NA
##  5 Adelie  Torge‚Ä¶           36.7          19.3              193        3450
##  6 Adelie  Torge‚Ä¶           39.3          20.6              190        3650
##  7 Adelie  Torge‚Ä¶           38.9          17.8              181        3625
##  8 Adelie  Torge‚Ä¶           39.2          19.6              195        4675
##  9 Adelie  Torge‚Ä¶           34.1          18.1              193        3475
## 10 Adelie  Torge‚Ä¶           42            20.2              190        4250
## # ‚Ä¶ with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```

---







count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
*ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm))   ## data &amp; aesthetics
```
]
 
.right-panel-flippoint-auto[
![](index_files/figure-html/flippoint_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm)) +  ## data &amp; aesthetics
*   geom_point()   ## geom
```
]
 
.right-panel-flippoint-auto[
![](index_files/figure-html/flippoint_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot
.left-panel-flippoint-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_point() +  ## geom
* geom_smooth(method = 'lm', se = FALSE) ## statistics (linear regression line)  ## statistics (linear regression line)
```
]
 
.right-panel-flippoint-auto[

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/flippoint_auto_3_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flippoint-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flippoint-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flippoint-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
*ggplot(penguins,aes(x = species, y = flipper_length_mm))   ## data &amp; aesthetics
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
*   geom_boxplot()    ## geom
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
* ggtitle("Flipper length (mm) by species")
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_3_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
* ylab("Flipper length (mm)")
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_4_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
  ylab("Flipper length (mm)") +  
* xlab("Species")
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_5_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: boxplot and theme
.left-panel-flipbox2-auto[

```r
ggplot(penguins,aes(x = species, y = flipper_length_mm)) +  ## data &amp; aesthetics
    geom_boxplot()  +  ## geom
  ggtitle("Flipper length (mm) by species") +  
  ylab("Flipper length (mm)") +  
  xlab("Species") +  
* theme_dark()  ## theme
```
]
 
.right-panel-flipbox2-auto[
![](index_files/figure-html/flipbox2_auto_6_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flipbox2-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flipbox2-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flipbox2-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---


count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
*ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species))   ## data and aesthetics
```
]
 
.right-panel-flippoint2-auto[
![](index_files/figure-html/flippoint2_auto_1_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species)) +  ## data and aesthetics
*   geom_point()   ## geom
```
]
 
.right-panel-flippoint2-auto[
![](index_files/figure-html/flippoint2_auto_2_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
## Example: scatter plot by species
.left-panel-flippoint2-auto[

```r
ggplot(penguins,aes(x = body_mass_g, y = flipper_length_mm, color = species)) +  ## data and aesthetics
    geom_point() +  ## geom
* geom_smooth(method = 'lm', se = FALSE) ## statistic (linear regression line without intervals)  ## statistic (linear regression line without intervals)
```
]
 
.right-panel-flippoint2-auto[

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/flippoint2_auto_3_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.left-panel-flippoint2-auto {
  color: #777;
  width: 38.6138613861386%;
  height: 92%;
  float: left;
  font-size: 80%
}
.right-panel-flippoint2-auto {
  width: 59.4059405940594%;
  float: right;
  padding-left: 1%;
  font-size: 80%
}
.middle-panel-flippoint2-auto {
  width: 0%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
class: inverse, center, middle

## Live demo

---
class: inverse

### The Good, the Bad, and the Ugly...

.panelset[
 .panel[.panel-name[Plot]

```
## 
## Attaching package: 'gridExtra'
```

```
## The following object is masked from 'package:dplyr':
## 
##     combine
```

![](index_files/figure-html/boxes-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Code]

```r
box &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_boxplot()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
jitter &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_jitter()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
violin &lt;- ggplot(penguins,aes(x = species, y = flipper_length_mm)) + ## data &amp; aesthetics
    geom_violin()  + ## geom
  ggtitle("Flipper length (mm) by species") +
  ylab("Flipper length (mm)") +
  xlab("Species") +
  theme_dark() ## theme
require(gridExtra) ## nice package to arrange ggplots
grid.arrange(box, jitter, violin)
```
]
]

---
class: inverse

.panelset[
 .panel[.panel-name[Plot 1]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/simple-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 1 code]

```r
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) +
    geom_point() +
    geom_smooth(method = "lm", col = "blue", se = FALSE)
```
]
.panel[.panel-name[Plot 2]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/facet-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 2 code]

```r
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm, 
                         col = species)) +
    geom_point(size = 2, alpha = 0.5) + 
    geom_smooth(method = "lm", se = FALSE) +
    facet_grid(~ sex) +
    theme_bw() + 
    labs(title = "Flipper Length and Body Mass, by Sex &amp; Species",
         subtitle = paste0(nrow(penguins), " of the Palmer Penguins"),
         x = "Body Mass (g)", 
         y = "Flipper Length (mm)")
```
]
.panel[.panel-name[Plot 3]

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/facetna-1.png)&lt;!-- --&gt;
]
.panel[.panel-name[Plot 3 code]

```r
penguins_nafree &lt;- penguins %&gt;% drop_na()
ggplot(penguins_nafree, aes(x = body_mass_g, y = flipper_length_mm, 
                         col = species)) +
    geom_point(size = 2, alpha = 0.5) + 
    geom_smooth(method = "lm", se = FALSE) +
    facet_grid(~ sex) +
    theme_bw() + 
    labs(title = "Flipper Length and Body Mass, by Sex &amp; Species",
         subtitle = paste0(nrow(penguins), " of the Palmer Penguins"),
         x = "Body Mass (g)", 
         y = "Flipper Length (mm)")
```
]
]


---
class: center, middle

## The Good, the Bad, and the Ugly...

### Reflections.
### Improvements? Additions?
### What do these plots suggest?

<div class="countdown" id="timer_602228a2" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, center, middle

# Experimental Design
## Week 2

---
class: inverse
## Learning Objectives


   + **Identify** the following experimental units
      + experimental unit
      + observational units
   + **List** and **describe** the three main principals of experimental design
       + Randomization
       + Replication
       + Blocking
   + **Discuss** the advantages and disadvantages of different designs
   + **Critique** experimental designs
   
---

# The language of design

.pull-left[![](img/cox.png)
[Gertrude Mary Cox](https://en.wikipedia.org/wiki/Gertrude_Mary_Cox)]

.pull-right[![](img/cochran.png)

[William Gemmell Cochran](https://en.wikipedia.org/wiki/William_Gemmell_Cochran)]

[Cochran, William G.; Cox, Gertrude M. (1950). Experimental Designs. New York: Wiley.](https://www.wiley.com/en-us/Experimental+Designs%2C+2nd+Edition-p-9780471545675)

---
### Fisher... 


.pull-left[![](https://upload.wikimedia.org/wikipedia/commons/a/aa/Youngronaldfisher2.JPG)

*a genius who almost single-handedly created the foundations for modern statistical science*]

--

.pull-right[
### You should also know

[![](img/fisher.png)](https://www.newstatesman.com/international/science-tech/2020/07/ra-fisher-and-science-hatred)

[RA Fisher and the science of hatred](https://statmodeling.stat.columbia.edu/2020/08/01/ra-fisher-and-the-science-of-hatred/)

[\#Topple The Racists](https://www.bbc.com/news/uk-england-cambridgeshire-53023823)]


---
class: center, middle

# Three key principles:


## **Replication**
## **Randomization**
## **Blocking**


---
## Overview and key phrases

 + **Scientific objective:** The biological question (**AVOID BEING VAGUE**)
    + Should include details such as what is being *compared*, what is being *measured* and *how*, and under what *experimental conditions* etc.

---

# Scientific objective
### Compare three surgical conditionings of a biofluid
#### Too vague!

--

 + Which biofluid and collected from what?
 + How will they be compared?
    + What will be measured?
    + How will it be measured?
    + Under which experimental conditions?
    + By whom?
    
---
# Scientific objective

### Compare three surgical conditionings of a biofluid


+ Organism? Male Wistar Rat
+ Cell, tissue, biofluid? Lymph
+ What? Global proteomic profile
+ Proteins + Abundances
+ How? 2D‚ÄìLC‚ÄìMS/MS

---
class: inverse, center, middle

 **Experimental unit** Smallest portion of experimental material which is *independently* perturbed
 
--

**Treatment** The experimental condition *independently* applied to an experimental unit

--

**Observational unit** The smallest unit on which a response is measured. If one measurement is made on each rat: **Observational unit** = **Experimental unit**. If Multiple measurements are made on each rat: Each experimental unit has &gt;1 observational unit (*pseudo-* or *technical replication*).
  
---
class: center, middle

## Experimental or Observational unit?

<div class="countdown" id="timer_60222a40" style="top:0;right:0;font-size:48px;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

### [https://b.socrative.com/login/student/](https://b.socrative.com/login/student/)
### Room Name: BIOSCIUOA

---

class: inverse

# 1st major principle: Replication

![](https://media.makeameme.org/created/precision-ypqmw8.jpg)

---

class: inverse

# 1st major principle: Replication

+ **Biological replication:** each treatment is *independently* applied to each of several humans, animals or plants
  + To generalize results to population

--

+ **Technical replication:** two or more samples from the same biological source which are *independently* processed
  + Advantageous if processing steps introduce a lot of variation
  + Increases the precision with which comparisons of relative abundances between treatments are made
  
--

+ **Pseudo-replication:** one sample from the same biological source, divided into two or more aliquots which are **independently** measured
  + Advantageous for noisy measuring instruments
  + Increases the **precision** with which comparisons of relative abundances between treatments are made
  
---

class: inverse

# 2nd major principle: Randomisation

![](https://media.makeameme.org/created/your-bias-is.jpg)

---

class: inverse

# 2nd major principle: Randomisation

+ **Protects against bias**


+ Plan the experiment in such a way that the variations caused by extraneous factors can all be combined under the general heading of "chance".

+ Ensures that each treatment has the same probability of getting good (or bad) units and thus
avoids systematic bias
+ random allocation can cancel out population bias; it ensures that any other possible causes for the experimental results are split equally between groups
+ typically statistical analysis assumes that observations are **independent**. This is almost never strictly true in practice but randomisation means that our estimates will behave as if they were based on independent observations

---

class: inverse

# 3rd major principle: Blocking

![](https://www.memecreator.org/static/images/memes/4524459.jpg)
---

class: inverse

# 3rd major principle: Blocking


Blocking helps **control variability** by making treatment groups more alike. Experimental units are divided into subsets (called blocks) so that units within the same block are more similar than units from different subsets or blocks. 

Blocking is a technique for dealing with *nuisance factors*.

A *nuisance factor* is a factor that has some effect on the response, but is of no interest (e.g., age class).



---

# Other resources


[Glass, David J. Experimental Design for Biologists. Second ed. 2014. Print.](https://catalogue.library.auckland.ac.nz/primo-explore/fulldisplay?docid=uoa_alma21237737730002091&amp;search_scope=Combined_Local&amp;tab=books&amp;vid=NEWUI&amp;context=L)

[Welham, S. J. Statistical Methods in Biology : Design and Analysis of Experiments and Regression. 2015. Print.](https://catalogue.library.auckland.ac.nz/primo-explore/fulldisplay?docid=uoa_alma21237737830002091&amp;search_scope=Combined_Local&amp;tab=books&amp;vid=NEWUI&amp;context=L)

[Fisher, Ronald Aylmer. The Design of Experiments. 8th ed. Edinburgh: Oliver &amp; Boyd, 1966. Print. O &amp; B Paperbacks.](https://catalogue.library.auckland.ac.nz/primo-explore/fulldisplay?docid=uoa_alma21198532990002091&amp;context=L&amp;vid=NEWUI&amp;lang=en_US&amp;search_scope=Combined_Local&amp;adaptor=Local%20Search%20Engine&amp;isFrbr=true&amp;tab=books&amp;query=any,contains,The_Design_of_Experiments&amp;sortby=date&amp;facet=frbrgroupid,include,627497507&amp;offset=0)


---
class: inverse, center, middle

# Analysis of a Completely Randomised Design in `R`
## One-Way Analysis of Variance (ANOVA)
## Week 2

---
class: inverse
## Learning Objectives

+ **Explain**
+ **Describe** a Completely Randomised (experimental) Design 
+ **Carry** out a one-way ANOVA in `R` and **draw** the appropriate inference
+ **Define**

---

## One-way ANOVA
### *everything is a regression*


```r
library(tidyverse)
rats &lt;- read_csv("../data/crd_rats_data.csv")
rats
```

```
## # A tibble: 12 x 3
##    Surgery   Rat logAUC
##    &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1 C           1   8.49
##  2 C           2   8.2 
##  3 C           3   9.08
##  4 C           4   8.07
##  5 P           1  10.2 
##  6 P           2   7.72
##  7 P           3   9.34
##  8 P           4   8.5 
##  9 S           1  11.3 
## 10 S           2  12.7 
## 11 S           3  11.4 
## 12 S           4  10.8
```
## One-way ANOVA
### *everything is a regression*


```r
ggplot(data = rats,aes(x = Surgery, y = logAUC)) +
  geom_violin()
```

![](index_files/figure-html/plot-1.png)&lt;!-- --&gt;


---

## One-way ANOVA
### *everything is a regression*


```r
rats_aov &lt;- aov(logAUC ~ Surgery, data = rats)
rats_aov
```

```
## Call:
##    aov(formula = logAUC ~ Surgery, data = rats)
## 
## Terms:
##                   Surgery Residuals
## Sum of Squares  22.026350  6.059075
## Deg. of Freedom         2         9
## 
## Residual standard error: 0.8205063
## Estimated effects may be unbalanced
```

---

## One-way ANOVA
### *everything is a regression*


```r
rats_lm &lt;- lm(logAUC ~ Surgery, data = rats)
anova(rats_lm)
```

```
## Analysis of Variance Table
## 
## Response: logAUC
##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
## Surgery    2 22.0263 11.0132  16.359 0.001006 **
## Residuals  9  6.0591  0.6732                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

## One-way ANOVA
### Inference


```r
summary(rats_lm)$coef
```

```
##             Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)   8.4600  0.4102531 20.6214144 6.930903e-09
## SurgeryP      0.4900  0.5801856  0.8445574 4.202408e-01
## SurgeryS      3.0875  0.5801856  5.3215734 4.799872e-04
```

---

# One-way ANOVA
## Inference

Hypothesis: We test the Null hypothesis, `\(H_0\)`, population (`Surgery`) means are the same on average verses the alternative hypothesis, `\(H_1\)`, that **at least one** differs from the others!

Assumptions: 

  + Each observation is independent of the other
  + Each datapoint (`logAUC`) come from the same distribution
  
Test Statistic: F-statistic = `\({\frac  {{\text{explained variance}}}{{\text{unexplained variance}}}} = {\frac  {{\text{between-group variability}}}{{\text{within-group variability}}}}\)` 


---

## Inference

Probability of getting an  F-statistic at least as extreme as the one we observe (think of the area under the tails of the curve below) *p-value* Pr(&gt;F)= 0.001 tells us we have sufficient evidence to reject `\(H_0\)` at the 1% level of significance


![](index_files/figure-html/f-1.png)&lt;!-- --&gt;
---

# üò± p-values üò±

### [The ASA Statement on p-Values: Context, Process, and Purpose](https://www.tandfonline.com/doi/full/10.1080/00031305.2016.1154108)

**Q:** Why do so many colleges and grad schools teach *p-val*=0.05?


**A:** Because that's still what the scientific community and journal editors use.


**Q:** Why do so many people still use *p-val*=0.05?


**A:** Because that's what they were taught in college or grad school. 

---

# üò± p-values üò±

**What is a p-Value?**

Informally, a p-value is the probability under a specified statistical model that a statistical summary of the data (e.g., the sample mean difference between two compared groups) would be equal to or more extreme than its observed value


---
# üò± p-values üò±

**p-values** can indicate how incompatible the data are with a specified statistical model

--

p-values **do not** measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone

--

Scientific conclusions and business or policy decisions **should not** be based only on whether a p-value passes a specific threshold

--

Proper inference requires **full** reporting and transparency

--

A p-value, or statistical significance, does **not** measure the size of an effect or the importance of a result

--

By itself, a p-value does **not** provide a good measure of evidence regarding a model or hypothesis

---
# üò± p-values üò±

&gt; "Good statistical practice, as an essential component of good scientific practice, 
&gt; emphasizes principles of good study design and conduct, a variety of numerical 
&gt; and graphical summaries of data, understanding of the phenomenon under study, 
&gt; interpretation of results in context, complete reporting and proper
&gt; logical and quantitative understanding of what data summaries mean. 
&gt; No single index should substitute for scientific reasoning."


&gt; &lt;footer&gt;--- ASA Statement on p-Values&lt;/footer&gt;


---

The ANOVA enables us to:

 + Test only  the global null hypothesis of *no difference between any of the treatment groups' means*
	
 + Estimate the population variance. (We'll come back to why this is important)

--

But...


A primary goal of our experiment
  + Biologically speaking: To identify which pairs  of treatments are biologically different from one another
  
  + Statistically speaking: To identify which pairs of treatment means  are statistically  different from one another 

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">\n  <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">\n  </div>\n</div>\n"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
