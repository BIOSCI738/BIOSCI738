<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Split-plot and repeated measures designs | bluebook BIOSCI738</title>
  <meta name="description" content="9 Split-plot and repeated measures designs | bluebook BIOSCI738" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Split-plot and repeated measures designs | bluebook BIOSCI738" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Split-plot and repeated measures designs | bluebook BIOSCI738" />
  
  
  

<meta name="author" content="Charlotte Jones-Todd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="blocking-incorporating-into-design-and-analysis-of.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="src/my-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#course-overview"><i class="fa fa-check"></i><b>0.1</b> Course Overview</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#key-topics"><i class="fa fa-check"></i><b>0.2</b> Key Topics</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html"><i class="fa fa-check"></i><b>1</b> <code>R</code>, <code>RStudio</code>, and <code>git</code></a><ul>
<li class="chapter" data-level="1.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#intro-to-r-rstudio"><i class="fa fa-check"></i><b>1.2</b> Intro to <code>R</code> &amp; <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#why"><i class="fa fa-check"></i><b>1.2.1</b> Why?</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#r-errors"><i class="fa fa-check"></i><b>1.3.1</b> R errors 😱</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#r-scripts-a-.r-file"><i class="fa fa-check"></i><b>1.3.2</b> R <em>Script</em>s (a <code>.r</code> file)</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#writing-comments"><i class="fa fa-check"></i><b>1.3.3</b> Writing <em>Comments</em></a></li>
<li class="chapter" data-level="1.3.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#change-the-rstudio-appearance-up-to-your-taste"><i class="fa fa-check"></i><b>1.3.4</b> Change the <code>RStudio</code> appearance up to your taste</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#reproducible-research"><i class="fa fa-check"></i><b>1.4</b> Reproducible research</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#good-practice"><i class="fa fa-check"></i><b>1.4.1</b> Good practice</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#version-control-with-git-and-github"><i class="fa fa-check"></i><b>1.5</b> Version control with <code>git</code> and GitHub</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#setup-tldr"><i class="fa fa-check"></i><b>1.5.1</b> Setup TL;DR</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#cloning-a-repository-from-github-using-rstudio"><i class="fa fa-check"></i><b>1.5.2</b> Cloning a repository from <code>GitHub</code> using <code>RStudio</code></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.6</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#starting-out-with-tidyverse"><i class="fa fa-check"></i><b>1.6.1</b> Starting out with <code>tidyverse</code></a></li>
<li class="chapter" data-level="1.6.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#reading-in-data-from-a-.csv-file"><i class="fa fa-check"></i><b>1.6.2</b> Reading in data from a <code>.csv</code> file</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#explore-your-data"><i class="fa fa-check"></i><b>1.6.3</b> Explore your data</a></li>
<li class="chapter" data-level="1.6.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#the-pipe-operator"><i class="fa fa-check"></i><b>1.6.4</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#other-resources"><i class="fa fa-check"></i><b>1.7</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html"><i class="fa fa-check"></i><b>2</b> Māori Data Sovereignty principles</a><ul>
<li class="chapter" data-level="2.1" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#māori-data-sovereignty-principles-1"><i class="fa fa-check"></i><b>2.2</b> Māori Data Sovereignty principles</a></li>
<li class="chapter" data-level="2.3" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#māori-data-sovereignty-principles-2"><i class="fa fa-check"></i><b>2.3</b> Māori Data Sovereignty principles</a></li>
<li class="chapter" data-level="2.4" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#resources"><i class="fa fa-check"></i><b>2.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html"><i class="fa fa-check"></i><b>3</b> Data wrangling and vizualisation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#common-dataframe-manipulations-in-the-tidyverse"><i class="fa fa-check"></i><b>3.2</b> Common dataframe manipulations in the <code>tidyverse</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.2.1</b> Using <code>dplyr</code> and <code>tidyr</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#introuducing-the-palmer-penguins"><i class="fa fa-check"></i><b>3.2.2</b> Introuducing the <span>Palmer penguins</span></a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#common-dataframe-manipulations-in-the-tidyverse-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.2.3</b> Common dataframe manipulations in the <code>tidyverse</code>, using <code>dplyr</code> and <code>tidyr</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#data-viz"><i class="fa fa-check"></i><b>3.3</b> Data Viz</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#exploratory-and-explanatory-plots"><i class="fa fa-check"></i><b>3.3.1</b> Exploratory and explanatory plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ten-simple-rules-for-better-figures"><i class="fa fa-check"></i><b>3.4</b> Ten Simple Rules for Better Figures</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ggplot2"><i class="fa fa-check"></i><b>3.5</b> <code>ggplot2</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ggplot2-layers"><i class="fa fa-check"></i><b>3.5.1</b> <code>ggplot2</code> layers</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#examples"><i class="fa fa-check"></i><b>3.5.2</b> Examples</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#the-good-the-bad-and-the-ugly"><i class="fa fa-check"></i><b>3.5.3</b> The Good, the Bad, and the Ugly…</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#resources-1"><i class="fa fa-check"></i><b>3.6</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>4</b> Introduction to the design and analysis of experiments</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i><b>4.2</b> Key phrases</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#three-key-principles"><i class="fa fa-check"></i><b>4.3</b> Three key principles:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#replication"><i class="fa fa-check"></i><b>4.3.1</b> <strong>Replication</strong></a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#randomization"><i class="fa fa-check"></i><b>4.3.2</b> <strong>Randomization</strong></a></li>
<li class="chapter" data-level="4.3.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#blocking"><i class="fa fa-check"></i><b>4.3.3</b> <strong>Blocking</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>4.4</b> One-Way <strong>An</strong>alysis <strong>o</strong>f <strong>Va</strong>riance (ANOVA)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#between-group-ss-ssb"><i class="fa fa-check"></i><b>4.4.1</b> Between group SS (SSB)</a></li>
<li class="chapter" data-level="4.4.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#within-group-ss-ssw"><i class="fa fa-check"></i><b>4.4.2</b> Within group SS (SSW)</a></li>
<li class="chapter" data-level="4.4.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#f-statistic"><i class="fa fa-check"></i><b>4.4.3</b> F-statistic</a></li>
<li class="chapter" data-level="4.4.4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#degrees-of-freedom-df"><i class="fa fa-check"></i><b>4.4.4</b> Degrees of freedom (DF)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#p-values"><i class="fa fa-check"></i><b>4.5</b> 😱 p-values 😱</a></li>
<li class="chapter" data-level="4.6" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#terminology-and-issues"><i class="fa fa-check"></i><b>4.6</b> Terminology and issues</a></li>
<li class="chapter" data-level="4.7" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#resources-2"><i class="fa fa-check"></i><b>4.7</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html"><i class="fa fa-check"></i><b>5</b> A completely randomomised design</a><ul>
<li class="chapter" data-level="5.1" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#learning-objectives-4"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#analysis-of-a-completely-randomised-design-in-r-aov-and-lm"><i class="fa fa-check"></i><b>5.2</b> Analysis of a Completely Randomised Design in <code>R</code>: <code>aov()</code> and <code>lm()</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#aov"><i class="fa fa-check"></i><b>5.2.1</b> <code>aov()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#lm"><i class="fa fa-check"></i><b>5.2.2</b> <code>lm()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i><b>6</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#learning-objectives-5"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#adjustments-for-multiple-testing"><i class="fa fa-check"></i><b>6.2</b> Adjustments for multiple testing</a><ul>
<li class="chapter" data-level="6.2.1" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests"><i class="fa fa-check"></i><b>6.2.1</b> Classification of multiple hypothesis tests</a></li>
<li class="chapter" data-level="6.2.2" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#using-the-predictmeans-package"><i class="fa fa-check"></i><b>6.2.2</b> Using the <code>predictmeans</code> package</a></li>
<li class="chapter" data-level="6.2.3" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-comparison-procedures"><i class="fa fa-check"></i><b>6.2.3</b> Multiple comparison procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="factorial-experiments.html"><a href="factorial-experiments.html"><i class="fa fa-check"></i><b>7</b> Factorial experiments</a><ul>
<li class="chapter" data-level="7.1" data-path="factorial-experiments.html"><a href="factorial-experiments.html#learning-objectives-6"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="factorial-experiments.html"><a href="factorial-experiments.html#factorial-design-as-a-crd"><i class="fa fa-check"></i><b>7.2</b> Factorial design (as a CRD)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="factorial-experiments.html"><a href="factorial-experiments.html#equal-replications-balanced-design"><i class="fa fa-check"></i><b>7.2.1</b> Equal replications (balanced design)</a></li>
<li class="chapter" data-level="7.2.2" data-path="factorial-experiments.html"><a href="factorial-experiments.html#unqual-replications-unbalanced-design"><i class="fa fa-check"></i><b>7.2.2</b> Unqual replications (unbalanced design)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="factorial-experiments.html"><a href="factorial-experiments.html#tldr-model-formula-syntax-in-r"><i class="fa fa-check"></i><b>7.3</b> TL;DR, Model formula syntax in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html"><i class="fa fa-check"></i><b>8</b> Blocking: incorporating into design and analysis of</a><ul>
<li class="chapter" data-level="8.1" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#learning-objectives-7"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#blocking-1"><i class="fa fa-check"></i><b>8.2</b> Blocking</a></li>
<li class="chapter" data-level="8.3" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#a-randomised-controlled-block-design-rcbd"><i class="fa fa-check"></i><b>8.3</b> A Randomised Controlled Block Design (RCBD)</a></li>
<li class="chapter" data-level="8.4" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#fixed-or-random"><i class="fa fa-check"></i><b>8.4</b> Fixed or Random???</a><ul>
<li class="chapter" data-level="8.4.1" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#ignoring-an-effect"><i class="fa fa-check"></i><b>8.4.1</b> Ignoring an effect</a></li>
<li class="chapter" data-level="8.4.2" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#analysis-using-lmer-from-lme4"><i class="fa fa-check"></i><b>8.4.2</b> Analysis using <code>lmer()</code> from <code>lme4</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html"><i class="fa fa-check"></i><b>9</b> Split-plot and repeated measures designs</a><ul>
<li class="chapter" data-level="9.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#learning-objectives-8"><i class="fa fa-check"></i><b>9.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#analysis-of-a-split-plot-design"><i class="fa fa-check"></i><b>9.2</b> Analysis of a split-plot design</a><ul>
<li class="chapter" data-level="9.2.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-aov"><i class="fa fa-check"></i><b>9.2.1</b> Using <code>aov()</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-lmer-from-lmetest-and-lmer4-and-predictmeans"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>lmer()</code> (from <code>lmeTest</code> and <code>lmer4</code>) and <code>predictmeans()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#analysis-of-a-repeated-measures-design"><i class="fa fa-check"></i><b>9.3</b> Analysis of a repeated measures design</a><ul>
<li class="chapter" data-level="9.3.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#the-data"><i class="fa fa-check"></i><b>9.3.1</b> The data</a></li>
<li class="chapter" data-level="9.3.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#visualise"><i class="fa fa-check"></i><b>9.3.2</b> Visualise</a></li>
<li class="chapter" data-level="9.3.3" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-aov-1"><i class="fa fa-check"></i><b>9.3.3</b> Using <code>aov()</code></a></li>
<li class="chapter" data-level="9.3.4" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-lmer-from-lmertest-and-lme4-and-predictmeans"><i class="fa fa-check"></i><b>9.3.4</b> Using <code>lmer()</code> (from <code>lmerTest</code> and <code>lme4</code>) and <code>predictmeans()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#repeated-measures-designs-as-split-plots-in-time"><i class="fa fa-check"></i><b>9.4</b> Repeated measures designs as <em>split-plots in time</em></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>bluebook</em> BIOSCI738</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="split-plot-and-repeated-measures-designs" class="section level1">
<h1><span class="header-section-number">9</span> Split-plot and repeated measures designs</h1>
<div id="learning-objectives-8" class="section level2">
<h2><span class="header-section-number">9.1</span> Learning objectives</h2>
<ul>
<li><strong>Describe</strong> and <strong>discuss</strong> split-plot experimental design</li>
<li><strong>Describe</strong> and <strong>discuss</strong> repeated measures experiments</li>
<li><strong>Write</strong> <code>R</code> code to <strong>visualise</strong> repeated measures data</li>
<li><strong>Carry</strong> out appropriate analysis in <code>R</code> and <strong>draw</strong> the appropriate inference</li>
</ul>
</div>
<div id="analysis-of-a-split-plot-design" class="section level2">
<h2><span class="header-section-number">9.2</span> Analysis of a split-plot design</h2>
<p><strong>Recall the diabetic and healthy male Wistar rats…</strong> (chapter 6)</p>
<p><img src="img/factorial_crd.png" />
<strong>BUT</strong> what about</p>
<p><img src="img/split-plot.png" />
<strong>Data available on CANVAS</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">split_plot &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;split_plot.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="co">## recall we need to set factors</span></a>
<a class="sourceLine" id="cb114-2" title="2">split_plot<span class="op">$</span>Animal &lt;-<span class="st"> </span><span class="kw">factor</span>(split_plot<span class="op">$</span>Animal)</a>
<a class="sourceLine" id="cb114-3" title="3">split_plot<span class="op">$</span>Sample &lt;-<span class="st"> </span><span class="kw">factor</span>(split_plot<span class="op">$</span>Sample)</a>
<a class="sourceLine" id="cb114-4" title="4">split_plot</a></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##    Disease  Organ   Animal Sample logAUC
##    &lt;chr&gt;    &lt;chr&gt;   &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt;
##  1 Healthy  innerLV 1      1        9.4 
##  2 Healthy  outerLV 1      2        8.83
##  3 Healthy  innerLV 2      1       10.3 
##  4 Healthy  outerLV 2      2       10.5 
##  5 Healthy  innerLV 3      1        9.74
##  6 Healthy  outerLV 3      2       11.0 
##  7 Diabetic innerLV 4      1        7.92
##  8 Diabetic outerLV 4      2        9.37
##  9 Diabetic innerLV 5      1        8.69
## 10 Diabetic outerLV 5      2       11.3 
## 11 Diabetic innerLV 6      1        7.01
## 12 Diabetic outerLV 6      2        9.29</code></pre>
<div id="using-aov" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Using <code>aov()</code></h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">sp_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Animal<span class="op">/</span>Sample), <span class="dt">data =</span> split_plot)</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">summary</span>(sp_aov)</a></code></pre></div>
<pre><code>## 
## Error: Animal
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Disease    1  3.183   3.183   2.187  0.213
## Residuals  4  5.822   1.456               
## 
## Error: Animal:Sample
##               Df Sum Sq Mean Sq F value Pr(&gt;F)  
## Organ          1  4.296   4.296  14.423 0.0191 *
## Disease:Organ  1  2.539   2.539   8.525 0.0433 *
## Residuals      4  1.191   0.298                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="using-lmer-from-lmetest-and-lmer4-and-predictmeans" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Using <code>lmer()</code> (from <code>lmeTest</code> and <code>lmer4</code>) and <code>predictmeans()</code></h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">library</span>(lmerTest) <span class="co">## MUST LOAD THIS</span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">sp_lmer &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal), <span class="dt">data =</span> split_plot) <span class="co">## MUST SPECIFY WHICH PACKAGE</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">anova</span>(sp_lmer,<span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Type II Analysis of Variance Table with Satterthwaite&#39;s method
##               Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  
## Disease       0.6513  0.6513     1     4  2.1866 0.21329  
## Organ         4.2960  4.2960     1     4 14.4227 0.01914 *
## Disease:Organ 2.5392  2.5392     1     4  8.5246 0.04326 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb124-2" title="2"><span class="kw">library</span>(predictmeans)</a>
<a class="sourceLine" id="cb124-3" title="3">sp_lmer4 &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal), <span class="dt">data =</span> split_plot) <span class="co">## MUST SPECIFY WHICH PACKAGE</span></a>
<a class="sourceLine" id="cb124-4" title="4">sp_predmeans &lt;-<span class="st"> </span><span class="kw">predictmeans</span>(sp_lmer4,<span class="dt">modelterm =</span> <span class="st">&quot;Disease:Organ&quot;</span>, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb124-5" title="5">sp_predmeans</a></code></pre></div>
<pre><code>## $`Predicted Means`
##          Organ innerLV outerLV
## Disease                       
## Diabetic        7.8733  9.9900
## Healthy         9.8233 10.1000
## 
## $`Standard Error of Means`
## All means have the same Stder 
##                       0.54058 
## 
## $`Standard Error of Differences`
##   Max.SED   Min.SED  Aveg.SED 
## 0.7645006 0.4456206 0.6582073 
## attr(,&quot;For the Same Level of Factor&quot;)
##            Disease     Organ
## Aveg.SED 0.4456206 0.7645006
## Min.SED  0.4456206 0.7645006
## Max.SED  0.4456206 0.7645006
## 
## $LSD
##  Max.LSD  Min.LSD Aveg.LSD 
##  2.12259  1.23724  1.82748 
## attr(,&quot;Significant level&quot;)
## [1] 0.05
## attr(,&quot;Degree of freedom&quot;)
## [1] 4
## 
## $`Pairwise LSDs`
##                  Diabetic:innerLV Diabetic:outerLV Healthy:innerLV
## Diabetic:innerLV          0.00000         -2.11667        -1.95000
## Diabetic:outerLV          1.23724          0.00000         0.16667
## Healthy:innerLV           2.12259          2.12259         0.00000
## Healthy:outerLV           2.12259          2.12259         1.23724
##                  Healthy:outerLV
## Diabetic:innerLV        -2.22667
## Diabetic:outerLV        -0.11000
## Healthy:innerLV         -0.27667
## Healthy:outerLV          0.00000
## attr(,&quot;Significant level&quot;)
## [1] 0.05
## attr(,&quot;Degree of freedom&quot;)
## [1] 4
## attr(,&quot;Note&quot;)
## [1] &quot;LSDs matrix has mean differences (row-col) above the diagonal, LSDs (adjusted by &#39;none&#39; method) below the diagonal&quot;
## 
## $`Pairwise p-value`
##                  Diabetic:innerLV Diabetic:outerLV Healthy:innerLV
## Diabetic:innerLV           0.0000          -4.7499         -2.5507
## Diabetic:outerLV           0.0090           0.0000          0.2180
## Healthy:innerLV            0.0633           0.8381          0.0000
## Healthy:outerLV            0.0436           0.8925          0.5683
##                  Healthy:outerLV
## Diabetic:innerLV         -2.9126
## Diabetic:outerLV         -0.1439
## Healthy:innerLV          -0.6209
## Healthy:outerLV           0.0000
## attr(,&quot;Degree of freedom&quot;)
## [1] 4
## attr(,&quot;Note&quot;)
## [1] &quot;The matrix has t-value above the diagonal, p-value (adjusted by &#39;none&#39; method) below the diagonal&quot;
## attr(,&quot;Letter-based representation of pairwise comparisons at significant level &#39;0.05&#39;&quot;)
##          Treatment      Mean Group
## 1  Healthy:outerLV 10.100000    A 
## 2 Diabetic:outerLV  9.990000    A 
## 3  Healthy:innerLV  9.823333    AB
## 4 Diabetic:innerLV  7.873333     B
## 
## $mean_table
##    Disease   Organ Predicted means Standard error Df LL of 95% CI UL of 95% CI
## 1 Diabetic innerLV        7.873333      0.5405835  4     6.372433     9.374234
## 2 Diabetic outerLV        9.990000      0.5405835  4     8.489099    11.490901
## 3  Healthy innerLV        9.823333      0.5405835  4     8.322433    11.324234
## 4  Healthy outerLV       10.100000      0.5405835  4     8.599099    11.600901</code></pre>
</div>
</div>
<div id="analysis-of-a-repeated-measures-design" class="section level2">
<h2><span class="header-section-number">9.3</span> Analysis of a repeated measures design</h2>
<p>We have (<em>balanced</em>) data with the same number of observations on each rat at the same time points.</p>
<div id="the-data" class="section level3">
<h3><span class="header-section-number">9.3.1</span> The data</h3>
<p><strong>Data available on CANVAS</strong></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb126-2" title="2">liver &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;repeated_measures_liver.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co">## change time to factor</span></a>
<a class="sourceLine" id="cb127-2" title="2">liver<span class="op">$</span>Time &lt;-<span class="st"> </span><span class="kw">as.factor</span>(liver<span class="op">$</span>Time)</a>
<a class="sourceLine" id="cb127-3" title="3"><span class="kw">glimpse</span>(liver)</a></code></pre></div>
<pre><code>## Rows: 210
## Columns: 4
## $ Animal    &lt;chr&gt; &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, …
## $ Treatment &lt;chr&gt; &quot;Control&quot;, &quot;Control&quot;, &quot;Control&quot;, &quot;Control&quot;, &quot;Control&quot;, &quot;Cont…
## $ Time      &lt;fct&gt; 0, 5, 10, 15, 20, 25, 30, 0, 5, 10, 15, 20, 25, 30, 0, 5, 10…
## $ Glucose   &lt;dbl&gt; 1.599, 1.279, 1.599, 1.579, 1.279, 1.439, 1.179, 0.840, 0.64…</code></pre>
</div>
<div id="visualise" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Visualise</h3>
<p><strong>plot data</strong></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">ggplot</span>(liver, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Glucose, <span class="dt">color =</span> Treatment, <span class="dt">group =</span> Animal)) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p><strong>plot group means</strong></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">liver_means &lt;-<span class="st"> </span>liver <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Time,Treatment) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Glucose =</span> <span class="kw">mean</span>(Glucose))</a></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Time&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">ggplot</span>(liver_means, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Glucose, <span class="dt">color =</span> Treatment, <span class="dt">group =</span> Treatment)) <span class="op">+</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb132-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p><strong>linear?</strong></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">ggplot</span>(liver_means, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Glucose, <span class="dt">color =</span> Treatment, <span class="dt">group =</span> Treatment)) <span class="op">+</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="using-aov-1" class="section level3">
<h3><span class="header-section-number">9.3.3</span> Using <code>aov()</code></h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">re_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Animal),<span class="dt">data =</span> liver)</a>
<a class="sourceLine" id="cb135-2" title="2"><span class="kw">summary</span>(re_aov)</a></code></pre></div>
<pre><code>## 
## Error: Animal
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Treatment  3   1.90  0.6335   1.407  0.263
## Residuals 26  11.71  0.4503               
## 
## Error: Within
##                 Df Sum Sq Mean Sq F value       Pr(&gt;F)    
## Time             6 0.7973 0.13289   8.732 0.0000000334 ***
## Treatment:Time  18 0.2539 0.01411   0.927        0.547    
## Residuals      156 2.3741 0.01522                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="using-lmer-from-lmertest-and-lme4-and-predictmeans" class="section level3">
<h3><span class="header-section-number">9.3.4</span> Using <code>lmer()</code> (from <code>lmerTest</code> and <code>lme4</code>) and <code>predictmeans()</code></h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(lmerTest) <span class="co">## MUST LOAD THIS</span></a>
<a class="sourceLine" id="cb137-2" title="2">re_lmer &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal),<span class="dt">data =</span> liver) <span class="co">## MUST SPECIFY WHICH PACKAGE</span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="kw">anova</span>(re_lmer,<span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Type II Analysis of Variance Table with Satterthwaite&#39;s method
##                 Sum Sq  Mean Sq NumDF DenDF F value        Pr(&gt;F)    
## Treatment      0.06423 0.021409     3    26  1.4068        0.2632    
## Time           0.79731 0.132885     6   156  8.7318 0.00000003345 ***
## Treatment:Time 0.25390 0.014105    18   156  0.9269        0.5474    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb139-2" title="2"><span class="kw">library</span>(predictmeans)</a>
<a class="sourceLine" id="cb139-3" title="3">re_lmer4 &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal),<span class="dt">data =</span> liver) <span class="co">## MUST SPECIFY WHICH PACKAGE</span></a>
<a class="sourceLine" id="cb139-4" title="4">predictmeans<span class="op">::</span><span class="kw">residplot</span>(re_lmer4)</a>
<a class="sourceLine" id="cb139-5" title="5">sp_predmeans &lt;-<span class="st"> </span><span class="kw">predictmeans</span>(re_lmer4,<span class="dt">modelterm =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb139-6" title="6">sp_predmeans</a></code></pre></div>
<pre><code>## $`Predicted Means`
## Time
##      0      5     10     15     20     25     30 
## 0.6470 0.5885 0.5668 0.5361 0.4977 0.5023 0.4420 
## 
## $`Standard Error of Means`
## All means have the same Stder 
##                        0.0509 
## 
## $`Standard Error of Differences`
##    Max.SED    Min.SED   Aveg.SED 
## 0.03192336 0.03192336 0.03192336 
## 
## $LSD
##  Max.LSD  Min.LSD Aveg.LSD 
##  0.06306  0.06306  0.06306 
## attr(,&quot;Significant level&quot;)
## [1] 0.05
## attr(,&quot;Degree of freedom&quot;)
## [1] 156
## 
## $`Pairwise LSDs`
##          0       5      10      15      20       25      30
## 0  0.00000 0.05842 0.08021 0.11086 0.14925  0.14464 0.20498
## 5  0.06306 0.00000 0.02178 0.05244 0.09083  0.08621 0.14656
## 10 0.06306 0.06306 0.00000 0.03066 0.06904  0.06443 0.12478
## 15 0.06306 0.06306 0.06306 0.00000 0.03839  0.03378 0.09412
## 20 0.06306 0.06306 0.06306 0.06306 0.00000 -0.00461 0.05573
## 25 0.06306 0.06306 0.06306 0.06306 0.06306  0.00000 0.06034
## 30 0.06306 0.06306 0.06306 0.06306 0.06306  0.06306 0.00000
## attr(,&quot;Significant level&quot;)
## [1] 0.05
## attr(,&quot;Degree of freedom&quot;)
## [1] 156
## attr(,&quot;Note&quot;)
## [1] &quot;LSDs matrix has mean differences (row-col) above the diagonal, LSDs (adjusted by &#39;none&#39; method) below the diagonal&quot;
## 
## $`Pairwise p-value`
##         0      5     10     15     20      25     30
## 0  0.0000 1.8301 2.5124 3.4727 4.6753  4.5308 6.4211
## 5  0.0691 0.0000 0.6823 1.6426 2.8451  2.7007 4.5909
## 10 0.0130 0.4961 0.0000 0.9603 2.1628  2.0184 3.9086
## 15 0.0007 0.1025 0.3384 0.0000 1.2025  1.0581 2.9483
## 20 0.0000 0.0050 0.0321 0.2310 0.0000 -0.1445 1.7458
## 25 0.0000 0.0077 0.0453 0.2917 0.8853  0.0000 1.8903
## 30 0.0000 0.0000 0.0001 0.0037 0.0828  0.0606 0.0000
## attr(,&quot;Degree of freedom&quot;)
## [1] 156
## attr(,&quot;Note&quot;)
## [1] &quot;The matrix has t-value above the diagonal, p-value (adjusted by &#39;none&#39; method) below the diagonal&quot;
## attr(,&quot;Letter-based representation of pairwise comparisons at significant level &#39;0.05&#39;&quot;)
##   Treatment      Mean Group
## 1         0 0.6469732  A   
## 2         5 0.5885491  AB  
## 3        10 0.5667679   B  
## 4        15 0.5361116   BC 
## 5        25 0.5023348    CD
## 6        20 0.4977232    CD
## 7        30 0.4419911     D
## 
## $mean_table
##   Time Predicted means Standard error  Df LL of 95% CI UL of 95% CI
## 1    0       0.6469732     0.05089815 156    0.5464347    0.7475117
## 2    5       0.5885491     0.05089815 156    0.4880106    0.6890876
## 3   10       0.5667679     0.05089815 156    0.4662294    0.6673063
## 4   15       0.5361116     0.05089815 156    0.4355731    0.6366501
## 5   20       0.4977232     0.05089815 156    0.3971847    0.5982617
## 6   25       0.5023348     0.05089815 156    0.4017963    0.6028733
## 7   30       0.4419911     0.05089815 156    0.3414526    0.5425296</code></pre>
</div>
</div>
<div id="repeated-measures-designs-as-split-plots-in-time" class="section level2">
<h2><span class="header-section-number">9.4</span> Repeated measures designs as <em>split-plots in time</em></h2>
<p>In this set of <em>balanced</em> data we have
+ Same number of observations on each rat
+ At the same time points</p>
<p>We could analyse as a split-plot design, where
+ <em>plots</em> = different rats
+ <em>subplots</em> = different times within a rat</p>
<p>Here we would have <strong>two</strong> error components
+ Between rats
+ Between times within rats</p>
<p>There are, however, two big differences between Repeated Measures and Split-plot Designs
1. Cannot randomise the levels of time
+ Measurement 2 hours, comes after that at 1 hour
2. Split plot design block structure
+ Imposes the same correlation on any two subplots in the the same plot
+ Implausible for repeated measures designs as observations further apart in time likely to be less
correlated than observations close together</p>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="blocking-incorporating-into-design-and-analysis-of.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
