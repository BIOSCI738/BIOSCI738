<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Linear mixed-effect models (LMMs) | Advanced Biological Data Analysis</title>
  <meta name="description" content="Linear mixed-effect models (LMMs) | Advanced Biological Data Analysis" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Linear mixed-effect models (LMMs) | Advanced Biological Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Linear mixed-effect models (LMMs) | Advanced Biological Data Analysis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-comparisons.html"/>
<link rel="next" href="module-4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSCI 738: Advanced Biological Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Nau mai, haere mai. Welcome to BIOSCI 738</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html"><i class="fa fa-check"></i>Key Information</a>
<ul>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#course-policies"><i class="fa fa-check"></i>Course policies</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#faqs"><i class="fa fa-check"></i>FAQs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-1.html"><a href="module-1.html"><i class="fa fa-check"></i>Module 1</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><code>R</code> and <code>RStudio</code></a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#recap-r-terminology"><i class="fa fa-check"></i>Recap: <code>R</code> terminology</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#which-r-syntax"><i class="fa fa-check"></i>Which <code>R</code> syntax?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="error-handling-and-debugging.html"><a href="error-handling-and-debugging.html"><i class="fa fa-check"></i>Error handling and debugging</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html"><i class="fa fa-check"></i>Accuracy and Honesty</a>
<ul>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#good-coding-practice"><i class="fa fa-check"></i>Good coding practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html"><i class="fa fa-check"></i>Version control with <code>git</code> and GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#setting-up"><i class="fa fa-check"></i>Setting up</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#cloning-a-repository-from-github-using-rstudio"><i class="fa fa-check"></i>Cloning a repository from <code>GitHub</code> using <code>RStudio</code></a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#commiting-and-pushing-changes"><i class="fa fa-check"></i>Commiting and pushing changes</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#system-specific-hurdles"><i class="fa fa-check"></i>System specific hurdles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html"><i class="fa fa-check"></i>Respectful Handling of Data</a>
<ul>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#data-sovereignty"><i class="fa fa-check"></i>Data sovereignty</a></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#māori-data-sovereignty-principles"><i class="fa fa-check"></i>Māori Data Sovereignty principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html"><i class="fa fa-check"></i>Awareness of Consequences</a>
<ul>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html#case-study"><i class="fa fa-check"></i>Case study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i>Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#exploratory-plots-for-your-own-purposes"><i class="fa fa-check"></i>Exploratory plots (for your own purposes)</a></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#explanatory-plots"><i class="fa fa-check"></i>Explanatory plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-2.html"><a href="module-2.html"><i class="fa fa-check"></i>Module 2</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html"><i class="fa fa-check"></i>Permutation and randomisation tests</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html#a-permutation-test-jackal-mandible-lengths"><i class="fa fa-check"></i>A permutation test: Jackal mandible lengths</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html"><i class="fa fa-check"></i>Bootstrap resampling</a>
<ul>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html#example-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i>Example: constructing bootstrap confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html"><i class="fa fa-check"></i>Parametric hypothesis testing</a>
<ul>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#the-vocabulary-of-hypothesis-testing"><i class="fa fa-check"></i>The vocabulary of hypothesis testing</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#differences-between-two-means"><i class="fa fa-check"></i>Differences between two means</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#model-formula-syntax-in-r"><i class="fa fa-check"></i>Model formula syntax in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#some-mathematical-notation"><i class="fa fa-check"></i>Some mathematical notation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#a-null-model"><i class="fa fa-check"></i>A Null model</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#single-continuous-variable"><i class="fa fa-check"></i>Single continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#a-single-factor-variable"><i class="fa fa-check"></i>A single factor variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#one-factor-and-a-continuous-variable"><i class="fa fa-check"></i>One factor and a continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html"><i class="fa fa-check"></i>Model diagnostics for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html#model-selection"><i class="fa fa-check"></i>Model selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html"><i class="fa fa-check"></i>Inference for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#point-prediction"><i class="fa fa-check"></i>Point prediction</a></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#confidence-intervals-for-parameters"><i class="fa fa-check"></i>Confidence intervals for parameters</a></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#marginal-predictions"><i class="fa fa-check"></i>Marginal predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-3.html"><a href="module-3.html"><i class="fa fa-check"></i>Module 3</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i>Introduction to the design and analysis of experiments</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i>Key phrases</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#setting-up-an-experiment"><i class="fa fa-check"></i>Setting up an experiment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-three-main-principles-of-experimental-design.html"><a href="the-three-main-principles-of-experimental-design.html"><i class="fa fa-check"></i>The three (main) principles of experimental design</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html"><i class="fa fa-check"></i>Some basic experimental designs</a>
<ul>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#completely-randomised-design-crd"><i class="fa fa-check"></i>Completely randomised design (CRD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#randomised-complete-block-design-rcbd"><i class="fa fa-check"></i>Randomised complete block design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#factorial-design"><i class="fa fa-check"></i>Factorial design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html"><i class="fa fa-check"></i>Modelling experimental data</a>
<ul>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-completely-randomised-design-crd-as-a-linear-model"><i class="fa fa-check"></i>A completely randomised design (CRD) as a linear model</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#analysis-of-a-crd-in-r"><i class="fa fa-check"></i>Analysis of a CRD in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-factorial-experiment-as-a-crd"><i class="fa fa-check"></i>A Factorial experiment (as a CRD)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#unqual-replications-unbalanced-design"><i class="fa fa-check"></i>Unqual replications (unbalanced design)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#sums-of-squares-ss"><i class="fa fa-check"></i>Sums of squares (<span class="math inline">\(SS\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i>Multiple comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#adjustments-for-multiple-testing"><i class="fa fa-check"></i>Adjustments for multiple testing</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests"><i class="fa fa-check"></i>Classification of multiple hypothesis tests</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-comparison-procedures"><i class="fa fa-check"></i>Multiple comparison procedures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html"><i class="fa fa-check"></i>Linear mixed-effect models (LMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-randomised-controlled-block-design-rcbd"><i class="fa fa-check"></i>A Randomised Controlled Block Design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-split-plot-design"><i class="fa fa-check"></i>A Split-plot design</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-repeated-measures-design"><i class="fa fa-check"></i>A repeated measures design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-4.html"><a href="module-4.html"><i class="fa fa-check"></i>Module 4</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-generalised-linear-models-glms.html"><a href="introduction-to-generalised-linear-models-glms.html"><i class="fa fa-check"></i>Introduction to generalised linear models (GLMs)</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i>Poisson regression</a>
<ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#an-example-bird-abundance"><i class="fa fa-check"></i>An example: bird abundance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#an-example-lobsters"><i class="fa fa-check"></i>An example: lobsters</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i>Model diagnostics</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#residuals"><i class="fa fa-check"></i>Residuals</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#the-quantile-residual-q-q-plot"><i class="fa fa-check"></i>The quantile residual Q-Q plot</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#deviance-using-the-chi-squared-approach"><i class="fa fa-check"></i>Deviance (using the chi-squared approach)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-summary-of-glms.html"><a href="a-summary-of-glms.html"><i class="fa fa-check"></i>A summary of GLMs</a>
<ul>
<li class="chapter" data-level="" data-path="a-summary-of-glms.html"><a href="a-summary-of-glms.html#other-distributions"><i class="fa fa-check"></i>Other distributions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html"><i class="fa fa-check"></i>Generalised linear mixed-effects models (GLMMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html#fitting-a-glmm"><i class="fa fa-check"></i>Fitting a GLMM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-5.html"><a href="module-5.html"><i class="fa fa-check"></i>Module 5</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i>Clustering</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#divisive-partitioning-methods."><i class="fa fa-check"></i>Divisive (partitioning) methods.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#k-means-an-example-using-the-palmerpenguins-data"><i class="fa fa-check"></i>K-means: an example using the <code>palmerpenguins</code> data</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-agglomerative-clustering."><i class="fa fa-check"></i>Hierarchical agglomerative clustering.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering-an-example"><i class="fa fa-check"></i>Hierarchical clustering: an example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i>Principal Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#examples-in-r"><i class="fa fa-check"></i>Examples in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i>Multidimensional Scaling (MDS)</a>
<ul>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#metric-scaling"><i class="fa fa-check"></i>Metric Scaling</a></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#correspondence-analysis-ca"><i class="fa fa-check"></i>Correspondence Analysis (CA)</a></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#non-metric-multidimensional-scaling"><i class="fa fa-check"></i>Non-metric Multidimensional Scaling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html"><i class="fa fa-check"></i>Linear Discriminant Analysis (LDA)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#example-in-r"><i class="fa fa-check"></i>Example in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-6.html"><a href="module-6.html"><i class="fa fa-check"></i>Module 6</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html"><i class="fa fa-check"></i>Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#some-basic-matrix-algebra"><i class="fa fa-check"></i>Some basic matrix algebra</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#linear-least-squares"><i class="fa fa-check"></i>Linear least squares</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#matrix-representation-of-a-crd"><i class="fa fa-check"></i>Matrix representation of a CRD</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#a-numeric-example"><i class="fa fa-check"></i>A numeric example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i>Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#differeniation-rules"><i class="fa fa-check"></i>Differeniation rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#logarithm-rules"><i class="fa fa-check"></i>Logarithm rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-binomial-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-crd"><i class="fa fa-check"></i>Maximum likelihood estimation for a CRD</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximising-the-log-likelihood"><i class="fa fa-check"></i>Maximising the log-likelihood</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-poisson-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Poisson distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-continuous-random-variable"><i class="fa fa-check"></i>Maximum likelihood estimation for a continuous random variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html"><i class="fa fa-check"></i>Introduction to Bayesian statistics</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#conditional-probability"><i class="fa fa-check"></i>Conditional probability</a></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#bayes-rule"><i class="fa fa-check"></i>Bayes’ rule</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://canvas.auckland.ac.nz/courses/103658">CANVAS</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-mixed-effect-models-lmms" class="section level2 hasAnchor">
<h2>Linear mixed-effect models (LMMs)<a href="linear-mixed-effect-models-lmms.html#linear-mixed-effect-models-lmms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Recall,</strong> blocking helps control variability by making treatment groups more alike. Experimental units are divided into subsets (called blocks) so that units within the same block are more similar than units from different subsets or blocks. Blocking is a technique for dealing with <em>nuisance factors</em>. A nuisance factor is a factor that has some effect on the response, but is of no interest (e.g., age class).</p>
<p><strong>Fixed effects</strong> are terms (parameters) in a statistical model which are fixed, or non-random, quantities (e.g., <em>treatment</em> group’s mean response). For the same <em>treatment</em>, we expect this quantity to be the same from experiment to experiment.</p>
<p><strong>Random effects</strong> are terms (parameters) in a statistical model which are considered as random quantities or variables (e.g., block id). Specifically, terms whose levels are a representative sample from a population, and where the variance of the population is of interest should be allocated as random. Setting a block as a random effect allows us to infer variation between blocks as well as the variation between experimental units within blocks.</p>
<p><strong>Key idea:</strong> Partition known sources of variation which are unimportant to key scientific question(s) to improve precision of comparisons between treatment means.</p>
<div id="a-randomised-controlled-block-design-rcbd" class="section level3 hasAnchor">
<h3>A Randomised Controlled Block Design (RCBD)<a href="linear-mixed-effect-models-lmms.html#a-randomised-controlled-block-design-rcbd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>rcbd</code> data:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="linear-mixed-effect-models-lmms.html#cb113-1"></a><span class="kw">glimpse</span>(rcbd)</span></code></pre></div>
<p>To use <code>predictmeans</code> later on we have to ensure that the relevant variables are coded as factors:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="linear-mixed-effect-models-lmms.html#cb114-1"></a>rcbd &lt;-<span class="st"> </span>rcbd <span class="op">%&gt;%</span></span>
<span id="cb114-2"><a href="linear-mixed-effect-models-lmms.html#cb114-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Run =</span> <span class="kw">as.factor</span>(Run)) <span class="op">%&gt;%</span></span>
<span id="cb114-3"><a href="linear-mixed-effect-models-lmms.html#cb114-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Surgery =</span> <span class="kw">as.factor</span>(Surgery))</span></code></pre></div>
<div id="run-as-a-fixed-effect" class="section level4 hasAnchor">
<h4><code>Run</code> as a fixed effect<a href="linear-mixed-effect-models-lmms.html#run-as-a-fixed-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="linear-mixed-effect-models-lmms.html#cb115-1"></a>lm &lt;-<span class="st"> </span><span class="kw">lm</span>(logAUC8 <span class="op">~</span><span class="st"> </span>Run <span class="op">+</span><span class="st"> </span>Surgery, <span class="dt">data =</span> rcbd)</span>
<span id="cb115-2"><a href="linear-mixed-effect-models-lmms.html#cb115-2"></a><span class="kw">summary</span>(lm)</span>
<span id="cb115-3"><a href="linear-mixed-effect-models-lmms.html#cb115-3"></a><span class="co">## </span></span>
<span id="cb115-4"><a href="linear-mixed-effect-models-lmms.html#cb115-4"></a><span class="co">## Call:</span></span>
<span id="cb115-5"><a href="linear-mixed-effect-models-lmms.html#cb115-5"></a><span class="co">## lm(formula = logAUC8 ~ Run + Surgery, data = rcbd)</span></span>
<span id="cb115-6"><a href="linear-mixed-effect-models-lmms.html#cb115-6"></a><span class="co">## </span></span>
<span id="cb115-7"><a href="linear-mixed-effect-models-lmms.html#cb115-7"></a><span class="co">## Residuals:</span></span>
<span id="cb115-8"><a href="linear-mixed-effect-models-lmms.html#cb115-8"></a><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb115-9"><a href="linear-mixed-effect-models-lmms.html#cb115-9"></a><span class="co">## -1.7517 -0.3683 -0.0900  0.4508  1.5817 </span></span>
<span id="cb115-10"><a href="linear-mixed-effect-models-lmms.html#cb115-10"></a><span class="co">## </span></span>
<span id="cb115-11"><a href="linear-mixed-effect-models-lmms.html#cb115-11"></a><span class="co">## Coefficients:</span></span>
<span id="cb115-12"><a href="linear-mixed-effect-models-lmms.html#cb115-12"></a><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb115-13"><a href="linear-mixed-effect-models-lmms.html#cb115-13"></a><span class="co">## (Intercept)   7.6583     0.8506   9.004 0.000105 ***</span></span>
<span id="cb115-14"><a href="linear-mixed-effect-models-lmms.html#cb115-14"></a><span class="co">## Run2         -2.0167     0.9822  -2.053 0.085854 .  </span></span>
<span id="cb115-15"><a href="linear-mixed-effect-models-lmms.html#cb115-15"></a><span class="co">## Run3          0.4100     0.9822   0.417 0.690882    </span></span>
<span id="cb115-16"><a href="linear-mixed-effect-models-lmms.html#cb115-16"></a><span class="co">## Run4          1.2933     0.9822   1.317 0.235963    </span></span>
<span id="cb115-17"><a href="linear-mixed-effect-models-lmms.html#cb115-17"></a><span class="co">## SurgeryP      1.9750     0.8506   2.322 0.059293 .  </span></span>
<span id="cb115-18"><a href="linear-mixed-effect-models-lmms.html#cb115-18"></a><span class="co">## SurgeryS      3.8500     0.8506   4.526 0.003991 ** </span></span>
<span id="cb115-19"><a href="linear-mixed-effect-models-lmms.html#cb115-19"></a><span class="co">## ---</span></span>
<span id="cb115-20"><a href="linear-mixed-effect-models-lmms.html#cb115-20"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb115-21"><a href="linear-mixed-effect-models-lmms.html#cb115-21"></a><span class="co">## </span></span>
<span id="cb115-22"><a href="linear-mixed-effect-models-lmms.html#cb115-22"></a><span class="co">## Residual standard error: 1.203 on 6 degrees of freedom</span></span>
<span id="cb115-23"><a href="linear-mixed-effect-models-lmms.html#cb115-23"></a><span class="co">## Multiple R-squared:  0.8449, Adjusted R-squared:  0.7157 </span></span>
<span id="cb115-24"><a href="linear-mixed-effect-models-lmms.html#cb115-24"></a><span class="co">## F-statistic: 6.538 on 5 and 6 DF,  p-value: 0.02034</span></span></code></pre></div>
</div>
<div id="run-as-a-random-effect" class="section level4 hasAnchor">
<h4><code>Run</code> as a random effect<a href="linear-mixed-effect-models-lmms.html#run-as-a-random-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="alert alert-info">
<p><img src="https://github.com/BIOSCI738/cowstats/blob/main/img/code_tag.png?raw=true" style="width:10.0%" /></p>
<p><strong>Note</strong> Both the <code>lmerTest</code> and <code>lme4</code> packages export a function called <code>lmer</code>, which fits linear mixed effect models. For all estimation purposes etc. they essentially do the same think. However, the structure of the output differs and this MATTERS when we later come to use other funtions on the outputs. Therefore, I take care below to specify which version of the <code>lmer</code> function I use by explicitly calling it from either <code>lmerTest</code> or <code>lme4</code> using the <code>::</code> syntax.</p>
</div>
<p>There are, confusingly, two ways of fitting the same model. For inference we require both!</p>
<p>Option 1 uses the <code>lmer</code> function from the <code>lme4</code> package:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="linear-mixed-effect-models-lmms.html#cb116-1"></a>lmer4_mod &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(logAUC8 <span class="op">~</span><span class="st"> </span>Surgery <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Run), <span class="dt">data =</span> rcbd)</span>
<span id="cb116-2"><a href="linear-mixed-effect-models-lmms.html#cb116-2"></a><span class="kw">summary</span>(lmer4_mod)</span>
<span id="cb116-3"><a href="linear-mixed-effect-models-lmms.html#cb116-3"></a><span class="co">## Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb116-4"><a href="linear-mixed-effect-models-lmms.html#cb116-4"></a><span class="co">## Formula: logAUC8 ~ Surgery + (1 | Run)</span></span>
<span id="cb116-5"><a href="linear-mixed-effect-models-lmms.html#cb116-5"></a><span class="co">##    Data: rcbd</span></span>
<span id="cb116-6"><a href="linear-mixed-effect-models-lmms.html#cb116-6"></a><span class="co">## </span></span>
<span id="cb116-7"><a href="linear-mixed-effect-models-lmms.html#cb116-7"></a><span class="co">## REML criterion at convergence: 37.2</span></span>
<span id="cb116-8"><a href="linear-mixed-effect-models-lmms.html#cb116-8"></a><span class="co">## </span></span>
<span id="cb116-9"><a href="linear-mixed-effect-models-lmms.html#cb116-9"></a><span class="co">## Scaled residuals: </span></span>
<span id="cb116-10"><a href="linear-mixed-effect-models-lmms.html#cb116-10"></a><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb116-11"><a href="linear-mixed-effect-models-lmms.html#cb116-11"></a><span class="co">## -1.8525 -0.2273  0.1772  0.4036  1.3309 </span></span>
<span id="cb116-12"><a href="linear-mixed-effect-models-lmms.html#cb116-12"></a><span class="co">## </span></span>
<span id="cb116-13"><a href="linear-mixed-effect-models-lmms.html#cb116-13"></a><span class="co">## Random effects:</span></span>
<span id="cb116-14"><a href="linear-mixed-effect-models-lmms.html#cb116-14"></a><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb116-15"><a href="linear-mixed-effect-models-lmms.html#cb116-15"></a><span class="co">##  Run      (Intercept) 1.479    1.216   </span></span>
<span id="cb116-16"><a href="linear-mixed-effect-models-lmms.html#cb116-16"></a><span class="co">##  Residual             1.447    1.203   </span></span>
<span id="cb116-17"><a href="linear-mixed-effect-models-lmms.html#cb116-17"></a><span class="co">## Number of obs: 12, groups:  Run, 4</span></span>
<span id="cb116-18"><a href="linear-mixed-effect-models-lmms.html#cb116-18"></a><span class="co">## </span></span>
<span id="cb116-19"><a href="linear-mixed-effect-models-lmms.html#cb116-19"></a><span class="co">## Fixed effects:</span></span>
<span id="cb116-20"><a href="linear-mixed-effect-models-lmms.html#cb116-20"></a><span class="co">##             Estimate Std. Error t value</span></span>
<span id="cb116-21"><a href="linear-mixed-effect-models-lmms.html#cb116-21"></a><span class="co">## (Intercept)   7.5800     0.8552   8.863</span></span>
<span id="cb116-22"><a href="linear-mixed-effect-models-lmms.html#cb116-22"></a><span class="co">## SurgeryP      1.9750     0.8506   2.322</span></span>
<span id="cb116-23"><a href="linear-mixed-effect-models-lmms.html#cb116-23"></a><span class="co">## SurgeryS      3.8500     0.8506   4.526</span></span>
<span id="cb116-24"><a href="linear-mixed-effect-models-lmms.html#cb116-24"></a><span class="co">## </span></span>
<span id="cb116-25"><a href="linear-mixed-effect-models-lmms.html#cb116-25"></a><span class="co">## Correlation of Fixed Effects:</span></span>
<span id="cb116-26"><a href="linear-mixed-effect-models-lmms.html#cb116-26"></a><span class="co">##          (Intr) SrgryP</span></span>
<span id="cb116-27"><a href="linear-mixed-effect-models-lmms.html#cb116-27"></a><span class="co">## SurgeryP -0.497       </span></span>
<span id="cb116-28"><a href="linear-mixed-effect-models-lmms.html#cb116-28"></a><span class="co">## SurgeryS -0.497  0.500</span></span></code></pre></div>
<p>Option 2 uses the <code>lmer</code> function from the <code>lmerTest</code> package:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="linear-mixed-effect-models-lmms.html#cb117-1"></a>lmerTest_mod &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(logAUC8 <span class="op">~</span><span class="st"> </span>Surgery <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Run), <span class="dt">data =</span> rcbd)</span>
<span id="cb117-2"><a href="linear-mixed-effect-models-lmms.html#cb117-2"></a><span class="kw">summary</span>(lmerTest_mod)</span>
<span id="cb117-3"><a href="linear-mixed-effect-models-lmms.html#cb117-3"></a><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [</span></span>
<span id="cb117-4"><a href="linear-mixed-effect-models-lmms.html#cb117-4"></a><span class="co">## lmerModLmerTest]</span></span>
<span id="cb117-5"><a href="linear-mixed-effect-models-lmms.html#cb117-5"></a><span class="co">## Formula: logAUC8 ~ Surgery + (1 | Run)</span></span>
<span id="cb117-6"><a href="linear-mixed-effect-models-lmms.html#cb117-6"></a><span class="co">##    Data: rcbd</span></span>
<span id="cb117-7"><a href="linear-mixed-effect-models-lmms.html#cb117-7"></a><span class="co">## </span></span>
<span id="cb117-8"><a href="linear-mixed-effect-models-lmms.html#cb117-8"></a><span class="co">## REML criterion at convergence: 37.2</span></span>
<span id="cb117-9"><a href="linear-mixed-effect-models-lmms.html#cb117-9"></a><span class="co">## </span></span>
<span id="cb117-10"><a href="linear-mixed-effect-models-lmms.html#cb117-10"></a><span class="co">## Scaled residuals: </span></span>
<span id="cb117-11"><a href="linear-mixed-effect-models-lmms.html#cb117-11"></a><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb117-12"><a href="linear-mixed-effect-models-lmms.html#cb117-12"></a><span class="co">## -1.8525 -0.2273  0.1772  0.4036  1.3309 </span></span>
<span id="cb117-13"><a href="linear-mixed-effect-models-lmms.html#cb117-13"></a><span class="co">## </span></span>
<span id="cb117-14"><a href="linear-mixed-effect-models-lmms.html#cb117-14"></a><span class="co">## Random effects:</span></span>
<span id="cb117-15"><a href="linear-mixed-effect-models-lmms.html#cb117-15"></a><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb117-16"><a href="linear-mixed-effect-models-lmms.html#cb117-16"></a><span class="co">##  Run      (Intercept) 1.479    1.216   </span></span>
<span id="cb117-17"><a href="linear-mixed-effect-models-lmms.html#cb117-17"></a><span class="co">##  Residual             1.447    1.203   </span></span>
<span id="cb117-18"><a href="linear-mixed-effect-models-lmms.html#cb117-18"></a><span class="co">## Number of obs: 12, groups:  Run, 4</span></span>
<span id="cb117-19"><a href="linear-mixed-effect-models-lmms.html#cb117-19"></a><span class="co">## </span></span>
<span id="cb117-20"><a href="linear-mixed-effect-models-lmms.html#cb117-20"></a><span class="co">## Fixed effects:</span></span>
<span id="cb117-21"><a href="linear-mixed-effect-models-lmms.html#cb117-21"></a><span class="co">##             Estimate Std. Error     df t value Pr(&gt;|t|)    </span></span>
<span id="cb117-22"><a href="linear-mixed-effect-models-lmms.html#cb117-22"></a><span class="co">## (Intercept)   7.5800     0.8552 5.9567   8.863 0.000119 ***</span></span>
<span id="cb117-23"><a href="linear-mixed-effect-models-lmms.html#cb117-23"></a><span class="co">## SurgeryP      1.9750     0.8506 6.0000   2.322 0.059293 .  </span></span>
<span id="cb117-24"><a href="linear-mixed-effect-models-lmms.html#cb117-24"></a><span class="co">## SurgeryS      3.8500     0.8506 6.0000   4.526 0.003991 ** </span></span>
<span id="cb117-25"><a href="linear-mixed-effect-models-lmms.html#cb117-25"></a><span class="co">## ---</span></span>
<span id="cb117-26"><a href="linear-mixed-effect-models-lmms.html#cb117-26"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb117-27"><a href="linear-mixed-effect-models-lmms.html#cb117-27"></a><span class="co">## </span></span>
<span id="cb117-28"><a href="linear-mixed-effect-models-lmms.html#cb117-28"></a><span class="co">## Correlation of Fixed Effects:</span></span>
<span id="cb117-29"><a href="linear-mixed-effect-models-lmms.html#cb117-29"></a><span class="co">##          (Intr) SrgryP</span></span>
<span id="cb117-30"><a href="linear-mixed-effect-models-lmms.html#cb117-30"></a><span class="co">## SurgeryP -0.497       </span></span>
<span id="cb117-31"><a href="linear-mixed-effect-models-lmms.html#cb117-31"></a><span class="co">## SurgeryS -0.497  0.500</span></span></code></pre></div>
<p>As you can see they give the same output! Why bother, you might ask?! This will become apparent later on.</p>
<p><strong>Inference</strong> about the random effects</p>
<p>We have two variance components</p>
<ul>
<li>Between Groups (Runs) <span class="math inline">\(\hat{\sigma^2}_{\text{Run}}\)</span> = 1.479</li>
<li>Within Runs (between observations) <span class="math inline">\(\hat{\sigma_2}\)</span> = 1.447</li>
</ul>
<p>Note that <code>aov()</code> presents the same information, but in a different way:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="linear-mixed-effect-models-lmms.html#cb118-1"></a><span class="kw">summary</span>(<span class="kw">aov</span>(logAUC8 <span class="op">~</span><span class="st"> </span>Surgery <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Run), <span class="dt">data =</span> rcbd))</span>
<span id="cb118-2"><a href="linear-mixed-effect-models-lmms.html#cb118-2"></a><span class="co">## </span></span>
<span id="cb118-3"><a href="linear-mixed-effect-models-lmms.html#cb118-3"></a><span class="co">## Error: Run</span></span>
<span id="cb118-4"><a href="linear-mixed-effect-models-lmms.html#cb118-4"></a><span class="co">##           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb118-5"><a href="linear-mixed-effect-models-lmms.html#cb118-5"></a><span class="co">## Residuals  3  17.65   5.883               </span></span>
<span id="cb118-6"><a href="linear-mixed-effect-models-lmms.html#cb118-6"></a><span class="co">## </span></span>
<span id="cb118-7"><a href="linear-mixed-effect-models-lmms.html#cb118-7"></a><span class="co">## Error: Within</span></span>
<span id="cb118-8"><a href="linear-mixed-effect-models-lmms.html#cb118-8"></a><span class="co">##           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span id="cb118-9"><a href="linear-mixed-effect-models-lmms.html#cb118-9"></a><span class="co">## Surgery    2 29.652  14.826   10.25 0.0116 *</span></span>
<span id="cb118-10"><a href="linear-mixed-effect-models-lmms.html#cb118-10"></a><span class="co">## Residuals  6  8.682   1.447                 </span></span>
<span id="cb118-11"><a href="linear-mixed-effect-models-lmms.html#cb118-11"></a><span class="co">## ---</span></span>
<span id="cb118-12"><a href="linear-mixed-effect-models-lmms.html#cb118-12"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<ul>
<li>Within Runs (Residuals) <span class="math inline">\(\hat{\sigma}_2\)</span> = 1.447 (<em>same as <code>lmer</code></em>)</li>
<li>Between Run variance = <span class="math inline">\(\hat{\sigma}^2\)</span> + <span class="math inline">\(3\:\hat{\sigma}^2_{\text{Run}}\)</span> so <span class="math inline">\(\hat{\sigma}^2_{\text{Run}} = \frac{5.883 - \hat{\sigma}^2 }{3} = \frac{5.883 - 1.447}{3} = 1.479\)</span></li>
</ul>
<p><strong>Inference</strong> about the fixed effects</p>
<p>Specifying <code>Run</code> as random effect changes our estimated baseline (i.e., <code>Intercept</code> coefficient) as now and effect due to <code>Run</code> is attributed to the structural component of the model.</p>
<p>We can interpret the fixed effects of a LMM as we might for a linear model (now the <code>Intercept</code> estimate changes depending on <code>Run</code>).</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="linear-mixed-effect-models-lmms.html#cb119-1"></a><span class="kw">coefficients</span>(lmer4_mod)</span>
<span id="cb119-2"><a href="linear-mixed-effect-models-lmms.html#cb119-2"></a><span class="co">## $Run</span></span>
<span id="cb119-3"><a href="linear-mixed-effect-models-lmms.html#cb119-3"></a><span class="co">##   (Intercept) SurgeryP SurgeryS</span></span>
<span id="cb119-4"><a href="linear-mixed-effect-models-lmms.html#cb119-4"></a><span class="co">## 1    7.639067    1.975     3.85</span></span>
<span id="cb119-5"><a href="linear-mixed-effect-models-lmms.html#cb119-5"></a><span class="co">## 2    6.118411    1.975     3.85</span></span>
<span id="cb119-6"><a href="linear-mixed-effect-models-lmms.html#cb119-6"></a><span class="co">## 3    7.948225    1.975     3.85</span></span>
<span id="cb119-7"><a href="linear-mixed-effect-models-lmms.html#cb119-7"></a><span class="co">## 4    8.614297    1.975     3.85</span></span>
<span id="cb119-8"><a href="linear-mixed-effect-models-lmms.html#cb119-8"></a><span class="co">## </span></span>
<span id="cb119-9"><a href="linear-mixed-effect-models-lmms.html#cb119-9"></a><span class="co">## attr(,&quot;class&quot;)</span></span>
<span id="cb119-10"><a href="linear-mixed-effect-models-lmms.html#cb119-10"></a><span class="co">## [1] &quot;coef.mer&quot;</span></span>
<span id="cb119-11"><a href="linear-mixed-effect-models-lmms.html#cb119-11"></a><span class="kw">coefficients</span>(lmerTest_mod)</span>
<span id="cb119-12"><a href="linear-mixed-effect-models-lmms.html#cb119-12"></a><span class="co">## $Run</span></span>
<span id="cb119-13"><a href="linear-mixed-effect-models-lmms.html#cb119-13"></a><span class="co">##   (Intercept) SurgeryP SurgeryS</span></span>
<span id="cb119-14"><a href="linear-mixed-effect-models-lmms.html#cb119-14"></a><span class="co">## 1    7.639067    1.975     3.85</span></span>
<span id="cb119-15"><a href="linear-mixed-effect-models-lmms.html#cb119-15"></a><span class="co">## 2    6.118411    1.975     3.85</span></span>
<span id="cb119-16"><a href="linear-mixed-effect-models-lmms.html#cb119-16"></a><span class="co">## 3    7.948225    1.975     3.85</span></span>
<span id="cb119-17"><a href="linear-mixed-effect-models-lmms.html#cb119-17"></a><span class="co">## 4    8.614297    1.975     3.85</span></span>
<span id="cb119-18"><a href="linear-mixed-effect-models-lmms.html#cb119-18"></a><span class="co">## </span></span>
<span id="cb119-19"><a href="linear-mixed-effect-models-lmms.html#cb119-19"></a><span class="co">## attr(,&quot;class&quot;)</span></span>
<span id="cb119-20"><a href="linear-mixed-effect-models-lmms.html#cb119-20"></a><span class="co">## [1] &quot;coef.mer&quot;</span></span></code></pre></div>
<p>What about an ANOVA table? <strong>NOTE</strong> that specifying the type of <span class="math inline">\(SS\)</span> (e.g., Type I, II, or III) in an <code>anova</code> call <strong>only</strong> works with a model fitted using <code>lmerTest::lmer</code>:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="linear-mixed-effect-models-lmms.html#cb120-1"></a><span class="kw">anova</span>(lmerTest_mod, <span class="dt">type =</span> <span class="dv">1</span>)</span>
<span id="cb120-2"><a href="linear-mixed-effect-models-lmms.html#cb120-2"></a><span class="co">## Type I Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb120-3"><a href="linear-mixed-effect-models-lmms.html#cb120-3"></a><span class="co">##         Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb120-4"><a href="linear-mixed-effect-models-lmms.html#cb120-4"></a><span class="co">## Surgery 29.652  14.826     2     6  10.246 0.01162 *</span></span>
<span id="cb120-5"><a href="linear-mixed-effect-models-lmms.html#cb120-5"></a><span class="co">## ---</span></span>
<span id="cb120-6"><a href="linear-mixed-effect-models-lmms.html#cb120-6"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb120-7"><a href="linear-mixed-effect-models-lmms.html#cb120-7"></a><span class="kw">anova</span>(lmerTest_mod, <span class="dt">type =</span> <span class="dv">2</span>)</span>
<span id="cb120-8"><a href="linear-mixed-effect-models-lmms.html#cb120-8"></a><span class="co">## Type II Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb120-9"><a href="linear-mixed-effect-models-lmms.html#cb120-9"></a><span class="co">##         Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb120-10"><a href="linear-mixed-effect-models-lmms.html#cb120-10"></a><span class="co">## Surgery 29.652  14.826     2     6  10.246 0.01162 *</span></span>
<span id="cb120-11"><a href="linear-mixed-effect-models-lmms.html#cb120-11"></a><span class="co">## ---</span></span>
<span id="cb120-12"><a href="linear-mixed-effect-models-lmms.html#cb120-12"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Now, as we only have a single fixed effect in our model (<code>Surgery</code>) the ANOVA Type I and Type II tables above are equivalent!</p>
<p><strong>Inference using <code>predictmeans()</code></strong> (Note: output will be the same for the <code>lmerTest</code> model.)</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="linear-mixed-effect-models-lmms.html#cb121-1"></a>pm &lt;-<span class="st"> </span><span class="kw">predictmeans</span>(lmer4_mod, <span class="dt">modelterm =</span> <span class="st">&quot;Surgery&quot;</span>, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Using the elements of the <code>predictmeans</code> object (as in the last section) we can extract the pairwise comparison information:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="linear-mixed-effect-models-lmms.html#cb122-1"></a>pm<span class="op">$</span><span class="st">`</span><span class="dt">Pairwise LSDs</span><span class="st">`</span></span>
<span id="cb122-2"><a href="linear-mixed-effect-models-lmms.html#cb122-2"></a><span class="co">##         C        P      S</span></span>
<span id="cb122-3"><a href="linear-mixed-effect-models-lmms.html#cb122-3"></a><span class="co">## C 0.00000 -1.97500 -3.850</span></span>
<span id="cb122-4"><a href="linear-mixed-effect-models-lmms.html#cb122-4"></a><span class="co">## P 2.08132  0.00000 -1.875</span></span>
<span id="cb122-5"><a href="linear-mixed-effect-models-lmms.html#cb122-5"></a><span class="co">## S 2.08132  2.08132  0.000</span></span>
<span id="cb122-6"><a href="linear-mixed-effect-models-lmms.html#cb122-6"></a><span class="co">## attr(,&quot;Significant level&quot;)</span></span>
<span id="cb122-7"><a href="linear-mixed-effect-models-lmms.html#cb122-7"></a><span class="co">## [1] 0.05</span></span>
<span id="cb122-8"><a href="linear-mixed-effect-models-lmms.html#cb122-8"></a><span class="co">## attr(,&quot;Degree of freedom&quot;)</span></span>
<span id="cb122-9"><a href="linear-mixed-effect-models-lmms.html#cb122-9"></a><span class="co">## [1] 6</span></span>
<span id="cb122-10"><a href="linear-mixed-effect-models-lmms.html#cb122-10"></a><span class="co">## attr(,&quot;Note&quot;)</span></span>
<span id="cb122-11"><a href="linear-mixed-effect-models-lmms.html#cb122-11"></a><span class="co">## [1] &quot;LSDs matrix has mean differences (row-col) above the diagonal, LSDs (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span>
<span id="cb122-12"><a href="linear-mixed-effect-models-lmms.html#cb122-12"></a><span class="kw">print</span>(pm<span class="op">$</span><span class="st">`</span><span class="dt">Pairwise p-value</span><span class="st">`</span>)</span>
<span id="cb122-13"><a href="linear-mixed-effect-models-lmms.html#cb122-13"></a><span class="co">##        C       P       S</span></span>
<span id="cb122-14"><a href="linear-mixed-effect-models-lmms.html#cb122-14"></a><span class="co">## C 1.0000 -2.3219 -4.5263</span></span>
<span id="cb122-15"><a href="linear-mixed-effect-models-lmms.html#cb122-15"></a><span class="co">## P 0.0593  1.0000 -2.2043</span></span>
<span id="cb122-16"><a href="linear-mixed-effect-models-lmms.html#cb122-16"></a><span class="co">## S 0.0040  0.0697  1.0000</span></span>
<span id="cb122-17"><a href="linear-mixed-effect-models-lmms.html#cb122-17"></a><span class="co">## attr(,&quot;Note&quot;)</span></span>
<span id="cb122-18"><a href="linear-mixed-effect-models-lmms.html#cb122-18"></a><span class="co">## [1] &quot;The matrix has t-value above the diagonal, p-value (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span></code></pre></div>
<p>Gives us 1) pairwise differences (upper diagonal) and the LSD values (lower diagonal), and 2) the pairwise comparison statistic (the <span class="math inline">\(t\)</span>-statistic in this case) on the upper diagonal and the associated p-value’s on the lower diagonal.</p>
<p>So is there a pairwise difference in means? Let’s organise the information in a table. Below we read a specifically designed function to do this from the given URL.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="linear-mixed-effect-models-lmms.html#cb123-1"></a><span class="kw">comparisons</span>(pm)</span>
<span id="cb123-2"><a href="linear-mixed-effect-models-lmms.html#cb123-2"></a><span class="co">##   Comparison Difference   SED   LSD    lwr    upr      t      p</span></span>
<span id="cb123-3"><a href="linear-mixed-effect-models-lmms.html#cb123-3"></a><span class="co">## 1        C-P     -1.975 0.851 2.081 -4.056  0.106 -2.322 0.0593</span></span>
<span id="cb123-4"><a href="linear-mixed-effect-models-lmms.html#cb123-4"></a><span class="co">## 2        C-S     -3.850 0.851 2.081 -5.931 -1.769 -4.526 0.0040</span></span>
<span id="cb123-5"><a href="linear-mixed-effect-models-lmms.html#cb123-5"></a><span class="co">## 3        P-S     -1.875 0.851 2.081 -3.956  0.206 -2.204 0.0697</span></span></code></pre></div>
<p>Have a look at the CIs and p-values. What do you conclude?</p>
<p>We could also plot the pairwise comparisons using <code>emmeans</code></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="linear-mixed-effect-models-lmms.html#cb124-1"></a>em &lt;-<span class="st"> </span><span class="kw">emmeans</span>(lmer4_mod, <span class="dt">specs =</span>  <span class="st">&quot;Surgery&quot;</span>)</span>
<span id="cb124-2"><a href="linear-mixed-effect-models-lmms.html#cb124-2"></a><span class="kw">plot</span>(em, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
</div>
</div>
<div id="a-split-plot-design" class="section level3 hasAnchor">
<h3>A Split-plot design<a href="linear-mixed-effect-models-lmms.html#a-split-plot-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="linear-mixed-effect-models-lmms.html#cb125-1"></a><span class="kw">glimpse</span>(split_plot)</span>
<span id="cb125-2"><a href="linear-mixed-effect-models-lmms.html#cb125-2"></a><span class="co">## Rows: 12</span></span>
<span id="cb125-3"><a href="linear-mixed-effect-models-lmms.html#cb125-3"></a><span class="co">## Columns: 5</span></span>
<span id="cb125-4"><a href="linear-mixed-effect-models-lmms.html#cb125-4"></a><span class="co">## $ Disease &lt;chr&gt; &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Health…</span></span>
<span id="cb125-5"><a href="linear-mixed-effect-models-lmms.html#cb125-5"></a><span class="co">## $ Organ   &lt;chr&gt; &quot;innerLV&quot;, &quot;outerLV&quot;, &quot;innerLV&quot;, &quot;outerLV&quot;, &quot;innerLV&quot;, &quot;outerL…</span></span>
<span id="cb125-6"><a href="linear-mixed-effect-models-lmms.html#cb125-6"></a><span class="co">## $ Animal  &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6</span></span>
<span id="cb125-7"><a href="linear-mixed-effect-models-lmms.html#cb125-7"></a><span class="co">## $ Sample  &lt;dbl&gt; 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2</span></span>
<span id="cb125-8"><a href="linear-mixed-effect-models-lmms.html#cb125-8"></a><span class="co">## $ logAUC  &lt;dbl&gt; 9.40, 8.83, 10.33, 10.49, 9.74, 10.98, 7.92, 9.37, 8.69, 11.31…</span></span></code></pre></div>
<p>To use <code>predictmeans</code> later on we have to ensure that the relevant variables are coded as factors:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="linear-mixed-effect-models-lmms.html#cb126-1"></a>split_plot &lt;-<span class="st"> </span>split_plot <span class="op">%&gt;%</span></span>
<span id="cb126-2"><a href="linear-mixed-effect-models-lmms.html#cb126-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Animal =</span> <span class="kw">as.factor</span>(Animal)) <span class="op">%&gt;%</span></span>
<span id="cb126-3"><a href="linear-mixed-effect-models-lmms.html#cb126-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Disease =</span> <span class="kw">as.factor</span>(Disease))<span class="op">%&gt;%</span></span>
<span id="cb126-4"><a href="linear-mixed-effect-models-lmms.html#cb126-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Organ =</span> <span class="kw">as.factor</span>(Organ))</span></code></pre></div>
<div id="animal-as-a-random-effect" class="section level4 hasAnchor">
<h4><code>Animal</code> as a random effect<a href="linear-mixed-effect-models-lmms.html#animal-as-a-random-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Using <code>aov()</code></strong></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="linear-mixed-effect-models-lmms.html#cb127-1"></a>sp_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Animal), <span class="dt">data =</span> split_plot)</span>
<span id="cb127-2"><a href="linear-mixed-effect-models-lmms.html#cb127-2"></a><span class="kw">summary</span>(sp_aov)</span>
<span id="cb127-3"><a href="linear-mixed-effect-models-lmms.html#cb127-3"></a><span class="co">## </span></span>
<span id="cb127-4"><a href="linear-mixed-effect-models-lmms.html#cb127-4"></a><span class="co">## Error: Animal</span></span>
<span id="cb127-5"><a href="linear-mixed-effect-models-lmms.html#cb127-5"></a><span class="co">##           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb127-6"><a href="linear-mixed-effect-models-lmms.html#cb127-6"></a><span class="co">## Disease    1  3.183   3.183   2.187  0.213</span></span>
<span id="cb127-7"><a href="linear-mixed-effect-models-lmms.html#cb127-7"></a><span class="co">## Residuals  4  5.822   1.456               </span></span>
<span id="cb127-8"><a href="linear-mixed-effect-models-lmms.html#cb127-8"></a><span class="co">## </span></span>
<span id="cb127-9"><a href="linear-mixed-effect-models-lmms.html#cb127-9"></a><span class="co">## Error: Within</span></span>
<span id="cb127-10"><a href="linear-mixed-effect-models-lmms.html#cb127-10"></a><span class="co">##               Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span id="cb127-11"><a href="linear-mixed-effect-models-lmms.html#cb127-11"></a><span class="co">## Organ          1  4.296   4.296  14.423 0.0191 *</span></span>
<span id="cb127-12"><a href="linear-mixed-effect-models-lmms.html#cb127-12"></a><span class="co">## Disease:Organ  1  2.539   2.539   8.525 0.0433 *</span></span>
<span id="cb127-13"><a href="linear-mixed-effect-models-lmms.html#cb127-13"></a><span class="co">## Residuals      4  1.191   0.298                 </span></span>
<span id="cb127-14"><a href="linear-mixed-effect-models-lmms.html#cb127-14"></a><span class="co">## ---</span></span>
<span id="cb127-15"><a href="linear-mixed-effect-models-lmms.html#cb127-15"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Using <code>lmer()</code> (from <code>lmeTest</code> and <code>lmer4</code>)</strong></p>
<p>Recall that specifying the type of <span class="math inline">\(SS\)</span> (e.g., Type I, II, or III) in an <code>anova</code> call <strong>only</strong> works with a model fitted using <code>lmerTest::lmer</code>. As we now have specified an interaction model then the type of <span class="math inline">\(SS\)</span> calculated will have an effect on inference for unbalanced designs.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="linear-mixed-effect-models-lmms.html#cb128-1"></a>sp_lmer &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal), </span>
<span id="cb128-2"><a href="linear-mixed-effect-models-lmms.html#cb128-2"></a>                          <span class="dt">data =</span> split_plot) </span>
<span id="cb128-3"><a href="linear-mixed-effect-models-lmms.html#cb128-3"></a><span class="kw">anova</span>(sp_lmer,<span class="dt">type =</span> <span class="dv">1</span>)</span>
<span id="cb128-4"><a href="linear-mixed-effect-models-lmms.html#cb128-4"></a><span class="co">## Type I Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb128-5"><a href="linear-mixed-effect-models-lmms.html#cb128-5"></a><span class="co">##               Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb128-6"><a href="linear-mixed-effect-models-lmms.html#cb128-6"></a><span class="co">## Disease       0.6513  0.6513     1     4  2.1866 0.21329  </span></span>
<span id="cb128-7"><a href="linear-mixed-effect-models-lmms.html#cb128-7"></a><span class="co">## Organ         4.2960  4.2960     1     4 14.4227 0.01914 *</span></span>
<span id="cb128-8"><a href="linear-mixed-effect-models-lmms.html#cb128-8"></a><span class="co">## Disease:Organ 2.5392  2.5392     1     4  8.5246 0.04326 *</span></span>
<span id="cb128-9"><a href="linear-mixed-effect-models-lmms.html#cb128-9"></a><span class="co">## ---</span></span>
<span id="cb128-10"><a href="linear-mixed-effect-models-lmms.html#cb128-10"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb128-11"><a href="linear-mixed-effect-models-lmms.html#cb128-11"></a><span class="kw">anova</span>(sp_lmer,<span class="dt">type =</span> <span class="dv">2</span>)</span>
<span id="cb128-12"><a href="linear-mixed-effect-models-lmms.html#cb128-12"></a><span class="co">## Type II Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb128-13"><a href="linear-mixed-effect-models-lmms.html#cb128-13"></a><span class="co">##               Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb128-14"><a href="linear-mixed-effect-models-lmms.html#cb128-14"></a><span class="co">## Disease       0.6513  0.6513     1     4  2.1866 0.21329  </span></span>
<span id="cb128-15"><a href="linear-mixed-effect-models-lmms.html#cb128-15"></a><span class="co">## Organ         4.2960  4.2960     1     4 14.4227 0.01914 *</span></span>
<span id="cb128-16"><a href="linear-mixed-effect-models-lmms.html#cb128-16"></a><span class="co">## Disease:Organ 2.5392  2.5392     1     4  8.5246 0.04326 *</span></span>
<span id="cb128-17"><a href="linear-mixed-effect-models-lmms.html#cb128-17"></a><span class="co">## ---</span></span>
<span id="cb128-18"><a href="linear-mixed-effect-models-lmms.html#cb128-18"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Note here, though, our design is <strong>balanced</strong> hence the ordering of terms in our model does not make a difference (no need to specify Type II <span class="math inline">\(SS\)</span>)</p>
<p><strong>Pairwise comparison of time means</strong></p>
<p>When a design has blocking, to get summary stats using <code>predictmeans</code> you should fit the model using <code>lme4::lmer()</code>:</p>
<p>Calling <code>predictmeans</code> alone produces plots:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="linear-mixed-effect-models-lmms.html#cb129-1"></a>lmer &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(logAUC <span class="op">~</span><span class="st"> </span>Disease<span class="op">*</span>Organ <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal), </span>
<span id="cb129-2"><a href="linear-mixed-effect-models-lmms.html#cb129-2"></a>                          <span class="dt">data =</span> split_plot)</span>
<span id="cb129-3"><a href="linear-mixed-effect-models-lmms.html#cb129-3"></a>predmeans &lt;-<span class="st"> </span>predictmeans<span class="op">::</span><span class="kw">predictmeans</span>(<span class="dt">model =</span> lmer ,<span class="dt">modelterm =</span> <span class="st">&quot;Disease:Organ&quot;</span>, </span>
<span id="cb129-4"><a href="linear-mixed-effect-models-lmms.html#cb129-4"></a>                                        <span class="dt">pairwise =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-152-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-152-3.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="linear-mixed-effect-models-lmms.html#cb130-1"></a>predmeans<span class="op">$</span>predictmeansPlot</span>
<span id="cb130-2"><a href="linear-mixed-effect-models-lmms.html#cb130-2"></a><span class="co">## $meanPlot</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<pre><code>## 
## $ciPlot</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-153-2.png" width="672" /></p>
<p>Recall from previous sections that the LSD vale is essentially the <em>buffer</em> around the point estimate (the radius of the CI if you like), beyond the limit of which we might believe there to be a <em>significant</em> difference (a bit lax with terminology there!).</p>
<p><strong>How</strong> would be interpret the above plot? I would conclude that there is a big difference between Diabetic and Healthy for InnerLV wall, but no difference for the outerLV wall. We can construct the pairwise comparison table:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="linear-mixed-effect-models-lmms.html#cb132-1"></a><span class="kw">comparisons</span>(predmeans)</span>
<span id="cb132-2"><a href="linear-mixed-effect-models-lmms.html#cb132-2"></a><span class="co">##                          Comparison Difference   SED   LSD    lwr    upr      t</span></span>
<span id="cb132-3"><a href="linear-mixed-effect-models-lmms.html#cb132-3"></a><span class="co">## 1 Diabetic:innerLV-Diabetic:outerLV     -2.117 0.446 1.237 -3.354 -0.879 -4.750</span></span>
<span id="cb132-4"><a href="linear-mixed-effect-models-lmms.html#cb132-4"></a><span class="co">## 2  Diabetic:innerLV-Healthy:innerLV     -1.950 0.764 2.123 -4.073  0.173 -2.551</span></span>
<span id="cb132-5"><a href="linear-mixed-effect-models-lmms.html#cb132-5"></a><span class="co">## 3  Diabetic:innerLV-Healthy:outerLV     -2.227 0.764 2.123 -4.349 -0.104 -2.913</span></span>
<span id="cb132-6"><a href="linear-mixed-effect-models-lmms.html#cb132-6"></a><span class="co">## 4  Diabetic:outerLV-Healthy:innerLV      0.167 0.765 2.123 -1.956  2.289  0.218</span></span>
<span id="cb132-7"><a href="linear-mixed-effect-models-lmms.html#cb132-7"></a><span class="co">## 5  Diabetic:outerLV-Healthy:outerLV     -0.110 0.764 2.123 -2.233  2.013 -0.144</span></span>
<span id="cb132-8"><a href="linear-mixed-effect-models-lmms.html#cb132-8"></a><span class="co">## 6   Healthy:innerLV-Healthy:outerLV     -0.277 0.446 1.237 -1.514  0.961 -0.621</span></span>
<span id="cb132-9"><a href="linear-mixed-effect-models-lmms.html#cb132-9"></a><span class="co">##        p</span></span>
<span id="cb132-10"><a href="linear-mixed-effect-models-lmms.html#cb132-10"></a><span class="co">## 1 0.0090</span></span>
<span id="cb132-11"><a href="linear-mixed-effect-models-lmms.html#cb132-11"></a><span class="co">## 2 0.0464</span></span>
<span id="cb132-12"><a href="linear-mixed-effect-models-lmms.html#cb132-12"></a><span class="co">## 3 0.0293</span></span>
<span id="cb132-13"><a href="linear-mixed-effect-models-lmms.html#cb132-13"></a><span class="co">## 4 0.8352</span></span>
<span id="cb132-14"><a href="linear-mixed-effect-models-lmms.html#cb132-14"></a><span class="co">## 5 0.8907</span></span>
<span id="cb132-15"><a href="linear-mixed-effect-models-lmms.html#cb132-15"></a><span class="co">## 6 0.5683</span></span></code></pre></div>
<p>What do the CI coverages indicate?</p>
<p>We can also use <code>emmeans</code> to plot the pairwise comparisons</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="linear-mixed-effect-models-lmms.html#cb133-1"></a>em &lt;-<span class="st"> </span><span class="kw">emmeans</span>(lmer, <span class="op">~</span>Disease<span class="op">*</span>Organ)</span>
<span id="cb133-2"><a href="linear-mixed-effect-models-lmms.html#cb133-2"></a><span class="kw">plot</span>(em, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>From all the output above, what do you conclude about the interaction effect, if any!</p>
</div>
</div>
<div id="a-repeated-measures-design" class="section level3 hasAnchor">
<h3>A repeated measures design<a href="linear-mixed-effect-models-lmms.html#a-repeated-measures-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="linear-mixed-effect-models-lmms.html#cb134-1"></a>liver &lt;-<span class="st"> </span>liver <span class="op">%&gt;%</span></span>
<span id="cb134-2"><a href="linear-mixed-effect-models-lmms.html#cb134-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Time =</span> <span class="kw">as.factor</span>(Time)) <span class="op">%&gt;%</span></span>
<span id="cb134-3"><a href="linear-mixed-effect-models-lmms.html#cb134-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Treatment =</span> <span class="kw">as.factor</span>(Treatment)) </span>
<span id="cb134-4"><a href="linear-mixed-effect-models-lmms.html#cb134-4"></a><span class="kw">glimpse</span>(liver)</span>
<span id="cb134-5"><a href="linear-mixed-effect-models-lmms.html#cb134-5"></a><span class="co">## Rows: 210</span></span>
<span id="cb134-6"><a href="linear-mixed-effect-models-lmms.html#cb134-6"></a><span class="co">## Columns: 4</span></span>
<span id="cb134-7"><a href="linear-mixed-effect-models-lmms.html#cb134-7"></a><span class="co">## $ Animal    &lt;chr&gt; &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, &quot;Control1&quot;, …</span></span>
<span id="cb134-8"><a href="linear-mixed-effect-models-lmms.html#cb134-8"></a><span class="co">## $ Treatment &lt;fct&gt; Control, Control, Control, Control, Control, Control, Contro…</span></span>
<span id="cb134-9"><a href="linear-mixed-effect-models-lmms.html#cb134-9"></a><span class="co">## $ Time      &lt;fct&gt; 0, 5, 10, 15, 20, 25, 30, 0, 5, 10, 15, 20, 25, 30, 0, 5, 10…</span></span>
<span id="cb134-10"><a href="linear-mixed-effect-models-lmms.html#cb134-10"></a><span class="co">## $ Glucose   &lt;dbl&gt; 1.599, 1.279, 1.599, 1.579, 1.279, 1.439, 1.179, 0.840, 0.64…</span></span></code></pre></div>
<p>Below these data are plotted.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-157-2.png" width="672" /></p>
<div id="animal-as-a-random-effect-1" class="section level4 hasAnchor">
<h4><code>Animal</code> as a random effect<a href="linear-mixed-effect-models-lmms.html#animal-as-a-random-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Using <code>aov()</code></strong></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="linear-mixed-effect-models-lmms.html#cb135-1"></a>re_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Animal),<span class="dt">data =</span> liver)</span>
<span id="cb135-2"><a href="linear-mixed-effect-models-lmms.html#cb135-2"></a><span class="kw">summary</span>(re_aov)</span>
<span id="cb135-3"><a href="linear-mixed-effect-models-lmms.html#cb135-3"></a><span class="co">## </span></span>
<span id="cb135-4"><a href="linear-mixed-effect-models-lmms.html#cb135-4"></a><span class="co">## Error: Animal</span></span>
<span id="cb135-5"><a href="linear-mixed-effect-models-lmms.html#cb135-5"></a><span class="co">##           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb135-6"><a href="linear-mixed-effect-models-lmms.html#cb135-6"></a><span class="co">## Treatment  3   1.90  0.6335   1.407  0.263</span></span>
<span id="cb135-7"><a href="linear-mixed-effect-models-lmms.html#cb135-7"></a><span class="co">## Residuals 26  11.71  0.4503               </span></span>
<span id="cb135-8"><a href="linear-mixed-effect-models-lmms.html#cb135-8"></a><span class="co">## </span></span>
<span id="cb135-9"><a href="linear-mixed-effect-models-lmms.html#cb135-9"></a><span class="co">## Error: Within</span></span>
<span id="cb135-10"><a href="linear-mixed-effect-models-lmms.html#cb135-10"></a><span class="co">##                 Df Sum Sq Mean Sq F value       Pr(&gt;F)    </span></span>
<span id="cb135-11"><a href="linear-mixed-effect-models-lmms.html#cb135-11"></a><span class="co">## Time             6 0.7973 0.13289   8.732 0.0000000334 ***</span></span>
<span id="cb135-12"><a href="linear-mixed-effect-models-lmms.html#cb135-12"></a><span class="co">## Treatment:Time  18 0.2539 0.01411   0.927        0.547    </span></span>
<span id="cb135-13"><a href="linear-mixed-effect-models-lmms.html#cb135-13"></a><span class="co">## Residuals      156 2.3741 0.01522                         </span></span>
<span id="cb135-14"><a href="linear-mixed-effect-models-lmms.html#cb135-14"></a><span class="co">## ---</span></span>
<span id="cb135-15"><a href="linear-mixed-effect-models-lmms.html#cb135-15"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Using <code>lmer()</code> (from <code>lmerTest</code> and <code>lme4</code>)</strong></p>
<p>Recall that specifying the type of <span class="math inline">\(SS\)</span> (e.g., Type I, II, or III) in an <code>anova</code> call <strong>only</strong> works with a model fitted using <code>lmerTest::lmer</code>. As we now have specified an interaction model then the type of <span class="math inline">\(SS\)</span> calculated will have an effect on inference for unbalanced designs.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="linear-mixed-effect-models-lmms.html#cb136-1"></a>re_lmer &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal), <span class="dt">data =</span> liver)</span>
<span id="cb136-2"><a href="linear-mixed-effect-models-lmms.html#cb136-2"></a><span class="kw">anova</span>(re_lmer,<span class="dt">type =</span> <span class="dv">2</span>)</span>
<span id="cb136-3"><a href="linear-mixed-effect-models-lmms.html#cb136-3"></a><span class="co">## Type II Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb136-4"><a href="linear-mixed-effect-models-lmms.html#cb136-4"></a><span class="co">##                 Sum Sq  Mean Sq NumDF DenDF F value        Pr(&gt;F)    </span></span>
<span id="cb136-5"><a href="linear-mixed-effect-models-lmms.html#cb136-5"></a><span class="co">## Treatment      0.06423 0.021409     3    26  1.4068        0.2632    </span></span>
<span id="cb136-6"><a href="linear-mixed-effect-models-lmms.html#cb136-6"></a><span class="co">## Time           0.79731 0.132885     6   156  8.7318 0.00000003345 ***</span></span>
<span id="cb136-7"><a href="linear-mixed-effect-models-lmms.html#cb136-7"></a><span class="co">## Treatment:Time 0.25390 0.014105    18   156  0.9269        0.5474    </span></span>
<span id="cb136-8"><a href="linear-mixed-effect-models-lmms.html#cb136-8"></a><span class="co">## ---</span></span>
<span id="cb136-9"><a href="linear-mixed-effect-models-lmms.html#cb136-9"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Pairwise comparison of time means</strong></p>
<p>As above, when a design has blocking, to get summary stats using <code>predictmeans</code> you should fit the model using <code>lme4::lmer()</code>:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="linear-mixed-effect-models-lmms.html#cb137-1"></a>re_lmer4 &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(Glucose <span class="op">~</span><span class="st"> </span>Treatment<span class="op">*</span>Time <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Animal),<span class="dt">data =</span> liver) </span>
<span id="cb137-2"><a href="linear-mixed-effect-models-lmms.html#cb137-2"></a>predmeans &lt;-<span class="st"> </span><span class="kw">predictmeans</span>(<span class="dt">model =</span> re_lmer4 ,<span class="dt">modelterm =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb137-3"><a href="linear-mixed-effect-models-lmms.html#cb137-3"></a>                                        <span class="dt">pairwise =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-160-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-160-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-160-3.png" width="672" /></p>
<div class="alert alert-warning">
<p><strong>TASK</strong> What inference do you draw? You may also find the outputs from the code below useful.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="linear-mixed-effect-models-lmms.html#cb138-1"></a><span class="kw">comparisons</span>(predmeans)</span>
<span id="cb138-2"><a href="linear-mixed-effect-models-lmms.html#cb138-2"></a>em &lt;-<span class="st"> </span><span class="kw">emmeans</span>(re_lmer4, <span class="op">~</span>Treatment<span class="op">*</span>Time)</span>
<span id="cb138-3"><a href="linear-mixed-effect-models-lmms.html#cb138-3"></a><span class="kw">plot</span>(em, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Treatment)</span></code></pre></div>
</div>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="multiple-comparisons.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="module-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["BIOSCI738.html", "HTML"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
