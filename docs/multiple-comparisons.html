<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Multiple comparisons | Advanced Biological Data Analysis</title>
  <meta name="description" content="Multiple comparisons | Advanced Biological Data Analysis" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Multiple comparisons | Advanced Biological Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Multiple comparisons | Advanced Biological Data Analysis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelling-experimental-data.html"/>
<link rel="next" href="linear-mixed-effect-models-lmms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSCI 738: Advanced Biological Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Nau mai, haere mai. Welcome to BIOSCI 738</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html"><i class="fa fa-check"></i>Key Information</a>
<ul>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#course-policies"><i class="fa fa-check"></i>Course policies</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-1.html"><a href="module-1.html"><i class="fa fa-check"></i>Module 1</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><code>R</code> and <code>RStudio</code></a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#recap-r-terminology"><i class="fa fa-check"></i>Recap: <code>R</code> terminology</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#which-r-syntax"><i class="fa fa-check"></i>Which <code>R</code> syntax?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="error-handling-and-debugging.html"><a href="error-handling-and-debugging.html"><i class="fa fa-check"></i>Error handling and debugging</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html"><i class="fa fa-check"></i>Accuracy and Honesty</a>
<ul>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#good-coding-practice"><i class="fa fa-check"></i>Good coding practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html"><i class="fa fa-check"></i>Version control with <code>git</code> and GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#setting-up"><i class="fa fa-check"></i>Setting up</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#cloning-a-repository-from-github-using-rstudio"><i class="fa fa-check"></i>Cloning a repository from <code>GitHub</code> using <code>RStudio</code></a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#commiting-and-pushing-changes"><i class="fa fa-check"></i>Commiting and pushing changes</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#system-specific-hurdles"><i class="fa fa-check"></i>System specific hurdles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html"><i class="fa fa-check"></i>Respectful Handling of Data</a>
<ul>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#data-sovereignty"><i class="fa fa-check"></i>Data sovereignty</a></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#māori-data-sovereignty-principles"><i class="fa fa-check"></i>Māori Data Sovereignty principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html"><i class="fa fa-check"></i>Awareness of Consequences</a>
<ul>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html#case-study"><i class="fa fa-check"></i>Case study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i>Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#exploratory-plots-for-your-own-purposes"><i class="fa fa-check"></i>Exploratory plots (for your own purposes)</a></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#explanatory-plots"><i class="fa fa-check"></i>Explanatory plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-2.html"><a href="module-2.html"><i class="fa fa-check"></i>Module 2</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html"><i class="fa fa-check"></i>Permutation and randomisation tests</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html#a-permutation-test-jackal-mandible-lengths"><i class="fa fa-check"></i>A permutation test: Jackal mandible lengths</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html"><i class="fa fa-check"></i>Bootstrap resampling</a>
<ul>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html#example-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i>Example: constructing bootstrap confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html"><i class="fa fa-check"></i>Parametric hypothesis testing</a>
<ul>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#the-vocabulary-of-hypothesis-testing"><i class="fa fa-check"></i>The vocabulary of hypothesis testing</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#differences-between-two-means"><i class="fa fa-check"></i>Differences between two means</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#model-formula-syntax-in-r"><i class="fa fa-check"></i>Model formula syntax in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#some-mathematical-notation"><i class="fa fa-check"></i>Some mathematical notation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#modeling-bill-depth"><i class="fa fa-check"></i>Modeling Bill Depth</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#single-continuous-variable"><i class="fa fa-check"></i>Single continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#a-single-factor-variable"><i class="fa fa-check"></i>A single factor variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#one-factor-and-a-continuous-variable"><i class="fa fa-check"></i>One factor and a continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html"><i class="fa fa-check"></i>Model diagnostics for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html#marginal-predictions"><i class="fa fa-check"></i>Marginal predictions</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html#model-selection"><i class="fa fa-check"></i>Model selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html"><i class="fa fa-check"></i>Inference for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#point-prediction"><i class="fa fa-check"></i>Point prediction</a></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#confidence-intervals-for-parameters"><i class="fa fa-check"></i>Confidence intervals for parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-3.html"><a href="module-3.html"><i class="fa fa-check"></i>Module 3</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i>Introduction to the design and analysis of experiments</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i>Key phrases</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#the-three-key-principles"><i class="fa fa-check"></i>The three key principles:</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#replication"><i class="fa fa-check"></i>Replication</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#randomization"><i class="fa fa-check"></i>Randomization</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#blocking"><i class="fa fa-check"></i>Blocking</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#setting-up-an-experiment"><i class="fa fa-check"></i>Setting up an experiment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html"><i class="fa fa-check"></i>Some basic experimental designs</a>
<ul>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#completely-randomised-design-crd"><i class="fa fa-check"></i>Completely randomised design (CRD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#randomised-complete-block-design-rcbd"><i class="fa fa-check"></i>Randomised complete block design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#factorial-design"><i class="fa fa-check"></i>Factorial design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html"><i class="fa fa-check"></i>Modelling experimental data</a>
<ul>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-completely-randomised-design-crd-as-a-linear-model"><i class="fa fa-check"></i>A completely randomised design (CRD) as a linear model</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#analysis-of-a-crd-in-r"><i class="fa fa-check"></i>Analysis of a CRD in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-factorial-experiment-as-a-crd"><i class="fa fa-check"></i>A Factorial experiment (as a CRD)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#unqual-replications-unbalanced-design"><i class="fa fa-check"></i>Unqual replications (unbalanced design)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#sums-of-squares-ss"><i class="fa fa-check"></i>Sums of squares (<span class="math inline">\(SS\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i>Multiple comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#adjustments-for-multiple-testing"><i class="fa fa-check"></i>Adjustments for multiple testing</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests"><i class="fa fa-check"></i>Classification of multiple hypothesis tests</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-comparison-procedures"><i class="fa fa-check"></i>Multiple comparison procedures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html"><i class="fa fa-check"></i>Linear mixed-effect models (LMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-randomised-controlled-block-design-rcbd"><i class="fa fa-check"></i>A Randomised Controlled Block Design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-split-plot-design"><i class="fa fa-check"></i>A Split-plot design</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-repeated-measures-design"><i class="fa fa-check"></i>A repeated measures design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-4.html"><a href="module-4.html"><i class="fa fa-check"></i>Module 4</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-generalised-linear-models-glms.html"><a href="introduction-to-generalised-linear-models-glms.html"><i class="fa fa-check"></i>Introduction to generalised linear models (GLMs)</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i>Poisson regression</a>
<ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#an-example-bird-abundance"><i class="fa fa-check"></i>An example: bird abundance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#an-example-lobsters"><i class="fa fa-check"></i>An example: lobsters</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i>Model diagnostics</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#residuals"><i class="fa fa-check"></i>Residuals</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#the-quantile-residual-q-q-plot"><i class="fa fa-check"></i>The quantile residual Q-Q plot</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#deviance-using-the-chi-squared-approach"><i class="fa fa-check"></i>Deviance (using the chi-squared approach)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-summary-of-glms.html"><a href="a-summary-of-glms.html"><i class="fa fa-check"></i>A summary of GLMs</a></li>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html"><i class="fa fa-check"></i>Generalised linear mixed-effects models (GLMMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html#fitting-a-glmm"><i class="fa fa-check"></i>Fitting a GLMM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-5.html"><a href="module-5.html"><i class="fa fa-check"></i>Module 5</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i>Clustering</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#divisive-partitioning-methods."><i class="fa fa-check"></i>Divisive (partitioning) methods.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#k-means-an-example-using-the-palmerpenguins-data"><i class="fa fa-check"></i>K-means: an example using the <code>palmerpenguins</code> data</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-agglomerative-clustering."><i class="fa fa-check"></i>Hierarchical agglomerative clustering.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering-an-example"><i class="fa fa-check"></i>Hierarchical clustering: an example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i>Principal Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#examples-in-r"><i class="fa fa-check"></i>Examples in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i>Multidimensional Scaling (MDS)</a>
<ul>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#metric-scaling"><i class="fa fa-check"></i>Metric Scaling</a></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#correspondence-analysis-ca"><i class="fa fa-check"></i>Correspondence Analysis (CA)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html"><i class="fa fa-check"></i>Non-metric Multidimensional Scaling</a>
<ul>
<li class="chapter" data-level="" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#examples-in-r-2"><i class="fa fa-check"></i>Examples in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html"><i class="fa fa-check"></i>Linear Discriminant Analysis (LDA)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#example-in-r"><i class="fa fa-check"></i>Example in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-6.html"><a href="module-6.html"><i class="fa fa-check"></i>Module 6</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html"><i class="fa fa-check"></i>Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#some-basic-matrix-algebra"><i class="fa fa-check"></i>Some basic matrix algebra</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#linear-least-squares"><i class="fa fa-check"></i>Linear least squares</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#matrix-representation-of-a-crd"><i class="fa fa-check"></i>Matrix representation of a CRD</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#a-numeric-example"><i class="fa fa-check"></i>A numeric example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i>Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#differeniation-rules"><i class="fa fa-check"></i>Differeniation rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#logarithm-rules"><i class="fa fa-check"></i>Logarithm rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-binomial-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-crd"><i class="fa fa-check"></i>Maximum likelihood estimation for a CRD</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximising-the-log-likelihood"><i class="fa fa-check"></i>Maximising the log-likelihood</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-poisson-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Poisson distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-continuous-random-variable"><i class="fa fa-check"></i>Maximum likelihood estimation for a continuous random variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html"><i class="fa fa-check"></i>Introduction to Bayesian statistics</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#conditional-probability"><i class="fa fa-check"></i>Conditional probability</a></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#bayes-rule"><i class="fa fa-check"></i>Bayes’ rule</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://canvas.auckland.ac.nz/courses/103658">CANVAS</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-comparisons" class="section level2 hasAnchor">
<h2>Multiple comparisons<a href="multiple-comparisons.html#multiple-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall that <strong>each</strong> time we carry out a hypothesis test the probability we get a false positive result (type I error) is given by <span class="math inline">\(\alpha\)</span> (the <em>level of significance</em> we choose).</p>
<p>When we have <strong>multiple comparisons</strong> to make we should then control the <strong>Type I</strong> error rate across the entire <em>family</em> of tests under consideration, i.e., control the Family-Wise Error Rate (FWER); this ensures that the risk of making at least one <strong>Type I</strong> error among the family of comparisons in the experiment is <span class="math inline">\(\alpha\)</span>.</p>
<table>
<thead>
<tr class="header">
<th>State of Nature</th>
<th>Don’t reject <span class="math inline">\(H_0\)</span></th>
<th>reject <span class="math inline">\(H_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(H_0\)</span> is true</td>
<td>✅</td>
<td>Type I error</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_0\)</span> is false</td>
<td>Type II error</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>The <strong>familywise error rate (FWER)</strong> is the risk of making at least one <strong>Type I</strong> error among the family of comparisons in the experiment. Now let’s consider carrying out <span class="math inline">\(m\)</span> independent t-tests and let for any single test, let Pr(commit a Type 1 error) <span class="math inline">\(= \alpha_c\)</span> be the <strong>per comparison error rate (PCER)</strong>. So for a single test the probability a correct decision is made is <span class="math inline">\(1 - \alpha_c\)</span>. Therefore for <span class="math inline">\(m\)</span> <strong>independent</strong> t-tests the probability of committing no Type I errors is <span class="math inline">\((1 - \alpha_c)^m\)</span> and the probability of committing at least one Type I error is <span class="math inline">\(1 -(1 - \alpha_c)^m = \alpha_F\)</span> which is the upper limit of the FWER.</p>
<p>The <strong>False Discovery Rate (FDR)</strong> controls the expected (mean) proportion of false discoveries among the <span class="math inline">\(R\)</span> (out of <span class="math inline">\(m\)</span>) hypotheses declared significant.</p>
<p>Consider testing <span class="math inline">\(m\)</span> null hypotheses with corresponding p-values <span class="math inline">\(P_1, P_2,...,P_m\)</span>; we then order then so that <span class="math inline">\(P_{(1)} &lt; P_{(2)} &lt;...&lt;P_{(m)}\)</span> (where <span class="math inline">\(P_{(i)}\)</span> is the <span class="math inline">\(i^{th}\)</span> largest <span class="math inline">\(i=1,...,m\)</span>). The <span class="math inline">\(i^{th}\)</span> ordered p-value is calculated as <span class="math inline">\(\frac{i}{m}q^*\)</span> and the <span class="math inline">\(i^{th}\)</span> null hypothesis is rejected if <span class="math inline">\(P_i \leq \frac{i}{m}q^*\)</span></p>
<p><img src="_main_files/figure-html/alp-1.png" width="960" style="display: block; margin: auto;" /></p>
<div id="adjustments-for-multiple-testing" class="section level3 hasAnchor">
<h3>Adjustments for multiple testing<a href="multiple-comparisons.html#adjustments-for-multiple-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculating 95% confidence intervals for pairwise comparisons is similar to the procedure discussed in module 2:</p>
<p><span class="math display">\[\text{95% CI} = \text{estimate} \pm (\text{scale factor} \times \text{standard error}_\text{of estimate}).\]</span>
For the 95% CI for pairwise comparisons of means this becomes</p>
<p><span class="math display">\[\text{95% CI} = \text{difference} \pm (\text{scale factor} \times \text{SED}),\]</span>
where SED is the standard error of the difference (which depends on group replication). The choice of scale factor depends on what adjustments we might want to make. Below we cover three common adjustments. Specifically where (scale factor × SED) is the 1) Fisher correction LSD, 2) Bonferroni correction LSD, and 3) Tukey’s HSD.</p>
<div id="fishers-least-significant-difference-lsd" class="section level4 hasAnchor">
<h4>Fisher’s Least Significant Difference (LSD)<a href="multiple-comparisons.html#fishers-least-significant-difference-lsd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To calculate the LSD the <span class="math inline">\(t\)</span>-distribution is used, specifically the
<span class="math display">\[t_{\alpha = \frac{\alpha_c}{2}, \text{df} = N - m}\]</span> distribution, where <span class="math inline">\(N\)</span> is the number of observations and <span class="math inline">\(m\)</span> is the number of treatment groups. To obtain the critical value for <span class="math inline">\(\alpha_c = 0.05\)</span>, <span class="math inline">\(N = 12\)</span> and <span class="math inline">\(m = 3\)</span> the following code can be used in <code>R</code>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="multiple-comparisons.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-2"><a href="multiple-comparisons.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.262157</span></span></code></pre></div>
<p>Fisher’s LSD is then <span class="math display">\[t_{\alpha = \frac{\alpha_c}{2}, \text{df} = N - m} \times \text{SED}.\]</span></p>
<p>Here we carry out post-hoc tests only if the ANOVA F-test is <em>significant</em>. If so declare significant <span class="math inline">\(100\alpha\%\)</span> any pairwise difference &gt; LSD. This does <strong>not</strong> control the FWER.</p>
</div>
<div id="bonferroni-correction" class="section level4 hasAnchor">
<h4>Bonferroni correction<a href="multiple-comparisons.html#bonferroni-correction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To calculate Bonferroni correction the <span class="math inline">\(t\)</span>-distribution is used, specifically the
<span class="math display">\[t_{\alpha = \frac{\alpha_c}{2 \times k}, \text{df} = N - m}\]</span> distribution, where <span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(m\)</span> is the number of treatment groups, and <span class="math inline">\(k = {m \choose 2}\)</span> is the number of pairwise comparisons being made.</p>
<p>To obtain the critical value for <span class="math inline">\(\alpha_c = 0.05\)</span>, <span class="math inline">\(N = 12\)</span> and <span class="math inline">\(m = 3\)</span> the following code can be used in <code>R</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="multiple-comparisons.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.05</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">choose</span>(<span class="dv">3</span>,<span class="dv">2</span>)),<span class="at">df =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-2"><a href="multiple-comparisons.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.933324</span></span></code></pre></div>
<p>Bonferroni’s LSD is then <span class="math display">\[t_{\alpha = \frac{\alpha_c}{2 \times k}, \text{df} = N - m} \times \text{SED}.\]</span></p>
<p>Here we reject the <span class="math inline">\(H_0\)</span> for which the p-value, <em>p-val</em>, is <em>p-val</em> <span class="math inline">\(&lt; \alpha_c = \frac{\alpha_f}{n_c}\)</span> where <span class="math inline">\(\alpha_f\)</span> is the FWER and <span class="math inline">\(n_c\)</span> is the number of pairwise comparisons. However, this makes <strong>no</strong> assumptions about independence between tests.</p>
</div>
<div id="tukeys-honest-significant-difference-hsd" class="section level4 hasAnchor">
<h4>Tukey’s Honest Significant Difference (HSD)<a href="multiple-comparisons.html#tukeys-honest-significant-difference-hsd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This compares the mean of every treatment with the mean of every other treatment and uses a <em>studentised range</em> distribution compared with a <span class="math inline">\(t\)</span>-distribution for Fisher’s LSD and the Bonferroni correction. Therefore to calculate the HSD the <em>studentised range</em> distribution is used, specifically the <span class="math display">\[q_{ 1- \alpha_c, m, \text{df} = N - m}\]</span> distribution, where <span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(m\)</span> is the number of treatment groups, and <span class="math inline">\(q_{\alpha,m,\text{df}}\)</span> quantile of the studendised distribution.</p>
<p>To obtain the critical value for <span class="math inline">\(\alpha_c = 0.05\)</span>, <span class="math inline">\(N = 12\)</span> and <span class="math inline">\(m = 3\)</span> the following code can be used in <code>R</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="multiple-comparisons.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">qtukey</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">nmeans =</span> <span class="dv">3</span>, <span class="at">df =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="dv">3</span>)</span>
<span id="cb80-2"><a href="multiple-comparisons.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -2.948492</span></span></code></pre></div>
<p>Tukey’s HSD is given by <span class="math display">\[\frac{q_{ 1 - \alpha_c, m, \text{df} = N - m}}{\sqrt{2}} \times \sqrt{\frac{2\hat{\sigma}^2}{n}}.\]</span> Here <span class="math inline">\(\hat{\sigma}^2\)</span> is the residual mean square error and <span class="math inline">\(n\)</span> is the assumed equal number of replicates in each group.</p>
</div>
</div>
<div id="classification-of-multiple-hypothesis-tests" class="section level3 hasAnchor">
<h3>Classification of multiple hypothesis tests<a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have a number <span class="math inline">\(m\)</span> of null hypotheses, <span class="math inline">\(H_1, H_2, ..., H_m\)</span>. Using the traditional parlance we reject the null hypothesis if the test is declared significant and have no evidence to reject the null hypothesis if the test is “not significant”. Now, summing each type of outcome over all <span class="math inline">\(H_i (i = 1.,..,m)\)</span> yields the following random variables:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Null hypothesis is true (H0)</th>
<th>Alternative hypothesis is true (HA)</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Test is declared significant</td>
<td>V</td>
<td>S</td>
<td>R</td>
</tr>
<tr class="even">
<td>Test is declared non-significant</td>
<td>U</td>
<td>T</td>
<td>m - R</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(m_{0}\)</span></td>
<td><span class="math inline">\(m - m_0\)</span></td>
<td>m</td>
</tr>
</tbody>
</table>
<ul>
<li><span class="math inline">\(m\)</span> is the total number hypotheses tested</li>
<li><span class="math inline">\(m_{0}\)</span> is the number of true null hypotheses, an unknown parameter</li>
<li><span class="math inline">\(m - m_0\)</span> is the number of true alternative hypotheses</li>
<li><span class="math inline">\(V\)</span> is the number of false positives (<strong>Type I error</strong>) (also called <em>false discoveries</em>)</li>
<li><span class="math inline">\(S\)</span> is the number of true positives (also called <em>true discoveries</em>)</li>
<li><span class="math inline">\(T\)</span> is the number of false negatives (<strong>Type II error</strong>)</li>
<li><span class="math inline">\(U\)</span> is the number of true negatives</li>
<li><span class="math inline">\(R=V+S\)</span> is the number of rejected null hypotheses (also called <em>discoveries</em>, either true or false)</li>
</ul>
</div>
<div id="multiple-comparison-procedures" class="section level3 hasAnchor">
<h3>Multiple comparison procedures<a href="multiple-comparisons.html#multiple-comparison-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall the CRD <code>rats</code> data</p>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Surgery
</th>
<th style="text-align:right;">
Rat
</th>
<th style="text-align:right;">
logAUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8.49
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8.20
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9.08
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8.07
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10.24
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7.72
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9.34
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8.50
</td>
</tr>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11.31
</td>
</tr>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
12.69
</td>
</tr>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11.37
</td>
</tr>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10.82
</td>
</tr>
</tbody>
</table>
<p>You can read this data directly into <code>R</code> using</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="multiple-comparisons.html#cb81-1" aria-hidden="true" tabindex="-1"></a>rats <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/STATS-UOA/databunker/master/data/crd_rats_data.csv&quot;</span>)</span></code></pre></div>
<p>To use <code>predictmeans</code> later on we have to ensure that the relevant variables are coded as factors:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="multiple-comparisons.html#cb82-1" aria-hidden="true" tabindex="-1"></a>rats <span class="ot">&lt;-</span> rats <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="multiple-comparisons.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Surgery =</span> <span class="fu">as.factor</span>(Surgery))</span></code></pre></div>
<p>We can fit a linear model using <code>lm()</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="multiple-comparisons.html#cb83-1" aria-hidden="true" tabindex="-1"></a>rats_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(logAUC <span class="sc">~</span> Surgery, <span class="at">data =</span> rats)</span>
<span id="cb83-2"><a href="multiple-comparisons.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(rats_lm)</span>
<span id="cb83-3"><a href="multiple-comparisons.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)    SurgeryP    SurgeryS </span></span>
<span id="cb83-4"><a href="multiple-comparisons.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="do">##      8.4600      0.4900      3.0875</span></span></code></pre></div>
<p>Our fitted model is therefore</p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{\widehat{logAUC}} &amp;= 8.46 + 0.49(\operatorname{Surgery}_{\operatorname{P}}) + 3.09(\operatorname{Surgery}_{\operatorname{S}})
\end{aligned}
\]</span></p>
<p><strong>Using</strong> <code>predictmeans</code></p>
<p>By default Fisher’s comparisons are made.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="multiple-comparisons.html#cb84-1" aria-hidden="true" tabindex="-1"></a>pm <span class="ot">&lt;-</span> predictmeans<span class="sc">::</span><span class="fu">predictmeans</span>(rats_lm , <span class="at">modelterm =</span> <span class="st">&quot;Surgery&quot;</span>, </span>
<span id="cb84-2"><a href="multiple-comparisons.html#cb84-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-3"><a href="multiple-comparisons.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pm)</span>
<span id="cb84-4"><a href="multiple-comparisons.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="do">## List of 10</span></span>
<span id="cb84-5"><a href="multiple-comparisons.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Predicted Means              : &#39;xtabs&#39; num [1:3(1d)] 8.46 8.95 11.55</span></span>
<span id="cb84-6"><a href="multiple-comparisons.html#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;dimnames&quot;)=List of 1</span></span>
<span id="cb84-7"><a href="multiple-comparisons.html#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ Surgery: chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-8"><a href="multiple-comparisons.html#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;call&quot;)= language xtabs(formula = pm ~ ., data = mt[, c(&quot;pm&quot;, vars)], drop.unused.levels = TRUE)</span></span>
<span id="cb84-9"><a href="multiple-comparisons.html#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Standard Error of Means      : Named num 0.41</span></span>
<span id="cb84-10"><a href="multiple-comparisons.html#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;names&quot;)= chr &quot;All means have the same SE&quot;</span></span>
<span id="cb84-11"><a href="multiple-comparisons.html#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Standard Error of Differences: Named num [1:3] 0.58 0.58 0.58</span></span>
<span id="cb84-12"><a href="multiple-comparisons.html#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;Max.SED&quot; &quot;Min.SED&quot; &quot;Aveg.SED&quot;</span></span>
<span id="cb84-13"><a href="multiple-comparisons.html#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ LSD                          : Named num [1:3] 1.31 1.31 1.31</span></span>
<span id="cb84-14"><a href="multiple-comparisons.html#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;Max.LSD&quot; &quot;Min.LSD&quot; &quot;Aveg.LSD&quot;</span></span>
<span id="cb84-15"><a href="multiple-comparisons.html#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Significant level&quot;)= num 0.05</span></span>
<span id="cb84-16"><a href="multiple-comparisons.html#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Degree of freedom&quot;)= num 9</span></span>
<span id="cb84-17"><a href="multiple-comparisons.html#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Pairwise LSDs                : num [1:3, 1:3] 0 1.31 1.31 -0.49 0 ...</span></span>
<span id="cb84-18"><a href="multiple-comparisons.html#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb84-19"><a href="multiple-comparisons.html#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-20"><a href="multiple-comparisons.html#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-21"><a href="multiple-comparisons.html#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Significant level&quot;)= num 0.05</span></span>
<span id="cb84-22"><a href="multiple-comparisons.html#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Degree of freedom&quot;)= int 9</span></span>
<span id="cb84-23"><a href="multiple-comparisons.html#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Note&quot;)= chr &quot;LSDs matrix has mean differences (row-col) above the diagonal, LSDs (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span>
<span id="cb84-24"><a href="multiple-comparisons.html#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Pairwise p-value             : num [1:3, 1:3] 0 0.4202 0.0005 -0.8446 0 ...</span></span>
<span id="cb84-25"><a href="multiple-comparisons.html#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb84-26"><a href="multiple-comparisons.html#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-27"><a href="multiple-comparisons.html#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-28"><a href="multiple-comparisons.html#cb84-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Degree of freedom&quot;)= int 9</span></span>
<span id="cb84-29"><a href="multiple-comparisons.html#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;Note&quot;)= chr &quot;The matrix has t-value above the diagonal, p-value (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span>
<span id="cb84-30"><a href="multiple-comparisons.html#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ predictmeansPlot             :List of 2</span></span>
<span id="cb84-31"><a href="multiple-comparisons.html#cb84-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ : NULL</span></span>
<span id="cb84-32"><a href="multiple-comparisons.html#cb84-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ : NULL</span></span>
<span id="cb84-33"><a href="multiple-comparisons.html#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ predictmeansBarPlot          : NULL</span></span>
<span id="cb84-34"><a href="multiple-comparisons.html#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ mean_table                   :List of 2</span></span>
<span id="cb84-35"><a href="multiple-comparisons.html#cb84-35" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ Table:&#39;data.frame&#39;:    3 obs. of  7 variables:</span></span>
<span id="cb84-36"><a href="multiple-comparisons.html#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ Surgery  : Factor w/ 3 levels &quot;C&quot;,&quot;P&quot;,&quot;S&quot;: 1 2 3</span></span>
<span id="cb84-37"><a href="multiple-comparisons.html#cb84-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ Mean     : num [1:3] 8.46 8.95 11.55</span></span>
<span id="cb84-38"><a href="multiple-comparisons.html#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ SE       : num [1:3] 0.41 0.41 0.41</span></span>
<span id="cb84-39"><a href="multiple-comparisons.html#cb84-39" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ Df       : int [1:3] 9 9 9</span></span>
<span id="cb84-40"><a href="multiple-comparisons.html#cb84-40" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ LL(95%)  : num [1:3] 7.53 8.02 10.62</span></span>
<span id="cb84-41"><a href="multiple-comparisons.html#cb84-41" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ UL(95%)  : num [1:3] 9.39 9.88 12.48</span></span>
<span id="cb84-42"><a href="multiple-comparisons.html#cb84-42" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ LetterGrp: chr [1:3] &quot;A &quot; &quot;A &quot; &quot; B&quot;</span></span>
<span id="cb84-43"><a href="multiple-comparisons.html#cb84-43" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ Note : chr &quot;Letter-based representation of pairwise comparisons at significant level &#39;0.05&#39;&quot;</span></span>
<span id="cb84-44"><a href="multiple-comparisons.html#cb84-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ p_valueMatrix                : num [1:3, 1:3] 0 0.4202 0.0005 0 0 ...</span></span>
<span id="cb84-45"><a href="multiple-comparisons.html#cb84-45" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb84-46"><a href="multiple-comparisons.html#cb84-46" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-47"><a href="multiple-comparisons.html#cb84-47" aria-hidden="true" tabindex="-1"></a><span class="do">##   .. ..$ : chr [1:3] &quot;C&quot; &quot;P&quot; &quot;S&quot;</span></span>
<span id="cb84-48"><a href="multiple-comparisons.html#cb84-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  - attr(*, &quot;class&quot;)= chr &quot;pdmlist&quot;</span></span></code></pre></div>
<p>Let’s look at some of the <code>pm</code> elements more closely:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="multiple-comparisons.html#cb85-1" aria-hidden="true" tabindex="-1"></a>pm<span class="sc">$</span>mean_table</span>
<span id="cb85-2"><a href="multiple-comparisons.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="do">## $Table</span></span>
<span id="cb85-3"><a href="multiple-comparisons.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Surgery    Mean      SE Df LL(95%) UL(95%) LetterGrp</span></span>
<span id="cb85-4"><a href="multiple-comparisons.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       C  8.4600 0.41025  9  7.5319  9.3881        A </span></span>
<span id="cb85-5"><a href="multiple-comparisons.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       P  8.9500 0.41025  9  8.0219  9.8781        A </span></span>
<span id="cb85-6"><a href="multiple-comparisons.html#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       S 11.5475 0.41025  9 10.6194 12.4756         B</span></span>
<span id="cb85-7"><a href="multiple-comparisons.html#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb85-8"><a href="multiple-comparisons.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="do">## $Note</span></span>
<span id="cb85-9"><a href="multiple-comparisons.html#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Letter-based representation of pairwise comparisons at significant level &#39;0.05&#39;&quot;</span></span></code></pre></div>
<p>This gives us the estimated group means and associated 95% CIs. Why are the standard errors all equal?</p>
<p>But, what we’d like is the pairwise comparisons between groups. Information pertaining to this is also returned:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="multiple-comparisons.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pm<span class="sc">$</span><span class="st">`</span><span class="at">Pairwise p-value</span><span class="st">`</span>)</span>
<span id="cb86-2"><a href="multiple-comparisons.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">##        C       P       S</span></span>
<span id="cb86-3"><a href="multiple-comparisons.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="do">## C 0.0000 -0.8446 -5.3216</span></span>
<span id="cb86-4"><a href="multiple-comparisons.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="do">## P 0.4202  0.0000 -4.4770</span></span>
<span id="cb86-5"><a href="multiple-comparisons.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="do">## S 0.0005  0.0015  0.0000</span></span>
<span id="cb86-6"><a href="multiple-comparisons.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;Degree of freedom&quot;)</span></span>
<span id="cb86-7"><a href="multiple-comparisons.html#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 9</span></span>
<span id="cb86-8"><a href="multiple-comparisons.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;Note&quot;)</span></span>
<span id="cb86-9"><a href="multiple-comparisons.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;The matrix has t-value above the diagonal, p-value (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span></code></pre></div>
<p>This gives us the pairwise comparison statistic (the <span class="math inline">\(t\)</span>-statistic in this case) on the upper diagonal and the associated p-value’s on the lower diagonal.</p>
<p>What about the 95%CI for the comparisons? Luckily <code>predictmeans</code> also returns the pairwise LSD values (Fisher’s by default with <span class="math inline">\(\alpha_c = 0.05\)</span>):</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="multiple-comparisons.html#cb87-1" aria-hidden="true" tabindex="-1"></a>pm<span class="sc">$</span><span class="st">`</span><span class="at">Pairwise LSDs</span><span class="st">`</span></span>
<span id="cb87-2"><a href="multiple-comparisons.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="do">##         C        P       S</span></span>
<span id="cb87-3"><a href="multiple-comparisons.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="do">## C 0.00000 -0.49000 -3.0875</span></span>
<span id="cb87-4"><a href="multiple-comparisons.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="do">## P 1.31247  0.00000 -2.5975</span></span>
<span id="cb87-5"><a href="multiple-comparisons.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="do">## S 1.31247  1.31247  0.0000</span></span>
<span id="cb87-6"><a href="multiple-comparisons.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;Significant level&quot;)</span></span>
<span id="cb87-7"><a href="multiple-comparisons.html#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.05</span></span>
<span id="cb87-8"><a href="multiple-comparisons.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;Degree of freedom&quot;)</span></span>
<span id="cb87-9"><a href="multiple-comparisons.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 9</span></span>
<span id="cb87-10"><a href="multiple-comparisons.html#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;Note&quot;)</span></span>
<span id="cb87-11"><a href="multiple-comparisons.html#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;LSDs matrix has mean differences (row-col) above the diagonal, LSDs (adjusted by &#39;none&#39; method) below the diagonal&quot;</span></span></code></pre></div>
<p>Here, the upper diagonal matrix has the pairwise differences and the lower has the LSD values.</p>
<div id="fishers-lsd" class="section level4 hasAnchor">
<h4>Fisher’s LSD<a href="multiple-comparisons.html#fishers-lsd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So, we have all the information to construct the Fisher LSD 95% CIs! You could extract all the information and construct a pairwise comparison table manually, or use a pre-written function (aren’t I nice to provide one!):</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="multiple-comparisons.html#cb88-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://gist.github.com/cmjt/72f3941533a6bdad0701928cc2924b90&quot;</span></span>
<span id="cb88-2"><a href="multiple-comparisons.html#cb88-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">source_gist</span>(url, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="multiple-comparisons.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">comparisons</span>(pm)</span>
<span id="cb88-4"><a href="multiple-comparisons.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Comparison Difference  SED   LSD    lwr    upr      t      p</span></span>
<span id="cb88-5"><a href="multiple-comparisons.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        C-P     -0.490 0.58 1.312 -1.802  0.822 -0.845 0.4202</span></span>
<span id="cb88-6"><a href="multiple-comparisons.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        C-S     -3.087 0.58 1.312 -4.400 -1.775 -5.322 0.0005</span></span>
<span id="cb88-7"><a href="multiple-comparisons.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        P-S     -2.598 0.58 1.312 -3.910 -1.285 -4.477 0.0015</span></span></code></pre></div>
</div>
<div id="bonferroni-correction-1" class="section level4 hasAnchor">
<h4>Bonferroni correction<a href="multiple-comparisons.html#bonferroni-correction-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To use the Bonferroni correction we must now calculate and specify the adjusted <span class="math inline">\(\alpha_b = \frac{\alpha_b}{n_c}\)</span>, in our case this is <span class="math inline">\(\frac{0.05}{{3 \choose 2}}\)</span>. We also specify <code>adj = "bonferroni"</code>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="multiple-comparisons.html#cb89-1" aria-hidden="true" tabindex="-1"></a>alpha.adj <span class="ot">&lt;-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="fu">choose</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb89-2"><a href="multiple-comparisons.html#cb89-2" aria-hidden="true" tabindex="-1"></a>bonferroni <span class="ot">&lt;-</span>  predictmeans<span class="sc">::</span><span class="fu">predictmeans</span>(rats_lm , </span>
<span id="cb89-3"><a href="multiple-comparisons.html#cb89-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">modelterm =</span> <span class="st">&quot;Surgery&quot;</span>, <span class="at">adj =</span> <span class="st">&quot;bonferroni&quot;</span>,</span>
<span id="cb89-4"><a href="multiple-comparisons.html#cb89-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">level =</span> alpha.adj,</span>
<span id="cb89-5"><a href="multiple-comparisons.html#cb89-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-6"><a href="multiple-comparisons.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">comparisons</span>(bonferroni)</span></code></pre></div>
</div>
<div id="tukeys-honest-significant-difference-hsd-1" class="section level4 hasAnchor">
<h4>Tukey’s Honest Significant Difference (HSD)<a href="multiple-comparisons.html#tukeys-honest-significant-difference-hsd-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Things are a bit more cumbersome when it comes to Tukey’s HSD. We can specify <code>adj = "tukey"</code> in <code>predictmeans</code>:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="multiple-comparisons.html#cb90-1" aria-hidden="true" tabindex="-1"></a>tukey <span class="ot">&lt;-</span>  predictmeans<span class="sc">::</span><span class="fu">predictmeans</span>(rats_lm , </span>
<span id="cb90-2"><a href="multiple-comparisons.html#cb90-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">modelterm =</span> <span class="st">&quot;Surgery&quot;</span>, <span class="at">adj =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb90-3"><a href="multiple-comparisons.html#cb90-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">level =</span> alpha.adj,</span>
<span id="cb90-4"><a href="multiple-comparisons.html#cb90-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-5"><a href="multiple-comparisons.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tukey)</span></code></pre></div>
<p>However, the HSD values are not returned, so we cannot calculate out pairwise CIs. <code>R</code> has an inbuilt function <code>TukeyHSD</code> that does this for us, but as we can see below the HSD values are not returned.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="multiple-comparisons.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(logAUC<span class="sc">~</span>Surgery, <span class="at">data =</span> rats))</span>
<span id="cb91-2"><a href="multiple-comparisons.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tukey multiple comparisons of means</span></span>
<span id="cb91-3"><a href="multiple-comparisons.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     95% family-wise confidence level</span></span>
<span id="cb91-4"><a href="multiple-comparisons.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb91-5"><a href="multiple-comparisons.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: aov(formula = logAUC ~ Surgery, data = rats)</span></span>
<span id="cb91-6"><a href="multiple-comparisons.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb91-7"><a href="multiple-comparisons.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $Surgery</span></span>
<span id="cb91-8"><a href="multiple-comparisons.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       diff        lwr      upr     p adj</span></span>
<span id="cb91-9"><a href="multiple-comparisons.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="do">## P-C 0.4900 -1.1298813 2.109881 0.6863267</span></span>
<span id="cb91-10"><a href="multiple-comparisons.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="do">## S-C 3.0875  1.4676187 4.707381 0.0012479</span></span>
<span id="cb91-11"><a href="multiple-comparisons.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="do">## S-P 2.5975  0.9776187 4.217381 0.0039400</span></span></code></pre></div>
<p>From above we saw that Tukey’s HSD was given by</p>
<p><span class="math display">\[\frac{q_{1-\alpha_c, m, \text{df} = N - m}}{\sqrt{2}} \times \sqrt{\frac{2\hat{\sigma}^2}{n}}.\]</span></p>
<p>We can calculate <span class="math inline">\(q_{1 - \alpha_c, m, \text{df} = N - m}\)</span> for our data using</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="multiple-comparisons.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtukey</span>(<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">nmeans =</span> <span class="dv">3</span>, <span class="at">df =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="dv">3</span>)</span>
<span id="cb92-2"><a href="multiple-comparisons.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.948492</span></span></code></pre></div>
<p>Assuming equal replicates (<span class="math inline">\(n = 4\)</span>, with <span class="math inline">\(\hat{\sigma}^2\)</span> as above) we calculate the SED as</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="multiple-comparisons.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">anova</span>(rats_lm)[<span class="dv">2</span>,<span class="dv">3</span>] <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb93-2"><a href="multiple-comparisons.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5801856</span></span></code></pre></div>
<p>Therefore, Tukey’s HSD is <span class="math inline">\(\frac{3.9484922}{\sqrt{2}}\times 0.5801856 = 1.6198813.\)</span></p>
<p>To calculate the CIs we use <span class="math inline">\(\text{difference} \pm \text{HSD}\)</span>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="multiple-comparisons.html#cb94-1" aria-hidden="true" tabindex="-1"></a>HSD <span class="ot">&lt;-</span> (<span class="fu">qtukey</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">nmeans =</span> <span class="dv">3</span>, <span class="at">df =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="dv">3</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">anova</span>(rats_lm)[<span class="dv">2</span>,<span class="dv">3</span>] <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb94-2"><a href="multiple-comparisons.html#cb94-2" aria-hidden="true" tabindex="-1"></a>all_diffs <span class="ot">&lt;-</span> <span class="fu">outer</span>(tukey<span class="sc">$</span><span class="st">`</span><span class="at">Predicted Means</span><span class="st">`</span>, tukey<span class="sc">$</span><span class="st">`</span><span class="at">Predicted Means</span><span class="st">`</span>, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb94-3"><a href="multiple-comparisons.html#cb94-3" aria-hidden="true" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">differences =</span> all_diffs[<span class="fu">lower.tri</span>(all_diffs)]) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="multiple-comparisons.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">upper =</span> differences <span class="sc">+</span> HSD, <span class="at">lower =</span> differences <span class="sc">-</span> HSD, <span class="at">HSD =</span> HSD)</span>
<span id="cb94-5"><a href="multiple-comparisons.html#cb94-5" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb94-6"><a href="multiple-comparisons.html#cb94-6" aria-hidden="true" tabindex="-1"></a>comparison_table</span></code></pre></div>
<p>This matches the output from <code>TukeyHSD()</code> above!</p>
<p>What about the values returned by <code>predictmeans()</code>?</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="multiple-comparisons.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey<span class="sc">$</span><span class="st">`</span><span class="at">Pairwise p-value</span><span class="st">`</span>)</span></code></pre></div>
<p>There is an easier way to see the same pairwise contrasts using the <code>emmeans</code> function from the package of the same name and the <code>pairs</code> function:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="multiple-comparisons.html#cb96-1" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(rats_lm, <span class="at">specs =</span>  <span class="st">&quot;Surgery&quot;</span>)</span>
<span id="cb96-2"><a href="multiple-comparisons.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(em, <span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>)</span>
<span id="cb96-3"><a href="multiple-comparisons.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast estimate   SE df t.ratio p.value</span></span>
<span id="cb96-4"><a href="multiple-comparisons.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  C - P       -0.49 0.58  9  -0.845  0.6863</span></span>
<span id="cb96-5"><a href="multiple-comparisons.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  C - S       -3.09 0.58  9  -5.322  0.0012</span></span>
<span id="cb96-6"><a href="multiple-comparisons.html#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  P - S       -2.60 0.58  9  -4.477  0.0039</span></span>
<span id="cb96-7"><a href="multiple-comparisons.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb96-8"><a href="multiple-comparisons.html#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 3 estimates</span></span></code></pre></div>
<p>This, gives us the same information as <code>predictmeans</code> but in an easier to read format (still no CIs though, we still have to calculate those ourselves!)</p>
<p>However, the <code>emmeans</code>package facilitates some nice plotting of the pairwise comparisons:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="multiple-comparisons.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(em, <span class="at">comparisons =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelling-experimental-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effect-models-lmms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["BIOSCI738.html", "HTML"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
