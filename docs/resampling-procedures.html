<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Resampling Procedures | bluebook BIOSCI738</title>
  <meta name="description" content="11 Resampling Procedures | bluebook BIOSCI738" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Resampling Procedures | bluebook BIOSCI738" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Resampling Procedures | bluebook BIOSCI738" />
  
  
  

<meta name="author" content="Charlotte Jones-Todd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-inference.html"/>
<link rel="next" href="multivariate-data-methods.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="src/my-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#course-overview"><i class="fa fa-check"></i><b>0.1</b> Course Overview</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#key-topics"><i class="fa fa-check"></i><b>0.2</b> Key Topics</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html"><i class="fa fa-check"></i><b>1</b> <code>R</code>, <code>RStudio</code>, and <code>git</code></a><ul>
<li class="chapter" data-level="1.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#intro-to-r-rstudio"><i class="fa fa-check"></i><b>1.2</b> Intro to <code>R</code> &amp; <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#why"><i class="fa fa-check"></i><b>1.2.1</b> Why?</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#r-errors"><i class="fa fa-check"></i><b>1.3.1</b> R errors 😱</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#r-scripts-a-.r-file"><i class="fa fa-check"></i><b>1.3.2</b> R <em>Script</em>s (a <code>.r</code> file)</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#writing-comments"><i class="fa fa-check"></i><b>1.3.3</b> Writing <em>Comments</em></a></li>
<li class="chapter" data-level="1.3.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#change-the-rstudio-appearance-up-to-your-taste"><i class="fa fa-check"></i><b>1.3.4</b> Change the <code>RStudio</code> appearance up to your taste</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#reproducible-research"><i class="fa fa-check"></i><b>1.4</b> Reproducible research</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#good-practice"><i class="fa fa-check"></i><b>1.4.1</b> Good practice</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#version-control-with-git-and-github"><i class="fa fa-check"></i><b>1.5</b> Version control with <code>git</code> and GitHub</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#setup-tldr"><i class="fa fa-check"></i><b>1.5.1</b> Setup TL;DR</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#cloning-a-repository-from-github-using-rstudio"><i class="fa fa-check"></i><b>1.5.2</b> Cloning a repository from <code>GitHub</code> using <code>RStudio</code></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.6</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#starting-out-with-tidyverse"><i class="fa fa-check"></i><b>1.6.1</b> Starting out with <code>tidyverse</code></a></li>
<li class="chapter" data-level="1.6.2" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#reading-in-data-from-a-.csv-file"><i class="fa fa-check"></i><b>1.6.2</b> Reading in data from a <code>.csv</code> file</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#explore-your-data"><i class="fa fa-check"></i><b>1.6.3</b> Explore your data</a></li>
<li class="chapter" data-level="1.6.4" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#explore-your-data-1"><i class="fa fa-check"></i><b>1.6.4</b> Explore your data</a></li>
<li class="chapter" data-level="1.6.5" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#the-pipe-operator"><i class="fa fa-check"></i><b>1.6.5</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-rstudio-and-git.html"><a href="r-rstudio-and-git.html#other-resources"><i class="fa fa-check"></i><b>1.7</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html"><i class="fa fa-check"></i><b>2</b> Māori Data Sovereignty principles</a><ul>
<li class="chapter" data-level="2.1" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#māori-data-sovereignty-principles-1"><i class="fa fa-check"></i><b>2.2</b> Māori Data Sovereignty principles</a></li>
<li class="chapter" data-level="2.3" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#māori-data-sovereignty-principles-2"><i class="fa fa-check"></i><b>2.3</b> Māori Data Sovereignty principles</a></li>
<li class="chapter" data-level="2.4" data-path="māori-data-sovereignty-principles.html"><a href="māori-data-sovereignty-principles.html#resources"><i class="fa fa-check"></i><b>2.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html"><i class="fa fa-check"></i><b>3</b> Data wrangling and vizualisation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#common-dataframe-manipulations-in-the-tidyverse"><i class="fa fa-check"></i><b>3.2</b> Common dataframe manipulations in the <code>tidyverse</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.2.1</b> Using <code>dplyr</code> and <code>tidyr</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#introuducing-the-palmer-penguins"><i class="fa fa-check"></i><b>3.2.2</b> Introuducing the <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">Palmer penguins</a></a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#common-dataframe-manipulations-in-the-tidyverse-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.2.3</b> Common dataframe manipulations in the <code>tidyverse</code>, using <code>dplyr</code> and <code>tidyr</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#data-viz"><i class="fa fa-check"></i><b>3.3</b> Data Viz</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#exploratory-and-explanatory-plots"><i class="fa fa-check"></i><b>3.3.1</b> Exploratory and explanatory plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ten-simple-rules-for-better-figures"><i class="fa fa-check"></i><b>3.4</b> Ten Simple Rules for Better Figures</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ggplot2"><i class="fa fa-check"></i><b>3.5</b> <code>ggplot2</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#ggplot2-layers"><i class="fa fa-check"></i><b>3.5.1</b> <code>ggplot2</code> layers</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#examples"><i class="fa fa-check"></i><b>3.5.2</b> Examples</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#the-good-the-bad-and-the-ugly..."><i class="fa fa-check"></i><b>3.5.3</b> The Good, the Bad, and the Ugly...</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-and-vizualisation.html"><a href="data-wrangling-and-vizualisation.html#resources-1"><i class="fa fa-check"></i><b>3.6</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>4</b> Introduction to the design and analysis of experiments</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i><b>4.2</b> Key phrases</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#three-key-principles"><i class="fa fa-check"></i><b>4.3</b> Three key principles:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#replication"><i class="fa fa-check"></i><b>4.3.1</b> <strong>Replication</strong></a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#randomization"><i class="fa fa-check"></i><b>4.3.2</b> <strong>Randomization</strong></a></li>
<li class="chapter" data-level="4.3.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#blocking"><i class="fa fa-check"></i><b>4.3.3</b> <strong>Blocking</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>4.4</b> One-Way <strong>An</strong>alysis <strong>o</strong>f <strong>Va</strong>riance (ANOVA)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#between-group-ss-ssb"><i class="fa fa-check"></i><b>4.4.1</b> Between group SS (SSB)</a></li>
<li class="chapter" data-level="4.4.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#within-group-ss-ssw"><i class="fa fa-check"></i><b>4.4.2</b> Within group SS (SSW)</a></li>
<li class="chapter" data-level="4.4.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#f-statistic"><i class="fa fa-check"></i><b>4.4.3</b> F-statistic</a></li>
<li class="chapter" data-level="4.4.4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#degrees-of-freedom-df"><i class="fa fa-check"></i><b>4.4.4</b> Degrees of freedom (DF)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#p-values"><i class="fa fa-check"></i><b>4.5</b> 😱 p-values 😱</a></li>
<li class="chapter" data-level="4.6" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#terminology-and-issues"><i class="fa fa-check"></i><b>4.6</b> Terminology and issues</a></li>
<li class="chapter" data-level="4.7" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#resources-2"><i class="fa fa-check"></i><b>4.7</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html"><i class="fa fa-check"></i><b>5</b> A completely randomomised design</a><ul>
<li class="chapter" data-level="5.1" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#learning-objectives-4"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#analysis-of-a-completely-randomised-design-in-r-aov-and-lm"><i class="fa fa-check"></i><b>5.2</b> Analysis of a Completely Randomised Design in <code>R</code>: <code>aov()</code> and <code>lm()</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#aov"><i class="fa fa-check"></i><b>5.2.1</b> <code>aov()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="a-completely-randomomised-design.html"><a href="a-completely-randomomised-design.html#lm"><i class="fa fa-check"></i><b>5.2.2</b> <code>lm()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i><b>6</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#learning-objectives-5"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#adjustments-for-multiple-testing"><i class="fa fa-check"></i><b>6.2</b> Adjustments for multiple testing</a><ul>
<li class="chapter" data-level="6.2.1" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests"><i class="fa fa-check"></i><b>6.2.1</b> Classification of multiple hypothesis tests</a></li>
<li class="chapter" data-level="6.2.2" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#using-the-predictmeans-package"><i class="fa fa-check"></i><b>6.2.2</b> Using the <code>predictmeans</code> package</a></li>
<li class="chapter" data-level="6.2.3" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-comparison-procedures"><i class="fa fa-check"></i><b>6.2.3</b> Multiple comparison procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="factorial-experiments.html"><a href="factorial-experiments.html"><i class="fa fa-check"></i><b>7</b> Factorial experiments</a><ul>
<li class="chapter" data-level="7.1" data-path="factorial-experiments.html"><a href="factorial-experiments.html#learning-objectives-6"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="factorial-experiments.html"><a href="factorial-experiments.html#factorial-design-as-a-crd"><i class="fa fa-check"></i><b>7.2</b> Factorial design (as a CRD)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="factorial-experiments.html"><a href="factorial-experiments.html#equal-replications-balanced-design"><i class="fa fa-check"></i><b>7.2.1</b> Equal replications (balanced design)</a></li>
<li class="chapter" data-level="7.2.2" data-path="factorial-experiments.html"><a href="factorial-experiments.html#unqual-replications-unbalanced-design"><i class="fa fa-check"></i><b>7.2.2</b> Unqual replications (unbalanced design)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="factorial-experiments.html"><a href="factorial-experiments.html#tldr-model-formula-syntax-in-r"><i class="fa fa-check"></i><b>7.3</b> TL;DR, Model formula syntax in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html"><i class="fa fa-check"></i><b>8</b> Blocking: incorporating into design and analysis of</a><ul>
<li class="chapter" data-level="8.1" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#learning-objectives-7"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#blocking-1"><i class="fa fa-check"></i><b>8.2</b> Blocking</a></li>
<li class="chapter" data-level="8.3" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#a-randomised-controlled-block-design-rcbd"><i class="fa fa-check"></i><b>8.3</b> A Randomised Controlled Block Design (RCBD)</a></li>
<li class="chapter" data-level="8.4" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#fixed-or-random"><i class="fa fa-check"></i><b>8.4</b> Fixed or Random???</a><ul>
<li class="chapter" data-level="8.4.1" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#ignoring-an-effect"><i class="fa fa-check"></i><b>8.4.1</b> Ignoring an effect</a></li>
<li class="chapter" data-level="8.4.2" data-path="blocking-incorporating-into-design-and-analysis-of.html"><a href="blocking-incorporating-into-design-and-analysis-of.html#analysis-using-lmer-from-lme4"><i class="fa fa-check"></i><b>8.4.2</b> Analysis using <code>lmer()</code> from <code>lme4</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html"><i class="fa fa-check"></i><b>9</b> Split-plot and repeated measures designs</a><ul>
<li class="chapter" data-level="9.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#learning-objectives-8"><i class="fa fa-check"></i><b>9.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#analysis-of-a-split-plot-design"><i class="fa fa-check"></i><b>9.2</b> Analysis of a split-plot design</a><ul>
<li class="chapter" data-level="9.2.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-aov"><i class="fa fa-check"></i><b>9.2.1</b> Using <code>aov()</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-lmer-from-lmetest-and-lmer4-and-predictmeans"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>lmer()</code> (from <code>lmeTest</code> and <code>lmer4</code>) and <code>predictmeans()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#analysis-of-a-repeated-measures-design"><i class="fa fa-check"></i><b>9.3</b> Analysis of a repeated measures design</a><ul>
<li class="chapter" data-level="9.3.1" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#the-data"><i class="fa fa-check"></i><b>9.3.1</b> The data</a></li>
<li class="chapter" data-level="9.3.2" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#visualise"><i class="fa fa-check"></i><b>9.3.2</b> Visualise</a></li>
<li class="chapter" data-level="9.3.3" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-aov-1"><i class="fa fa-check"></i><b>9.3.3</b> Using <code>aov()</code></a></li>
<li class="chapter" data-level="9.3.4" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#using-lmer-from-lmertest-and-lme4-and-predictmeans"><i class="fa fa-check"></i><b>9.3.4</b> Using <code>lmer()</code> (from <code>lmerTest</code> and <code>lme4</code>) and <code>predictmeans()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="split-plot-and-repeated-measures-designs.html"><a href="split-plot-and-repeated-measures-designs.html#repeated-measures-designs-as-split-plots-in-time"><i class="fa fa-check"></i><b>9.4</b> Repeated measures designs as <em>split-plots in time</em></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>10</b> Statistical Inference</a><ul>
<li class="chapter" data-level="10.1" data-path="statistical-inference.html"><a href="statistical-inference.html#learning-objectives-9"><i class="fa fa-check"></i><b>10.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="statistical-inference.html"><a href="statistical-inference.html#regression"><i class="fa fa-check"></i><b>10.2</b> Regression</a><ul>
<li class="chapter" data-level="10.2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#some-mathematical-notation"><i class="fa fa-check"></i><b>10.2.1</b> Some mathematical notation</a></li>
<li class="chapter" data-level="10.2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#modeling-bill-depth"><i class="fa fa-check"></i><b>10.2.2</b> Modeling Bill Depth</a></li>
<li class="chapter" data-level="10.2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#single-continuous-variable"><i class="fa fa-check"></i><b>10.2.3</b> Single continuous variable</a></li>
<li class="chapter" data-level="10.2.4" data-path="statistical-inference.html"><a href="statistical-inference.html#factor-and-a-continous-variable"><i class="fa fa-check"></i><b>10.2.4</b> Factor and a continous variable</a></li>
<li class="chapter" data-level="10.2.5" data-path="statistical-inference.html"><a href="statistical-inference.html#interactions"><i class="fa fa-check"></i><b>10.2.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-selection-and-checking-again"><i class="fa fa-check"></i><b>10.3</b> Model, comparison, selection, and checking (again)</a><ul>
<li class="chapter" data-level="10.3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-and-selection"><i class="fa fa-check"></i><b>10.3.1</b> Model comparison and selection</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="statistical-inference.html"><a href="statistical-inference.html#point-predictions-and-confidence-intervals"><i class="fa fa-check"></i><b>10.4</b> Point predictions and confidence intervals</a><ul>
<li class="chapter" data-level="10.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-for-parameters"><i class="fa fa-check"></i><b>10.4.1</b> Confidence intervals for parameters</a></li>
<li class="chapter" data-level="10.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#point-prediction"><i class="fa fa-check"></i><b>10.4.2</b> Point prediction</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="statistical-inference.html"><a href="statistical-inference.html#tldr-lm"><i class="fa fa-check"></i><b>10.5</b> TL;DR <code>lm()</code></a><ul>
<li class="chapter" data-level="10.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#model-formula-syntax"><i class="fa fa-check"></i><b>10.5.1</b> <strong>Model formula</strong> syntax</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="statistical-inference.html"><a href="statistical-inference.html#other-resources-optional-but-recommended"><i class="fa fa-check"></i><b>10.6</b> Other resources: optional but recommended</a></li>
<li class="chapter" data-level="10.7" data-path="statistical-inference.html"><a href="statistical-inference.html#beyond-linear-models-to-generalised-linear-models-glms-not-examinable"><i class="fa fa-check"></i><b>10.7</b> Beyond Linear Models to Generalised Linear Models (GLMs) (<em>not examinable</em>)</a><ul>
<li class="chapter" data-level="10.7.1" data-path="statistical-inference.html"><a href="statistical-inference.html#counting-animals..."><i class="fa fa-check"></i><b>10.7.1</b> Counting animals...</a></li>
<li class="chapter" data-level="10.7.2" data-path="statistical-inference.html"><a href="statistical-inference.html#other-modelling-approaches-not-examinable"><i class="fa fa-check"></i><b>10.7.2</b> Other modelling approaches (not examinable)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="resampling-procedures.html"><a href="resampling-procedures.html"><i class="fa fa-check"></i><b>11</b> Resampling Procedures</a><ul>
<li class="chapter" data-level="11.1" data-path="resampling-procedures.html"><a href="resampling-procedures.html#learning-objectives-10"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="resampling-procedures.html"><a href="resampling-procedures.html#resampling"><i class="fa fa-check"></i><b>11.2</b> Resampling</a><ul>
<li class="chapter" data-level="11.2.1" data-path="resampling-procedures.html"><a href="resampling-procedures.html#significance-tests"><i class="fa fa-check"></i><b>11.2.1</b> Significance tests</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="resampling-procedures.html"><a href="resampling-procedures.html#significance-testing-using-permutation-randomisation-tests"><i class="fa fa-check"></i><b>11.3</b> Significance testing using permutation (<em>randomisation</em>) tests</a><ul>
<li class="chapter" data-level="11.3.1" data-path="resampling-procedures.html"><a href="resampling-procedures.html#permutation-test-on-two-independent-samples"><i class="fa fa-check"></i><b>11.3.1</b> Permutation Test on Two Independent Samples</a></li>
<li class="chapter" data-level="11.3.2" data-path="resampling-procedures.html"><a href="resampling-procedures.html#p-values-from-permutation-tests"><i class="fa fa-check"></i><b>11.3.2</b> P-values from permutation tests</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="resampling-procedures.html"><a href="resampling-procedures.html#the-bootstrap"><i class="fa fa-check"></i><b>11.4</b> The bootstrap</a><ul>
<li class="chapter" data-level="11.4.1" data-path="resampling-procedures.html"><a href="resampling-procedures.html#example-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>11.4.1</b> Example: constructing bootstrap confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="resampling-procedures.html"><a href="resampling-procedures.html#differences-between-permutation-test-and-bootstrap-test"><i class="fa fa-check"></i><b>11.5</b> Differences between permutation test and bootstrap test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html"><i class="fa fa-check"></i><b>12</b> Multivariate Data Methods</a><ul>
<li class="chapter" data-level="12.1" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#learning-objectives-11"><i class="fa fa-check"></i><b>12.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="12.2" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#clustering"><i class="fa fa-check"></i><b>12.2</b> Clustering</a><ul>
<li class="chapter" data-level="12.2.1" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#clustering-algorithms"><i class="fa fa-check"></i><b>12.2.1</b> Clustering algorithms</a></li>
<li class="chapter" data-level="12.2.2" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#with-ants"><i class="fa fa-check"></i><b>12.2.2</b> With ants</a></li>
<li class="chapter" data-level="12.2.3" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#k-means-using-the-palmerpenguins-data"><i class="fa fa-check"></i><b>12.2.3</b> k-means using the <code>palmerpenguins</code> data</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#tldr-k-means-clustering"><i class="fa fa-check"></i><b>12.3</b> TL;DR k-means clustering</a></li>
<li class="chapter" data-level="12.4" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#other-resources-optional-but-recommended-1"><i class="fa fa-check"></i><b>12.4</b> Other resources: optional but recommended</a><ul>
<li class="chapter" data-level="12.4.1" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html#multidimensional-scaling-in-r-not-examinable"><i class="fa fa-check"></i><b>12.4.1</b> Multidimensional Scaling in <code>R</code> (<em>not examinable</em>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dimension-reduction.html"><a href="dimension-reduction.html"><i class="fa fa-check"></i><b>13</b> Dimension reduction</a><ul>
<li class="chapter" data-level="13.1" data-path="dimension-reduction.html"><a href="dimension-reduction.html#learning-objectives-12"><i class="fa fa-check"></i><b>13.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="13.2" data-path="dimension-reduction.html"><a href="dimension-reduction.html#dimension-reduction-1"><i class="fa fa-check"></i><b>13.2</b> Dimension reduction</a></li>
<li class="chapter" data-level="13.3" data-path="dimension-reduction.html"><a href="dimension-reduction.html#pca-in-r"><i class="fa fa-check"></i><b>13.3</b> PCA in <code>R</code></a><ul>
<li class="chapter" data-level="13.3.1" data-path="dimension-reduction.html"><a href="dimension-reduction.html#using-the-palmerpenguins-data"><i class="fa fa-check"></i><b>13.3.1</b> Using the <code>palmerpenguins</code> data</a></li>
<li class="chapter" data-level="13.3.2" data-path="dimension-reduction.html"><a href="dimension-reduction.html#athletes"><i class="fa fa-check"></i><b>13.3.2</b> Athletes</a></li>
<li class="chapter" data-level="13.3.3" data-path="dimension-reduction.html"><a href="dimension-reduction.html#ants-from-previous-chapter"><i class="fa fa-check"></i><b>13.3.3</b> Ants (from previous chapter)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="dimension-reduction.html"><a href="dimension-reduction.html#reality-check-reducing-noise..."><i class="fa fa-check"></i><b>13.4</b> Reality check: reducing noise...</a></li>
<li class="chapter" data-level="13.5" data-path="dimension-reduction.html"><a href="dimension-reduction.html#other-resources-optional-but-recommended-2"><i class="fa fa-check"></i><b>13.5</b> Other resources: optional but recommended</a><ul>
<li class="chapter" data-level="13.5.1" data-path="dimension-reduction.html"><a href="dimension-reduction.html#multidimensional-scaling-in-r"><i class="fa fa-check"></i><b>13.5.1</b> Multidimensional Scaling in <code>R</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>bluebook</em> BIOSCI738</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="resampling-procedures" class="section level1">
<h1><span class="header-section-number">11</span> Resampling Procedures</h1>
<div id="learning-objectives-10" class="section level2">
<h2><span class="header-section-number">11.1</span> Learning Objectives</h2>
<ul>
<li>List the aims, write out the appropriate null and alternative hypothesis using statistical notation for, and write <code>R</code> code to carry out a
<ul>
<li>permutation (<em>randomization</em>) test</li>
<li>bootsrap procedure</li>
</ul></li>
</ul>
</div>
<div id="resampling" class="section level2">
<h2><span class="header-section-number">11.2</span> Resampling</h2>
<p><strong>What is resampling?</strong></p>
<p>Any of a variety of methods for doing one of the following</p>
<ol style="list-style-type: decimal">
<li><strong>Estimating the precision of sample statistics</strong> (e.g., bootstrapping)</li>
<li><strong>Performing significance tests</strong> (e.g., permutation/exact/randomisation tests)</li>
<li><strong>Validating models</strong> (e.g., bootstrapping, cross validation)</li>
</ol>
<div id="significance-tests" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Significance tests</h3>
<p>A significance test can tell us whether an observed effect (e.g., difference between two means (or medians), or correlation between two variables) could occur by chance in selecting a random sample from each of the two populations.</p>
<p>The basic approach to permutation tests is straightforward:</p>
<ol style="list-style-type: decimal">
<li>Choose a statistic to measure the effect in question (e.g., differences between group means)</li>
<li>Calculate that test statistic on the observed data. Note this metric can be <strong>anything</strong> you wish</li>
<li>Construct the sampling distribution that this statistic would have if the effect were not present in the population (i.e., the distribution under the <em>Null</em> hypothesis, <span class="math inline">\(H_0\)</span>): For chosen number of times
<ul>
<li>shuffle the data labels</li>
<li>calculate the test statistic for the reshuffled data and retain</li>
</ul></li>
<li>Find the location of your observed statistic in the sampling distribution. The location of observed statistic in sampling distribution is informative:</li>
</ol>
<ul>
<li>if in the main body of the distribution then the observed statistic could easily have occurred by chance</li>
<li>if in the tail of the distribution then the observed statistic would rarely occur by chance and there is evidence that something other than chance is operating.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Calculate the proportion of times your reshuffled statistics equal or exceed the observed. This <em>p-value</em> is the probability that we observe a statistic at least as “extreme” as the one we observed <strong>State</strong> the strength of evidence against the null on the basis of this <strong>probability</strong>.</li>
</ol>
</div>
</div>
<div id="significance-testing-using-permutation-randomisation-tests" class="section level2">
<h2><span class="header-section-number">11.3</span> Significance testing using permutation (<em>randomisation</em>) tests</h2>
<div id="permutation-test-on-two-independent-samples" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Permutation Test on Two Independent Samples</h3>
<div id="pāua-shell-lengths" class="section level4">
<h4><span class="header-section-number">11.3.1.1</span> Pāua shell lengths</h4>
<p>Remember the Pāua data from <a href="https://stats-uoa.github.io/BIOSCI738/r-rstudio-and-git.html#exploratory-data-analysis">Chapter 1</a> One question we may want to ask is if on average the shell length differs between Species?</p>
<p><strong>Scientific question</strong>: Are the shell lengths of shells the same in both species? <strong>Null hypothesis</strong>: The distribution of shell lengths in <em>Haliotis iris</em> the same as in <em>Haliotis australis</em> <strong>Test statistic</strong>: Difference of sample means</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">means &lt;-<span class="st"> </span>paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">means =</span> <span class="kw">mean</span>(Length))
<span class="kw">ggplot</span>(paua,<span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Length)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Length (cms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> means, <span class="dt">color =</span> Species), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">yintercept =</span> means, <span class="dt">color =</span> Species), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> means <span class="op">+</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;Species averege = &quot;</span>,<span class="kw">round</span>(means,<span class="dv">3</span>)), <span class="dt">color =</span> Species))</code></pre></div>
<p><img src="_main_files/figure-html/violen-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(paua,<span class="kw">aes</span>(<span class="dt">x =</span> Length, <span class="dt">fill =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Length (cms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/violen-2.png" width="672" /></p>
<p>But because the data are skewed and we've likely got non-constant variances we may be better off adopting a randomization test, rather than a parametric t-test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## observed differences in means
diff_in_means &lt;-<span class="st"> </span>(paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Length)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">diff =</span> <span class="kw">diff</span>(mean)))<span class="op">$</span>diff
diff_in_means</code></pre></div>
<pre><code>## [1] -0.9569444</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Number of times I want to randomise
nreps &lt;-<span class="st"> </span><span class="dv">1000</span>   
## initialize empty array to hold results
randomisation_difference_mean &lt;-<span class="st"> </span><span class="kw">numeric</span>(nreps)
<span class="kw">set.seed</span>(<span class="dv">1234</span>) ## *****Remove this line for actual analyses*****
## This means that each run with produce the same results and
## agree with the printout that I show.

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreps) {
  ## the observations
  data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">value =</span> paua<span class="op">$</span>Length)
  ##  randomise labels
  data<span class="op">$</span>random_labels &lt;-<span class="kw">sample</span>(paua<span class="op">$</span>Species, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
  ## randomised differences in mean
  randomisation_difference_mean[i] &lt;-<span class="st"> </span>(data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(random_labels) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">diff =</span> <span class="kw">diff</span>(mean)))<span class="op">$</span>diff
}
## results
results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">randomisation_difference_mean =</span> randomisation_difference_mean)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## How many randomised differences in means are as least as extreme as the one we observed
## absolute value as dealing with two tailed
n_exceed &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(results<span class="op">$</span>randomisation_difference_mean) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(diff_in_means))
n_exceed</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## proportion
n_exceed<span class="op">/</span>nreps</code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(results, <span class="kw">aes</span>(<span class="dt">x =</span> randomisation_difference_mean)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Differences between randomised group means&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> diff_in_means, <span class="dt">col =</span> <span class="st">&quot;cyan4&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>,<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&#39;text&#39;</span>, <span class="dt">label =</span> <span class="st">&quot;Observed difference between means&quot;</span> , 
           <span class="dt">x =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">y =</span> <span class="ot">Inf</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;cyan4&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/hist-1.png" width="672" /></p>
<p>How would the parametric t-test have served?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> paua)</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Length by Species
## t = 3.5404, df = 57.955, p-value = 0.0007957
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.4158802 1.4980086
## sample estimates:
## mean in group Haliotis australis      mean in group Haliotis iris 
##                         5.766667                         4.809722</code></pre>
<p>Not too different after all</p>
</div>
<div id="jackal-mandible-lengths" class="section level4">
<h4><span class="header-section-number">11.3.1.2</span> Jackal mandible lengths</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Mandible lengths (mm) for  golden jackals (Canis aureus) of each sex from the British Museum
jackal &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">mandible_length_mm =</span> <span class="kw">c</span>(<span class="dv">120</span>, <span class="dv">107</span>, <span class="dv">110</span>, <span class="dv">116</span>, <span class="dv">114</span>, <span class="dv">111</span>, <span class="dv">113</span>, <span class="dv">117</span>, <span class="dv">114</span>, <span class="dv">112</span>,
                                            <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">110</span>, <span class="dv">105</span>, <span class="dv">107</span>, <span class="dv">106</span>, <span class="dv">111</span>, <span class="dv">111</span>),
                     <span class="dt">sex =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>), <span class="dt">each =</span> <span class="dv">10</span>))</code></pre></div>
<p><strong>Scientific question</strong>: Are the jaw lengths of jackals the same in both sexes? <strong>Null hypothesis</strong>: The distribution of jaw lengths in male jackals the same as in in females <strong>Test statistic</strong>: Difference of sample means</p>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p>Rather than a <em>for loop</em> let's try this another way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## observed statistic
jackal_mean_diff &lt;-<span class="st"> </span>(jackal <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(mandible_length_mm)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">diff =</span> <span class="kw">diff</span>(mean)))<span class="op">$</span>diff
## Generate all possible combinations
## This time we&#39;re doing ALL possble ones
## rather than a rendom 1000
combinations &lt;-<span class="st"> </span><span class="kw">combn</span>(<span class="dv">20</span>,<span class="dv">10</span>)
## Do the permutations
permtest_combinations &lt;-<span class="st"> </span><span class="kw">apply</span>(combinations, <span class="dv">2</span>, <span class="cf">function</span>(x)
  <span class="kw">mean</span>(jackal<span class="op">$</span>mandible_length_mm[x]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(jackal<span class="op">$</span>mandible_length_mm[<span class="op">-</span>x]))
## Full Permutation test p.value
<span class="kw">length</span>(permtest_combinations[<span class="kw">abs</span>(permtest_combinations) <span class="op">&gt;=</span><span class="st"> </span>jackal_mean_diff]) <span class="op">/</span><span class="st"> </span><span class="kw">choose</span>(<span class="dv">20</span>,<span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] 0.003334127</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Now let&#39;s use 10000 random permutations, sample without replacement
## set up matrix
random_perm &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">10000</span>, <span class="dt">ncol =</span> <span class="dv">1</span>), <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sample</span>(<span class="dv">20</span>))
random_mean_diff &lt;-<span class="st"> </span><span class="kw">apply</span>(random_perm, <span class="dv">2</span>, <span class="cf">function</span>(x){
  z &lt;-<span class="st"> </span>jackal<span class="op">$</span>mandible_length_mm[x]
  <span class="kw">mean</span>(z[jackal<span class="op">$</span>sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(z[jackal<span class="op">$</span>sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span>])
})
random_p.value &lt;-<span class="st"> </span><span class="kw">length</span>(random_mean_diff [<span class="kw">abs</span>(random_mean_diff) <span class="op">&gt;=</span><span class="st"> </span>jackal_mean_diff]) <span class="op">/</span><span class="st"> </span><span class="dv">10000</span> ## note the abs()
random_p.value</code></pre></div>
<pre><code>## [1] 0.0029</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Now what about a t-test (two-sample)
<span class="kw">t.test</span>(mandible_length_mm <span class="op">~</span><span class="st"> </span>sex, <span class="dt">data =</span> jackal)<span class="op">$</span>p.value</code></pre></div>
<pre><code>## [1] 0.003359952</code></pre>
</div>
</div>
<div id="p-values-from-permutation-tests" class="section level3">
<h3><span class="header-section-number">11.3.2</span> P-values from permutation tests</h3>
<ul>
<li>In experimental situations a large p-value (large tail proportion) means that the luck of the randomisation quite often produces group differences as large or even larger than what we've got in our data.</li>
<li>A small p-value means that the luck of the randomisation draw hardly ever produces group differences as large as we've got in our data.</li>
<li><strong>Statistical significance does not imply practical significance.</strong></li>
<li><strong>Statistical significance says nothing about the size of treatment differences.</strong> To estimate the sizes of differences you need confidence intervals.</li>
</ul>
<p><strong>NOTE: We can extend the randomization test to make inference about any sample statistic (not just the mean)</strong></p>
</div>
</div>
<div id="the-bootstrap" class="section level2">
<h2><span class="header-section-number">11.4</span> The bootstrap</h2>
<p>Recall that the sampling distribution shows us what would happen if we took very many samples under the same conditions. The bootstrap is a procedure for finding the (approximate) sampling distribution from just one sample.</p>
<p>In brief,</p>
<ul>
<li>The original sample represents the distribution of the population from which it was drawn.</li>
<li>Resamples, taken <strong>with replacement</strong> from the original sample are representative of what we would get from drawing many samples from the population (the distribution of the statistics calculated from each resample is known as the <em>bootstrap distribution</em> of the statistic).</li>
<li>The bootstrap distribution of a statistic represents that statistic’s sampling distribution.</li>
</ul>
<div id="example-constructing-bootstrap-confidence-intervals" class="section level3">
<h3><span class="header-section-number">11.4.1</span> Example: constructing bootstrap confidence intervals</h3>
<p><strong>Old faithful</strong> is a gyser located in Yellowstone National Park, Wyoming. Below is a histogram of the durations of 299 consecutive eruptions. Clearly bimodal!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MASS<span class="op">::</span>geyser</code></pre></div>
<pre><code>##     waiting  duration
## 1        80 4.0166667
## 2        71 2.1500000
## 3        57 4.0000000
## 4        80 4.0000000
## 5        75 4.0000000
## 6        77 2.0000000
## 7        60 4.3833333
## 8        86 4.2833333
## 9        77 2.0333333
## 10       56 4.8333333
## 11       81 1.8333333
## 12       50 5.4500000
## 13       89 1.6166667
## 14       54 4.8666667
## 15       90 4.3833333
## 16       73 1.7666667
## 17       60 4.6666667
## 18       83 2.0000000
## 19       65 4.7333333
## 20       82 4.2166667
## 21       84 1.9000000
## 22       54 4.9666667
## 23       85 2.0000000
## 24       58 4.0000000
## 25       79 2.0000000
## 26       57 4.0000000
## 27       88 2.8333333
## 28       68 4.5000000
## 29       76 4.0666667
## 30       78 3.7166667
## 31       74 3.5166667
## 32       85 4.4666667
## 33       75 2.2166667
## 34       65 4.8833333
## 35       76 2.6000000
## 36       58 4.1500000
## 37       91 2.2000000
## 38       50 4.7666667
## 39       87 1.8333333
## 40       48 4.6000000
## 41       93 2.2666667
## 42       54 4.1333333
## 43       86 2.0000000
## 44       53 4.0000000
## 45       78 2.0000000
## 46       52 4.0000000
## 47       83 1.8833333
## 48       60 4.2666667
## 49       87 2.0833333
## 50       49 4.4666667
## 51       80 2.5000000
## 52       60 4.0000000
## 53       92 1.7666667
## 54       43 4.3333333
## 55       89 2.1833333
## 56       60 4.4833333
## 57       84 3.8833333
## 58       69 3.3333333
## 59       74 3.7333333
## 60       71 4.0000000
## 61      108 1.9500000
## 62       50 5.2666667
## 63       77 2.0000000
## 64       57 4.0000000
## 65       80 2.0000000
## 66       61 4.0000000
## 67       82 2.0000000
## 68       48 4.0000000
## 69       81 3.5333333
## 70       73 2.1666667
## 71       62 4.5000000
## 72       79 2.0166667
## 73       54 4.1500000
## 74       80 4.2000000
## 75       73 4.3333333
## 76       81 1.9333333
## 77       62 4.6500000
## 78       81 3.8166667
## 79       71 4.0333333
## 80       79 4.1666667
## 81       81 4.6666667
## 82       74 1.8166667
## 83       59 4.0000000
## 84       81 3.0000000
## 85       66 4.0000000
## 86       87 2.0000000
## 87       53 4.4500000
## 88       80 2.0500000
## 89       50 4.2500000
## 90       87 1.9166667
## 91       51 4.6666667
## 92       82 1.7333333
## 93       58 4.3833333
## 94       81 1.7666667
## 95       49 4.6000000
## 96       92 1.8666667
## 97       50 4.4500000
## 98       88 1.6333333
## 99       62 5.0333333
## 100      93 1.8166667
## 101      56 5.1000000
## 102      89 1.6333333
## 103      51 4.2833333
## 104      79 2.0000000
## 105      58 4.0000000
## 106      82 2.0000000
## 107      52 4.5333333
## 108      88 2.0000000
## 109      52 4.0000000
## 110      78 2.9333333
## 111      69 4.7333333
## 112      75 3.9000000
## 113      77 1.9500000
## 114      53 4.1166667
## 115      80 1.8000000
## 116      55 4.6666667
## 117      87 1.8333333
## 118      53 4.7000000
## 119      85 2.1166667
## 120      61 4.7833333
## 121      93 1.8166667
## 122      54 4.1000000
## 123      76 4.6500000
## 124      80 4.0000000
## 125      81 2.0000000
## 126      59 4.0000000
## 127      86 4.0000000
## 128      78 4.2166667
## 129      71 4.1333333
## 130      77 3.9333333
## 131      76 3.7500000
## 132      94 4.4166667
## 133      75 2.4666667
## 134      50 4.1666667
## 135      83 3.8000000
## 136      82 4.3166667
## 137      72 3.8666667
## 138      77 4.6833333
## 139      75 1.7000000
## 140      65 4.9666667
## 141      79 4.2666667
## 142      72 4.5833333
## 143      78 4.0000000
## 144      77 4.0000000
## 145      79 4.0000000
## 146      75 4.0000000
## 147      78 1.9833333
## 148      64 4.6000000
## 149      80 0.8333333
## 150      49 4.9166667
## 151      88 1.7333333
## 152      54 4.5833333
## 153      85 1.7000000
## 154      51 4.7500000
## 155      96 1.8333333
## 156      50 4.5000000
## 157      80 1.8666667
## 158      78 4.4500000
## 159      81 4.4500000
## 160      72 4.0000000
## 161      75 4.8000000
## 162      78 4.0000000
## 163      87 4.0000000
## 164      69 2.0000000
## 165      55 4.0000000
## 166      83 1.9333333
## 167      49 4.5833333
## 168      82 2.0000000
## 169      57 3.7000000
## 170      84 2.8666667
## 171      57 4.8333333
## 172      84 3.4500000
## 173      73 4.3833333
## 174      78 1.8000000
## 175      57 4.4000000
## 176      79 2.4833333
## 177      57 4.5166667
## 178      90 2.1000000
## 179      62 4.3500000
## 180      87 4.3666667
## 181      78 1.7833333
## 182      52 4.9166667
## 183      98 1.8166667
## 184      48 4.0000000
## 185      78 4.0000000
## 186      79 4.0000000
## 187      65 3.8666667
## 188      84 1.8500000
## 189      50 4.7000000
## 190      83 2.0166667
## 191      60 4.4666667
## 192      80 1.8666667
## 193      50 4.1666667
## 194      88 1.9000000
## 195      50 4.2500000
## 196      84 3.2500000
## 197      74 4.2166667
## 198      76 1.8833333
## 199      65 4.9833333
## 200      89 1.8500000
## 201      49 4.0000000
## 202      88 1.9666667
## 203      51 4.7666667
## 204      78 4.0000000
## 205      85 2.0000000
## 206      65 4.0000000
## 207      75 4.0000000
## 208      77 2.3833333
## 209      69 4.4166667
## 210      92 4.2166667
## 211      68 4.3666667
## 212      87 2.0000000
## 213      61 4.4500000
## 214      81 1.7500000
## 215      55 4.5000000
## 216      93 1.6166667
## 217      53 4.7000000
## 218      84 2.5666667
## 219      70 3.7000000
## 220      73 4.2333333
## 221      93 1.9333333
## 222      50 4.3500000
## 223      87 4.0000000
## 224      77 4.0000000
## 225      74 4.0000000
## 226      72 4.2166667
## 227      82 4.0000000
## 228      74 4.1333333
## 229      80 1.8833333
## 230      49 4.4666667
## 231      91 1.9500000
## 232      53 4.2166667
## 233      86 1.7166667
## 234      49 4.4500000
## 235      79 4.2500000
## 236      89 3.9666667
## 237      87 4.3833333
## 238      76 1.9666667
## 239      59 4.4500000
## 240      80 4.2666667
## 241      89 1.9166667
## 242      45 4.4166667
## 243      93 3.0000000
## 244      72 4.0000000
## 245      71 2.0000000
## 246      54 4.0000000
## 247      79 3.2833333
## 248      74 1.8333333
## 249      65 4.6166667
## 250      78 1.8333333
## 251      57 4.6166667
## 252      87 4.6000000
## 253      72 4.2500000
## 254      84 1.9333333
## 255      47 4.9833333
## 256      84 1.9666667
## 257      57 4.3000000
## 258      87 4.2000000
## 259      68 4.5333333
## 260      86 4.4000000
## 261      75 4.6166667
## 262      73 2.0000000
## 263      53 4.0000000
## 264      82 4.0000000
## 265      93 3.9166667
## 266      77 2.0000000
## 267      54 4.5000000
## 268      96 1.8000000
## 269      48 4.0000000
## 270      89 2.7500000
## 271      63 4.7333333
## 272      84 3.9666667
## 273      76 1.9500000
## 274      62 4.9666667
## 275      83 1.8500000
## 276      50 4.8000000
## 277      85 4.0000000
## 278      78 4.0000000
## 279      78 4.0000000
## 280      81 4.0000000
## 281      78 4.0000000
## 282      76 4.0000000
## 283      74 4.0000000
## 284      81 2.0000000
## 285      66 4.0000000
## 286      84 1.9333333
## 287      48 4.3333333
## 288      93 1.6666667
## 289      47 4.7666667
## 290      87 1.9500000
## 291      51 4.6833333
## 292      78 1.9333333
## 293      54 4.4166667
## 294      87 2.1333333
## 295      52 4.0833333
## 296      85 2.0666667
## 297      58 4.0000000
## 298      88 4.0000000
## 299      79 2.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> MASS<span class="op">::</span>geyser, <span class="kw">aes</span>(<span class="dt">x =</span> duration)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Duration of eruptions (m)&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /> <strong>Step 1:</strong> Calculating the observed mean eruption duration time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean &lt;-<span class="st"> </span>MASS<span class="op">::</span>geyser <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(duration))
mean</code></pre></div>
<pre><code>##       mean
## 1 3.460814</code></pre>
<p><strong>Step 2:</strong> Construct bootstrap distribution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Number of times I want to bootstrap
nreps &lt;-<span class="st"> </span><span class="dv">1000</span>   
## initialize empty array to hold results
bootstrap_means &lt;-<span class="st"> </span><span class="kw">numeric</span>(nreps)
<span class="kw">set.seed</span>(<span class="dv">1234</span>) ## *****Remove this line for actual analyses*****
## This means that each run with produce the same results and
## agree with the printout that I show.
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreps) {
  ## bootstrap. note with replacement
  bootstrap_sample &lt;-<span class="st"> </span><span class="kw">sample</span>(MASS<span class="op">::</span>geyser<span class="op">$</span>duration, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
  ##  bootstraped mean resample
  bootstrap_means[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(bootstrap_sample)
}
## results
results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">bootstrap_means =</span> bootstrap_means)
<span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(<span class="dt">x =</span> bootstrap_means)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">as.numeric</span>(mean)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bootstrap distribution&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p><strong>Bootstrap estimate of bias</strong> is the difference between the mean of the boostrap distribution and the value of the statistic in the original sample:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bias &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(mean) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(results<span class="op">$</span>bootstrap_means)
bias</code></pre></div>
<pre><code>## [1] 0.001200111</code></pre>
<p><strong>Bootstrap standard error of a statistic</strong> is the standard deviation of its bootstrap distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(results<span class="op">$</span>bootstrap_means)</code></pre></div>
<pre><code>## [1] 0.06740607</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## compare to SEM of original data
 MASS<span class="op">::</span>geyser <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sem =</span> <span class="kw">sd</span>(duration)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(duration)))</code></pre></div>
<pre><code>##          sem
## 1 0.06638498</code></pre>
<p><strong>Bootstrap <span class="math inline">\(t\)</span> confidence interval</strong>. If, for a sample of size <span class="math inline">\(n\)</span> the boostrap distribution is approximately Normal and the estimate of bias is small then an approximate <span class="math inline">\(C\)</span> confidence for the parameter corresponding to the statistic is: <span class="math display">\[\text{statistic} \pm t^* \text{SE}_\text{bootstrap}\]</span> where <span class="math inline">\(t*\)</span> is the critical value of the <span class="math inline">\(t_{n-1}\)</span> distribution with area <span class="math inline">\(C\)</span> between <span class="math inline">\(-t^*\)</span> and <span class="math inline">\(t^*\)</span>. For <span class="math inline">\(C = 0.95\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(mean) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dv">298</span>)<span class="op">*</span><span class="kw">sd</span>(results<span class="op">$</span>bootstrap_means)</code></pre></div>
<pre><code>## [1] 3.328162 3.593466</code></pre>
<p>So our 95% confidence interval is 3.3 to 3.6.</p>
<p><strong>Bootstrap <span class="math inline">\(percentile\)</span> confidence interval</strong>. Use the bootstrap distribution itself to determine the limits of the confidence interval by taking the limits of the sorted, central <span class="math inline">\(C\)</span> bulk of the distribution. For <span class="math inline">\(C = 0.95\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(results<span class="op">$</span>bootstrap_means)[<span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">975</span>)]</code></pre></div>
<pre><code>## [1] 3.328428 3.591081</code></pre>
</div>
</div>
<div id="differences-between-permutation-test-and-bootstrap-test" class="section level2">
<h2><span class="header-section-number">11.5</span> Differences between permutation test and bootstrap test</h2>
<ul>
<li><p>The permutation test exploits symmetry under the null hypothesis.</p></li>
<li><p>A full permutation test p-value is exact, conditional on data values in the combined sample.</p></li>
<li><p>A bootstrap estimates the probability mechanism that generated the samples under the null hypothesis.</p></li>
<li><p>A bootstrap does <strong>not</strong> require any special symmetry or assumption or exchangability.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-data-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
