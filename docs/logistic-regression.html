<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Logistic regression | Advanced Biological Data Analysis</title>
  <meta name="description" content="Logistic regression | Advanced Biological Data Analysis" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Logistic regression | Advanced Biological Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Logistic regression | Advanced Biological Data Analysis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="poisson-regression.html"/>
<link rel="next" href="model-diagnostics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSCI 738: Advanced Biological Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Nau mai, haere mai. Welcome to BIOSCI 738</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html"><i class="fa fa-check"></i>Key Information</a>
<ul>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#course-policies"><i class="fa fa-check"></i>Course policies</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-1.html"><a href="module-1.html"><i class="fa fa-check"></i>Module 1</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><code>R</code> and <code>RStudio</code></a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#recap-r-terminology"><i class="fa fa-check"></i>Recap: <code>R</code> terminology</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#which-r-syntax"><i class="fa fa-check"></i>Which <code>R</code> syntax?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="error-handling-and-debugging.html"><a href="error-handling-and-debugging.html"><i class="fa fa-check"></i>Error handling and debugging</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html"><i class="fa fa-check"></i>Accuracy and Honesty</a>
<ul>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="accuracy-and-honesty.html"><a href="accuracy-and-honesty.html#good-coding-practice"><i class="fa fa-check"></i>Good coding practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html"><i class="fa fa-check"></i>Version control with <code>git</code> and GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#setting-up"><i class="fa fa-check"></i>Setting up</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#cloning-a-repository-from-github-using-rstudio"><i class="fa fa-check"></i>Cloning a repository from <code>GitHub</code> using <code>RStudio</code></a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#commiting-and-pushing-changes"><i class="fa fa-check"></i>Commiting and pushing changes</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#system-specific-hurdles"><i class="fa fa-check"></i>System specific hurdles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html"><i class="fa fa-check"></i>Respectful Handling of Data</a>
<ul>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#data-sovereignty"><i class="fa fa-check"></i>Data sovereignty</a></li>
<li class="chapter" data-level="" data-path="respectful-handling-of-data.html"><a href="respectful-handling-of-data.html#māori-data-sovereignty-principles"><i class="fa fa-check"></i>Māori Data Sovereignty principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html"><i class="fa fa-check"></i>Awareness of Consequences</a>
<ul>
<li class="chapter" data-level="" data-path="awareness-of-consequences.html"><a href="awareness-of-consequences.html#case-study"><i class="fa fa-check"></i>Case study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i>Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#exploratory-plots-for-your-own-purposes"><i class="fa fa-check"></i>Exploratory plots (for your own purposes)</a></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#explanatory-plots"><i class="fa fa-check"></i>Explanatory plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-2.html"><a href="module-2.html"><i class="fa fa-check"></i>Module 2</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html"><i class="fa fa-check"></i>Permutation and randomisation tests</a>
<ul>
<li class="chapter" data-level="" data-path="permutation-and-randomisation-tests.html"><a href="permutation-and-randomisation-tests.html#a-permutation-test-jackal-mandible-lengths"><i class="fa fa-check"></i>A permutation test: Jackal mandible lengths</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html"><i class="fa fa-check"></i>Bootstrap resampling</a>
<ul>
<li class="chapter" data-level="" data-path="bootstrap-resampling.html"><a href="bootstrap-resampling.html#example-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i>Example: constructing bootstrap confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html"><i class="fa fa-check"></i>Parametric hypothesis testing</a>
<ul>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#the-vocabulary-of-hypothesis-testing"><i class="fa fa-check"></i>The vocabulary of hypothesis testing</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="parametric-hypothesis-testing.html"><a href="parametric-hypothesis-testing.html#differences-between-two-means"><i class="fa fa-check"></i>Differences between two means</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#model-formula-syntax-in-r"><i class="fa fa-check"></i>Model formula syntax in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#some-mathematical-notation"><i class="fa fa-check"></i>Some mathematical notation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#modeling-bill-depth"><i class="fa fa-check"></i>Modeling Bill Depth</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#single-continuous-variable"><i class="fa fa-check"></i>Single continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#a-single-factor-variable"><i class="fa fa-check"></i>A single factor variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#one-factor-and-a-continuous-variable"><i class="fa fa-check"></i>One factor and a continuous variable</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html"><i class="fa fa-check"></i>Model diagnostics for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html#marginal-predictions"><i class="fa fa-check"></i>Marginal predictions</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics-for-a-linear-model.html"><a href="model-diagnostics-for-a-linear-model.html#model-selection"><i class="fa fa-check"></i>Model selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html"><i class="fa fa-check"></i>Inference for a linear model</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#point-prediction"><i class="fa fa-check"></i>Point prediction</a></li>
<li class="chapter" data-level="" data-path="inference-for-a-linear-model.html"><a href="inference-for-a-linear-model.html#confidence-intervals-for-parameters"><i class="fa fa-check"></i>Confidence intervals for parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-3.html"><a href="module-3.html"><i class="fa fa-check"></i>Module 3</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i>Introduction to the design and analysis of experiments</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i>Key phrases</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#the-three-key-principles"><i class="fa fa-check"></i>The three key principles:</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#replication"><i class="fa fa-check"></i>Replication</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#randomization"><i class="fa fa-check"></i>Randomization</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#blocking"><i class="fa fa-check"></i>Blocking</a></li>
<li class="chapter" data-level="" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#setting-up-an-experiment"><i class="fa fa-check"></i>Setting up an experiment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html"><i class="fa fa-check"></i>Some basic experimental designs</a>
<ul>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#completely-randomised-design-crd"><i class="fa fa-check"></i>Completely randomised design (CRD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#randomised-complete-block-design-rcbd"><i class="fa fa-check"></i>Randomised complete block design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="some-basic-experimental-designs.html"><a href="some-basic-experimental-designs.html#factorial-design"><i class="fa fa-check"></i>Factorial design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html"><i class="fa fa-check"></i>Modelling experimental data</a>
<ul>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-completely-randomised-design-crd-as-a-linear-model"><i class="fa fa-check"></i>A completely randomised design (CRD) as a linear model</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#analysis-of-a-crd-in-r"><i class="fa fa-check"></i>Analysis of a CRD in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#a-factorial-experiment-as-a-crd"><i class="fa fa-check"></i>A Factorial experiment (as a CRD)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#unqual-replications-unbalanced-design"><i class="fa fa-check"></i>Unqual replications (unbalanced design)</a></li>
<li class="chapter" data-level="" data-path="modelling-experimental-data.html"><a href="modelling-experimental-data.html#sums-of-squares-ss"><i class="fa fa-check"></i>Sums of squares (<span class="math inline">\(SS\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i>Multiple comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#adjustments-for-multiple-testing"><i class="fa fa-check"></i>Adjustments for multiple testing</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#classification-of-multiple-hypothesis-tests"><i class="fa fa-check"></i>Classification of multiple hypothesis tests</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-comparison-procedures"><i class="fa fa-check"></i>Multiple comparison procedures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html"><i class="fa fa-check"></i>Linear mixed-effect models (LMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-randomised-controlled-block-design-rcbd"><i class="fa fa-check"></i>A Randomised Controlled Block Design (RCBD)</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-split-plot-design"><i class="fa fa-check"></i>A Split-plot design</a></li>
<li class="chapter" data-level="" data-path="linear-mixed-effect-models-lmms.html"><a href="linear-mixed-effect-models-lmms.html#a-repeated-measures-design"><i class="fa fa-check"></i>A repeated measures design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-4.html"><a href="module-4.html"><i class="fa fa-check"></i>Module 4</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-generalised-linear-models-glms.html"><a href="introduction-to-generalised-linear-models-glms.html"><i class="fa fa-check"></i>Introduction to generalised linear models (GLMs)</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i>Poisson regression</a>
<ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#an-example-bird-abundance"><i class="fa fa-check"></i>An example: bird abundance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#an-example-lobsters"><i class="fa fa-check"></i>An example: lobsters</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i>Model diagnostics</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#residuals"><i class="fa fa-check"></i>Residuals</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#the-quantile-residual-q-q-plot"><i class="fa fa-check"></i>The quantile residual Q-Q plot</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#deviance-using-the-chi-squared-approach"><i class="fa fa-check"></i>Deviance (using the chi-squared approach)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-summary-of-glms.html"><a href="a-summary-of-glms.html"><i class="fa fa-check"></i>A summary of GLMs</a></li>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html"><i class="fa fa-check"></i>Generalised linear mixed-effects models (GLMMMs)</a>
<ul>
<li class="chapter" data-level="" data-path="generalised-linear-mixed-effects-models-glmmms.html"><a href="generalised-linear-mixed-effects-models-glmmms.html#fitting-a-glmm"><i class="fa fa-check"></i>Fitting a GLMM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-5.html"><a href="module-5.html"><i class="fa fa-check"></i>Module 5</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i>Clustering</a>
<ul>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#divisive-partitioning-methods."><i class="fa fa-check"></i>Divisive (partitioning) methods.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#k-means-an-example-using-the-palmerpenguins-data"><i class="fa fa-check"></i>K-means: an example using the <code>palmerpenguins</code> data</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-agglomerative-clustering."><i class="fa fa-check"></i>Hierarchical agglomerative clustering.</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering-an-example"><i class="fa fa-check"></i>Hierarchical clustering: an example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i>Principal Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#examples-in-r"><i class="fa fa-check"></i>Examples in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i>Multidimensional Scaling (MDS)</a>
<ul>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#metric-scaling"><i class="fa fa-check"></i>Metric Scaling</a></li>
<li class="chapter" data-level="" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html#correspondence-analysis-ca"><i class="fa fa-check"></i>Correspondence Analysis (CA)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html"><i class="fa fa-check"></i>Non-metric Multidimensional Scaling</a>
<ul>
<li class="chapter" data-level="" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#examples-in-r-2"><i class="fa fa-check"></i>Examples in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html"><i class="fa fa-check"></i>Linear Discriminant Analysis (LDA)</a>
<ul>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#example-in-r"><i class="fa fa-check"></i>Example in <code>R</code></a></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis-lda.html"><a href="linear-discriminant-analysis-lda.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-6.html"><a href="module-6.html"><i class="fa fa-check"></i>Module 6</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html"><i class="fa fa-check"></i>Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#some-basic-matrix-algebra"><i class="fa fa-check"></i>Some basic matrix algebra</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#linear-least-squares"><i class="fa fa-check"></i>Linear least squares</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#matrix-representation-of-a-crd"><i class="fa fa-check"></i>Matrix representation of a CRD</a></li>
<li class="chapter" data-level="" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#a-numeric-example"><i class="fa fa-check"></i>A numeric example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i>Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#differeniation-rules"><i class="fa fa-check"></i>Differeniation rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#logarithm-rules"><i class="fa fa-check"></i>Logarithm rules</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-binomial-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-crd"><i class="fa fa-check"></i>Maximum likelihood estimation for a CRD</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximising-the-log-likelihood"><i class="fa fa-check"></i>Maximising the log-likelihood</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-poisson-distribution"><i class="fa fa-check"></i>Maximum likelihood estimation for a Poisson distribution</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-a-continuous-random-variable"><i class="fa fa-check"></i>Maximum likelihood estimation for a continuous random variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html"><i class="fa fa-check"></i>Introduction to Bayesian statistics</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#conditional-probability"><i class="fa fa-check"></i>Conditional probability</a></li>
<li class="chapter" data-level="" data-path="introduction-to-bayesian-statistics.html"><a href="introduction-to-bayesian-statistics.html#bayes-rule"><i class="fa fa-check"></i>Bayes’ rule</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://canvas.auckland.ac.nz/courses/103658">CANVAS</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level2 hasAnchor">
<h2>Logistic regression<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We define a random variable, <span class="math inline">\(Y_i\)</span>, to have a binomial distribution if it is the number of successes from a number of <strong>independent</strong> trials, <span class="math inline">\(n\)</span>, each with the same probability of success, <span class="math inline">\(p\)</span>. It is a discrete distribution, which notes that the number of successes associated with the <span class="math inline">\(i^{th}\)</span> observation must be an integer between <span class="math inline">\(0\)</span> and <span class="math inline">\(n_i\)</span>. In addition, it builds in the non-constant variance of <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(\frac{Y_i}{n_i}\)</span>: <span class="math inline">\(\text{Var}(Y_i)=n_ip_i(1−p_i)\)</span> and <span class="math inline">\(\text{Var}(\frac{Y_i}{n_i}) = \frac{p_i(1−p_i)}{n_i}\)</span>.</p>
<p>If we were to assume a linear relationship (as previously) that <span class="math inline">\(p_i = \alpha + \beta_1 x_i\)</span> then we would be allowing <span class="math inline">\(p &lt; 0\)</span> and <span class="math inline">\(p&gt;1\)</span>, which is not supported by the binomial distribution. So, we use a link function to map between <span class="math inline">\(p\)</span> and the real number line:</p>
<p><span class="math display">\[\text{logit}(p_i) = \text{log}\left (\frac{p_i}{1 - p_i}\right ) = \alpha + \beta_1x_i.\]</span> This leads to
<span class="math display">\[p_i = \frac{\exp(\alpha + \beta_1x_i)}{1 + \exp(\alpha + \beta_1x_i)}.\]</span>
and</p>
<p><span class="math display">\[Y_i \sim \text{Binomial}(n_i, p_i)\]</span></p>
<div id="interpreting-coefficients-1" class="section level4 hasAnchor">
<h4>Interpreting coefficients<a href="logistic-regression.html#interpreting-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recap, for probability <span class="math inline">\(p\)</span> the <strong>odds</strong> are <span class="math inline">\(\frac{p}{1-p}\)</span> and the <strong>log-odds</strong> are <span class="math inline">\(\text{log}\left (\frac{p}{1-p}\right )\)</span>:</p>
<ul>
<li>when <span class="math inline">\(p=0.5\)</span> the <strong>odds</strong> <span class="math inline">\(=1\)</span> and the <strong>log-odds</strong> <span class="math inline">\(= 0\)</span></li>
<li>when <span class="math inline">\(p=1\)</span> the <strong>odds</strong> <span class="math inline">\(\infty\)</span> and the <strong>log-odds</strong> <span class="math inline">\(= \infty\)</span></li>
<li>when <span class="math inline">\(p=0\)</span> the <strong>odds</strong> <span class="math inline">\(=0\)</span> and the <strong>log-odds</strong> <span class="math inline">\(= -\infty\)</span></li>
</ul>
<p>Recall, for a linear regression model <span class="math inline">\(\mu = \alpha + \beta_1x\)</span>, when <span class="math inline">\(x=0\)</span> <span class="math inline">\(y = \alpha\)</span> and for every one-unit increase in <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> increases by amount <span class="math inline">\(\beta_1\)</span>.</p>
<p>For a logistic regression model we have
<span class="math display">\[\begin{array}{rl}
\text{logit}(p) = \alpha + \beta_1 x \\
\text{log}\left (\frac{p}{1-p}\right ) = \alpha + \beta_1 x \\
\text{log}\left (\text{odds}\right ) = \alpha + \beta_1 x \\
\end{array}\]</span></p>
<p>We can interpret this as when <span class="math inline">\(x = 0\)</span>, the log-odds of success are equal to <span class="math inline">\(\alpha\)</span> and that for every one-unit increase in <span class="math inline">\(x\)</span> the log-odds of success increase by <span class="math inline">\(\beta_1\)</span>. But, interpreting the effect of <span class="math inline">\(x\)</span> on the log-odds of success is not straightforward.</p>
<p>Now, we have</p>
<p><span class="math display">\[\text{odds} = \text{e}^{ \alpha + \beta_1 x} = \text{e}^{ \alpha}(\text{e}^{\beta_1})^{ x}.\]</span>
This implies that</p>
<ul>
<li>when <span class="math inline">\(x = 0\)</span> <span class="math inline">\(\text{odds} = \text{e}^{ \alpha}(\text{e}^{\beta_1})^{0} \text{e}^{ \alpha}\times 1 = \text{e}^{ \alpha},\)</span></li>
<li>when <span class="math inline">\(x = 1\)</span> <span class="math inline">\(\text{odds} = \text{e}^{ \alpha}(\text{e}^{\beta_1})^{1} = \text{e}^{ \alpha}\text{e}^{\beta_1} = \text{e}^{ \alpha + \beta_1},\)</span></li>
<li>when <span class="math inline">\(x = 2\)</span> <span class="math inline">\(\text{odds} = \text{e}^{ \alpha}(\text{e}^{\beta_1})^{2} = \text{e}^{ \alpha}\text{e}^{\beta_1} \text{e}^{\beta_1} = \text{e}^{ \alpha + \beta_1 + \beta_1},\)</span></li>
<li>when <span class="math inline">\(x = 3\)</span> <span class="math inline">\(\text{odds} = \text{e}^{ \alpha}(\text{e}^{\beta_1})^{3} = \text{e}^{ \alpha}\text{e}^{\beta_1} \text{e}^{\beta_1}\text{e}^{\beta_1} = \text{e}^{ \alpha + \beta_1 + \beta_1 + \beta_1},\)</span> and</li>
<li>so on …</li>
</ul>
</div>
<div id="goodness-of-fit-1" class="section level4 hasAnchor">
<h4>Goodness-of-fit<a href="logistic-regression.html#goodness-of-fit-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Typically, we use logistic regression to model if we have a binary, or proportional response (e.g., success vs. failure). But, how do we assess if our choice was appropriate? <em>Using the <strong>deviance</strong>?</em></p>
<p>Formally, we can test the null hypothesis that the model is correct by calculating a p-value using
<span class="math display">\[ p = \Pr(\chi^2_{n - k} &gt; D).\]</span></p>
<p><strong>Conditions of the chi-squared approximation</strong></p>
<p>The distribution of the deviance under the null hypothesis is approximately chi-squared if the response of each observation is well approximated by a normal distribution. This holds for binomial random variables if the number of trials, <span class="math inline">\(n_i\)</span>, is large enough:</p>
<ul>
<li>when <span class="math inline">\(p_i\)</span> is close to 0.5, <span class="math inline">\(n_i \geq 5\)</span> is probably sufficient,</li>
<li>but if <span class="math inline">\(p_i\)</span> is close to 0 or 1, <span class="math inline">\(n_i\)</span> must be much larger.</li>
</ul>
<p>However, if our chi-squared approximation assumptions are not met we should find another way.</p>
</div>
<div id="an-example-lobsters" class="section level3 hasAnchor">
<h3>An example: lobsters<a href="logistic-regression.html#an-example-lobsters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us, again, consider data from the published article <a href="https://www.sciencedirect.com/science/article/pii/S0022098115000039">Influence of predator identity on the strength of predator avoidance responses in lobsters.</a>.</p>
<p>The authors were interested in how a juvenile lobster’s size was related to its vulnerability to predation. In total, 159 juvenile lobsters were collected from their natural habitat in the Gulf of Maine, USA, and the length of each lobster’s carapace (upper shell) was measured to the nearest 3 mm, <code>size</code>. The lobsters were then tethered to the ocean floor for 24 hours. Any missing lobsters were assumed to have been consumed by a predator, while the surviving lobsters were released (i.e., <code>survived</code> = 1 if lobster survived, 0 otherwise).</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="logistic-regression.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb131-2"><a href="logistic-regression.html#cb131-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/STATS-UOA/databunker/master/data/lobster.csv&quot;</span>)</span>
<span id="cb131-3"><a href="logistic-regression.html#cb131-3" aria-hidden="true" tabindex="-1"></a>data </span>
<span id="cb131-4"><a href="logistic-regression.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 159 × 2</span></span>
<span id="cb131-5"><a href="logistic-regression.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     size survived</span></span>
<span id="cb131-6"><a href="logistic-regression.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb131-7"><a href="logistic-regression.html#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  1    42        0</span></span>
<span id="cb131-8"><a href="logistic-regression.html#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  2    36        0</span></span>
<span id="cb131-9"><a href="logistic-regression.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  3    51        1</span></span>
<span id="cb131-10"><a href="logistic-regression.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  4    33        0</span></span>
<span id="cb131-11"><a href="logistic-regression.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  5    33        1</span></span>
<span id="cb131-12"><a href="logistic-regression.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  6    45        1</span></span>
<span id="cb131-13"><a href="logistic-regression.html#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  7    54        1</span></span>
<span id="cb131-14"><a href="logistic-regression.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  8    48        0</span></span>
<span id="cb131-15"><a href="logistic-regression.html#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  9    39        0</span></span>
<span id="cb131-16"><a href="logistic-regression.html#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    48        1</span></span>
<span id="cb131-17"><a href="logistic-regression.html#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 149 more rows</span></span></code></pre></div>
<div id="ungrouped-model" class="section level4 hasAnchor">
<h4>Ungrouped model<a href="logistic-regression.html#ungrouped-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Fitting a binomial model we specify <code>family = "binomial"</code> in our <code>glm</code> call. Note that the default link function for <code>family = "binomial"</code> is the logit link; we could also use the equivalent syntax <code>binomial(link = logit)</code>to specify this model.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="logistic-regression.html#cb132-1" aria-hidden="true" tabindex="-1"></a>glm_mod_ug <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> size, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> data)</span>
<span id="cb132-2"><a href="logistic-regression.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_mod_ug)</span>
<span id="cb132-3"><a href="logistic-regression.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-4"><a href="logistic-regression.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb132-5"><a href="logistic-regression.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="do">## glm(formula = survived ~ size, family = &quot;binomial&quot;, data = data)</span></span>
<span id="cb132-6"><a href="logistic-regression.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-7"><a href="logistic-regression.html#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb132-8"><a href="logistic-regression.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error z value      Pr(&gt;|z|)    </span></span>
<span id="cb132-9"><a href="logistic-regression.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -7.89597    1.38501  -5.701 0.00000001191 ***</span></span>
<span id="cb132-10"><a href="logistic-regression.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="do">## size         0.19586    0.03415   5.735 0.00000000977 ***</span></span>
<span id="cb132-11"><a href="logistic-regression.html#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb132-12"><a href="logistic-regression.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb132-13"><a href="logistic-regression.html#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-14"><a href="logistic-regression.html#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb132-15"><a href="logistic-regression.html#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-16"><a href="logistic-regression.html#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     Null deviance: 220.41  on 158  degrees of freedom</span></span>
<span id="cb132-17"><a href="logistic-regression.html#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual deviance: 172.87  on 157  degrees of freedom</span></span>
<span id="cb132-18"><a href="logistic-regression.html#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 176.87</span></span>
<span id="cb132-19"><a href="logistic-regression.html#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-20"><a href="logistic-regression.html#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>The fitted model is therefore</p>
<p><span class="math display">\[
\log\left[ \frac { \widehat{P( \operatorname{survived} = \operatorname{1} )} }{ 1 - \widehat{P( \operatorname{survived} = \operatorname{1} )} } \right] = -7.896 + 0.196(\operatorname{size})
\]</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
<div id="grouped-model" class="section level4 hasAnchor">
<h4>Grouped model<a href="logistic-regression.html#grouped-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The data are currently ungrouped, despite many lobsters sharing the same carapace size. Therefore, we rearrange the data set so that it is grouped:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="logistic-regression.html#cb133-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="logistic-regression.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(size) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="logistic-regression.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">sum</span>(survived), <span class="at">n =</span> <span class="fu">length</span>(survived), <span class="at">p =</span> <span class="fu">mean</span>(survived))</span>
<span id="cb133-4"><a href="logistic-regression.html#cb133-4" aria-hidden="true" tabindex="-1"></a>grouped</span>
<span id="cb133-5"><a href="logistic-regression.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 11 × 4</span></span>
<span id="cb133-6"><a href="logistic-regression.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     size     y     n     p</span></span>
<span id="cb133-7"><a href="logistic-regression.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb133-8"><a href="logistic-regression.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1    27     0     5 0    </span></span>
<span id="cb133-9"><a href="logistic-regression.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2    30     1    10 0.1  </span></span>
<span id="cb133-10"><a href="logistic-regression.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3    33     3    22 0.136</span></span>
<span id="cb133-11"><a href="logistic-regression.html#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4    36     7    21 0.333</span></span>
<span id="cb133-12"><a href="logistic-regression.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5    39    12    22 0.545</span></span>
<span id="cb133-13"><a href="logistic-regression.html#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6    42    17    29 0.586</span></span>
<span id="cb133-14"><a href="logistic-regression.html#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7    45    13    18 0.722</span></span>
<span id="cb133-15"><a href="logistic-regression.html#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8    48    12    17 0.706</span></span>
<span id="cb133-16"><a href="logistic-regression.html#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9    51     7     8 0.875</span></span>
<span id="cb133-17"><a href="logistic-regression.html#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    54     6     6 1    </span></span>
<span id="cb133-18"><a href="logistic-regression.html#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 11    57     1     1 1</span></span></code></pre></div>
<p>Where,</p>
<ul>
<li><code>size</code> is as above,</li>
<li><code>y</code> is the number of lobsters of each size that survived,</li>
<li><code>t</code> is the total number of lobsters of each size, and</li>
<li><code>p</code>is the proportion of lobsters of each size that survived.</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>Fitting a binomial model again we specify <code>family = "binomial"</code> in our <code>glm</code> call and specify our response as <code>cbind(y, n - y)</code>:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="logistic-regression.html#cb134-1" aria-hidden="true" tabindex="-1"></a>glm_mod_gr <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(y, n <span class="sc">-</span> y) <span class="sc">~</span> size, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> grouped)</span>
<span id="cb134-2"><a href="logistic-regression.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_mod_gr)</span>
<span id="cb134-3"><a href="logistic-regression.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-4"><a href="logistic-regression.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb134-5"><a href="logistic-regression.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="do">## glm(formula = cbind(y, n - y) ~ size, family = &quot;binomial&quot;, data = grouped)</span></span>
<span id="cb134-6"><a href="logistic-regression.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-7"><a href="logistic-regression.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb134-8"><a href="logistic-regression.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error z value      Pr(&gt;|z|)    </span></span>
<span id="cb134-9"><a href="logistic-regression.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -7.89597    1.38501  -5.701 0.00000001191 ***</span></span>
<span id="cb134-10"><a href="logistic-regression.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="do">## size         0.19586    0.03415   5.735 0.00000000977 ***</span></span>
<span id="cb134-11"><a href="logistic-regression.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb134-12"><a href="logistic-regression.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb134-13"><a href="logistic-regression.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-14"><a href="logistic-regression.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb134-15"><a href="logistic-regression.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-16"><a href="logistic-regression.html#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     Null deviance: 52.1054  on 10  degrees of freedom</span></span>
<span id="cb134-17"><a href="logistic-regression.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual deviance:  4.5623  on  9  degrees of freedom</span></span>
<span id="cb134-18"><a href="logistic-regression.html#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 32.24</span></span>
<span id="cb134-19"><a href="logistic-regression.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-20"><a href="logistic-regression.html#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>The fitted model is again</p>
<p><span class="math display">\[
\log\left[ \frac { \widehat{P( \operatorname{survived} = \operatorname{1} )} }{ 1 - \widehat{P( \operatorname{survived} = \operatorname{1} )} } \right] = -7.896 + 0.196(\operatorname{size})
\]</span></p>
</div>
<div id="interpreting-the-coefficients-1" class="section level4 hasAnchor">
<h4>Interpreting the coefficients<a href="logistic-regression.html#interpreting-the-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Interpreting the coefficients above we estimate that the log-odds of a juvenile lobster surviving are -8 (use your common sense to ascertain if interpreting the intercept is sensible).</p>
<p>We estimate that for every 1mm increase in carapace length the log-odds of a juvenile lobster surviving <strong>increase</strong> by 0.196.</p>
<p>What about the odds?</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="logistic-regression.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(glm_mod_gr))</span>
<span id="cb135-2"><a href="logistic-regression.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  (Intercept)         size </span></span>
<span id="cb135-3"><a href="logistic-regression.html#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.0003722407 1.2163540760</span></span></code></pre></div>
<p>Therefore, we estimate that the odds of a juvenile lobster surviving are 0.000372 (use your common sense to ascertain if interpreting the intercept is sensible).</p>
<p>We estimate that for every 1mm increase in carapace length the odds of a juvenile lobster surviving are <strong>multiplied</strong> by 1.22.</p>
<p>What about for a 5mm increase in carapace length?</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="logistic-regression.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">coef</span>(glm_mod_gr)[<span class="dv">2</span>])</span>
<span id="cb136-2"><a href="logistic-regression.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     size </span></span>
<span id="cb136-3"><a href="logistic-regression.html#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 2.662564</span></span></code></pre></div>
<p>Therefore, we estimate that for every 5mm increase in carapace length the odds of a juvenile lobster surviving are <strong>multiplied</strong> by 2.66.</p>
<p>Using 95% <strong>confidence intervals</strong>:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="logistic-regression.html#cb137-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">confint</span>(glm_mod_gr)[<span class="dv">2</span>,])</span>
<span id="cb137-2"><a href="logistic-regression.html#cb137-2" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb137-3"><a href="logistic-regression.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    2.5 %   97.5 % </span></span>
<span id="cb137-4"><a href="logistic-regression.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.944478 3.811167</span></span></code></pre></div>
<p>Therefore, we estimate that for every 5mm increase in carapace length the odds of a juvenile lobster surviving are <strong>multiplied</strong> by between 1.94 and 3.81.</p>
<p>For a <strong>percentage-change</strong> interpretation we use <span class="math inline">\(100 \times \left (\text{exp}(x\beta_1)−1 \right )\)</span>:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="logistic-regression.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">coef</span>(glm_mod_gr)[<span class="dv">2</span>]) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb138-2"><a href="logistic-regression.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     size </span></span>
<span id="cb138-3"><a href="logistic-regression.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 166.2564</span></span>
<span id="cb138-4"><a href="logistic-regression.html#cb138-4" aria-hidden="true" tabindex="-1"></a>confint <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">confint</span>(glm_mod_gr)[<span class="dv">2</span>, ]) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb138-5"><a href="logistic-regression.html#cb138-5" aria-hidden="true" tabindex="-1"></a>confint</span>
<span id="cb138-6"><a href="logistic-regression.html#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     2.5 %    97.5 % </span></span>
<span id="cb138-7"><a href="logistic-regression.html#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  94.44778 281.11670</span></span></code></pre></div>
<p>We estimate that for every 5mm increase in carapace length the <strong>odds</strong> of a juvenile lobster surviving <strong>increase</strong> by 166.26%. We estimate that for every 5mm increase in carapace length the odds of a juvenile lobster surviving <strong>increase</strong> between 94.45% and 281.12%.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="poisson-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["BIOSCI738.html", "HTML"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
